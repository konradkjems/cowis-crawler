[
  {
    "id": 103000134227,
    "title": "2017 Notes on MStore Trouble Shooting",
    "text": "table of contents pos till pos till: error when launching pos till program from shortcut on desktop for training till 999 pos till: till data load error – ‘critical error: failed to load till data‘ pos till: till taking a long time to load – stuck on ‘loading till data’ message pos till: unable to recreate till data pos till: old data file notification message received when a till is turned on pos till: till transactions stuck in holding table pos till: till transactions – holding table pdbupdater error message pos till: unable to open till/cashdraw pos till: unable to zread a till pos till: unable to clear data on till following merac server going offline pos till: executenonquery: error converting data type float to decimal pos till: two of the same till numbers are open using the same draw number fix pos till: till x, cash draw y appending multiple open entries in txns file pos till: ‘insert header till_draw subquery returned more than 1 value’ error pos till: open cash draw not appearing from pos till pos till: startup error – ‘error accessing line display’ pos till: customer line display (cld) not working pos till: description incorrect for items sold at the till pos till: wrong payment made for a booking pos till: over payment showing in booking when using payment method voucher pos till: error ‘sellcurrentitem - object variable or with block variable not set’ pos till: mstore program error- capp ‘object variable or with block variable not set’ pos till: plu sell item error - “object variable or with block variable not set” pos till: cdraw/xread program error - “object variable or with block variable not set” pos till: physical cash draw not opening pos till: customer search (‘find member’ command button from till) not returning results on till pos till: till ‘reprint receipt/reprint journal/till roll’ showing blank receipt details pos till: receipt blank on till pos till: till transactions missing in dta pos till: printing and barcode scanning – error occurred in calling the checkhealth method pos till: barcode scanner not scanning a barcode pos till: scanning barcodes – ‘item not found’ error pos till: casio barcode handheld scanner error – ‘item not found’ pos till: honeywell pda handheld stuck on ‘setting up device. please wait…’ whilst not connected to the dock pos till: logitech usb camera freezing intermittently pos till: cash draw opening when cancelling a transaction pos till: till not prompting to take a photo of existing member when membership card swiped pos till: mstoreupdater or meracupdater not updating merac system files pos till: receiving error that unable to access photo folder for memberships pos till: more than one voucher not printing at till bookings bookings: booking error – invalid use of null error bookings: error re-calling bookings from till – “item cannot be found in the collection corresponding to the requested name or ordinal” bookings: error saving bookings from back office – “item cannot be found in the collection corresponding to the requested name or ordinal” booking: taking booking deposits from the pos till bookings: deposit added to wrong booking bookings: booking confirmation letters not opening bookings: online booking payment issue - payment setup correctly in back office but not at the till bookings: booking confirmation letter empty following internet booking detail change bookings: block bookings not showing in the diary bookings: price different when recalling a booking to the pos till sessions sessions: sessions and bookings – unable to delete session/tours sessions: seat number not visible when creating sessionable bookings sessions: session type not displaying correct availability moving a session from one time slot to another from back office error footfall footfall: recorded on the wrong date for a given till promotions promotions: save error – savepromitems:’violation of primary key constraint' printing printing: ticket printer fails to print printing: boca ticket printer printing blank tickets printing: barcode labels not printing printing: barcodes printing issue - epson tm-l90 appending a ‘0’ to the beginning of an ean13 barcode printing: unable to print to a network printer printing: unable to print receipts from tills screen in back office. ‘invalid use of null’ error printing: failed to claim opos receipt printer printing: permissions error when trying to print a purchase order accounts/customers & memberships accounts|customers|memberships: unable to void new member entered through till accounts|customers|memberships: giftaid signature outside of minmax date range accounts|customers|memberships: unable to add new contacts to a customer account reports reports: error – failed to retrieve data from the database reports: error – ‘frepparams / exportdata error’ reports: error – ‘one or more fields could not be found in the result set. use verify database to update the report’ reports: update reports reports: crystal reports .rpt file not found error reports: export error - odbc driver does not support the requested properties reports: unable to run any reports - returning sql error – frepparams/invokerepparams reports: reports taking a long time to load and display reports: very slow when running any reports reports: back office crash following running a report for version 3.14 reports: data extract error or report error – subscript out of range reports: seating plan report returning an error reports: determining discrepancy with footfall analysis report and actual footfall reports: promotions report – duplicate promotion descriptive names reports: export button greyed out on the parameters window reports: report not importing correctly data extracts data extract: mailing extract error – the object invoked has disconnected from its client giftaid giftaid: claim submission failing giftaid claim submissions error - unable to submit giftaid claims giftaid write submission error giftaid: declarations report hanging giftaid: ‘divisible by zero’ sql statement function error giftaid: plu view/add price showing giftaidable claimable amount not equal to 10% as system options defines giftaid: fix taxing on giftaidable items giftaid – giftaid conversion report not matching entries in the giftaid claim submissions list back office back office: unable to run ‘recreate till data’ - receive error: unable to connect to meracupdater service back office: merac back office installation troubleshooting back office: login update notification message back office: merac back office software out-of-date error back office: computer not able to communicate with the merac server back office: trying to adjust a plu sell value returns message to specify a price matrix back office: selling of session tickets not displaying correct num qty in back office back office: files not updating when meracupdater runs back office: creating a new lookup item “violation of primary key constraint” error back office: stock entry duplicate primary key error back office: unable to move stock from ‘unknown stock location’ to known stock location back office: moving stock from deleted stock location to known undeleted stock location back office: forecasts information not updated correctly for footfall back office: mailing export/mailmerge to ms excel/word error back office: error when attempting to clone an existing receipt or ticket design debit/credit cards credit cards: card machines down credit card: unable to take card payments – till offline credit card: yespay error – “transaction failed: declined offline. please take alternative payment” credit card: unable to read debit/credit cards when swiped through the till pdq card reader credit card: chip&pin not working credit card: yespay/worldpay – cashbacks not working credit card: yespay - card refunds using easyvterminal version 3445 credit card: yespay - card payment failure as a result of till going offline credit card: polling query following moving from ack to yespay credit cards: ocius sentinel – ‘check for pinpad’ message from ocius sentinel window credit cards: ocius sentinel not detecting device on com port credit card: verifone ocius setup – cardholder copy receipts not printing correctly credit cards: yespay – easyvterminal startup issues credit cards: yespay error ‘invalid key index’ credit card: ack – problems processing card payments from till credit card: ack pdq credit card payments failing – no ack receipt printing credit card: ack cashback not working credit card: processing card payments from the till – card payment screen fails to load credit card: yespay – yeseft configuration tampered credit card: yespay – yeseftinterface error: unable to load eft datasets credit card : yespay – yeseftinterface or startposserver: port currently owned by sts.xxxx.stsemvterminal.x credit cards: yespay error ‘stsserialportexception: javax.comm.nosuchportexception.1’ credit card: yespay – payment authorization failure message credit card: credit card machine chip&pin working but not swipe function credit cards: integrated card machines payment cancel issue credit cards: corrupted log files causing issues taking card payments pos till pos till: error when launching pos till program from shortcut on desktop for training till 999 if you try and launch a training till (i.e. 999) from a merac back office computer or pos till and receive the below error message… solution you can only launch the training till from back office by clicking on pos \\\\\\formats icon in the top toolbar. pos till: till data load error – ‘critical error : failed to load till data’ problem when attempting to load till 999, the screen prompt to change the resolution is displayed and when you click ok the window disappears and the till fails to load. when you attempt to load any other till on the network following making back office changes, you receive the following error and the tills fail to load… check the contents of the meracdat.txt file on any till reporting the error (e.g. check for any inconsistency in lku records within the file by matching them with contents of lookups table in sql etc.) and then check all lku records to see if there is an inconsistency in the data. if you find an lku line entry that contains an error, fix it. recreate till data and update all tills. this should fix the issues experienced loading till data. or problem when loading the pos till program, if you receive the below error, this could mean that the meracdat.txt file could be corrupted or the till does not exist in back office>>till configuration… fix rename the original meracdat.txt file stored locally and then re-run the pos till program. this process with pull down a fresh copy of the meracdat.txt file from the server. or check that the actual till exists that you are attempting to open from till configuration. pos till: till taking a long time to load – stuck on ‘loading till data’ message if the computer/till is part of a workgroup environment and the server is part of a domain environment, this is likely the reason for the till program not loading. the problem is aimed specifically at a domain authentication issue. you will find that browsing to the \\\\\\meracdata share does not work as credentials are required to connect to the share. solution open the command prompt and navigate to c:\\program files (x86)\\merac or c:\\program files\\merac and run the following command:- mstoreupdater –password enter the meracdata network share unc path, username and password and then click update to mstore.ini button this process will append an encrypted hashkey to the end of the ini file used to authenticate when the client attempts to connect to the server which is part of a domain. this is required when the till is part of a workgroup and the merac server is part of a domain. when you launch the pos till and the till detects the server online, it tries to query the server meracdata share to verify contents of the meracdata/formats folder files using these credentials saved as an encrypted key. if the till fails to receive a response, this results in the till program failing to load. note! any changes to the merac back office system through edit config will cause this encrypted password appended to the end of the mstore.ini file to be removed. solution first check that the till has enough memory then check that the meracdat.txt file has an ‘end-of-file’ marker appended to the end of the file to make sure it is not corrupt. make sure you can browse to the meracdata share using the unc path \\\\\\meracdata\\ if you cannot, then re-create the encrypted key in the ini file. run mstoreupdater.exe to rebuild the meracdat.txt file and then try re-launch the pos till. note! the usual issue causing this would be the fact that the customer has a lot of stock items that the pos till is loading from the meracdat.txt file which is why it is taking a lot of time to load. would advise the customer to delete out old stock items no longer in use. pos till: unable to recreate till data problem receive sql ‘recreatetilldata’ statement error when attempting to recreate till data from a merac back office computer or pos till. when you make changes on a merac back office computer or pos till and then attempt to recreate till data from that device, the system attempt to write the changes immediately to its local meracdat.txt file which is why you do not need to run update to allow that device to pick up any changes made. for this to work correctly, ‘full access permission’ is required to the local merac installation folder. it then copies the changes to the server meracdata share meracdat.txt file which will allow all other tills to pick up any changes made following running an update. for the changes to be copied to the server copy meracdat.txt file, full access to the server is required. if an authentication prompt is received when trying to browse to the server meracdata share, this is the reason why recreate till data is returning an error. solution check permissions to local merac installation folder. if the till is part of a workgroup and the server a domain, it is likely that if you browse to the server meracdata share using the unc path, you will be prompted to enter in a username and password to authenticate. for bo 3.14, if the till is added to a workgroup, navigate to c:\\program files (x86)\\merac or c:\\program files\\merac and open command prompt as admin and run mstoreupdater.exe /password. then enter the domain credentials to authenticate and connect to the server as seen below and then click update to mstore.ini button… or this process will append an encrypted hash key to the end of the ini file used to authenticate when the client attempts to connect to the server which is part of a domain. this is required when the till is part of a workgroup and the merac server is part of a domain. copy pmstore.exe, pmbos.exe and mstoreupdater.exe from the server to the local merac installation directory and run mstoreupdater.exe. if bo 3.14 or 3.15 and till is added to the domain, browse to the server using the unc path and if asked to enter authentication details, insert these and ensure you tick the box the remember credentials. now try recreate till data again and it should work. pos till: old data file notification message received when a till is turned on when we started up a till, if the till operator receives a pop up saying “the data file is over ‘x’ days old, you may still use it but please inform a supervisor”, this is normal. the till purposely notifies you if the age of the till’s data file (meracdat.txt) is older than x days. specifically it does this as an alert in case the till isn’t updating from the network correctly. to get rid of this notification message, simply get the customer to recreate till data and then from the ‘three-button/four-button’ program, press the update button so that the next time the pos till is opened, the message will no longer be displayed. this notification refers to its local copy meracdat.txt file version. it is likely that the server copy is also out-of-date, so to fix the issue, from back office>>recreate till data to over-write the server copy meracdat.txt file (for version 3.14) with its local copy which will allocate the clients local copy timestamp to the server copy. press the update button on all tills ensure that all tills pick up any new changes. pos till: till transactions stuck in holding table troubleshooting log onto the merac server and check that pdbupdater service is running. if it is and there are no errors in the holding table, then examine the “connection string” in the below file and ensure the details are correct… pos till: till transactions – holding error: txh-cash drawer x on till y is not opened problem transactions stuck in the holding table. pdbupdater error message – cash draw ‘x’ on till ‘y’ is not opened. e.g. error - pdbupdater-2,999,16,tristemltd,failedcash drawer 999 on till 2 is not opened ‘ttnstatus’ displays details on whether an error occurred or not with any transactions posted to the server to be processed. any error reported would prevent all other transactions from being processed and uploaded to sql. ideally if all is ok, the holding table should be empty provided no other transactions are being sent by tills to the merac server. ‘ttnerrormessage’ displays details about the error. cause the error is caused when the till is closed for that cash draw from back office and the till has not been zread (i.e. the cashdraw has either been f2ed or in this situation the cash draw has not been closed locally using zread and so if the till operator logs back into the till, he/she will still be able to take transactions from the till with the given draw number. to get around this you could create an opening record in the holding table, clear out all holding table error messages and once all transactions have been successfully uploaded to the server, ‘f2’ the till and then archive the local transaction files without zreading the till. because the till has been closed from the back office side, the cashdraw table marks the till/cashdraw as closed and so transactions will get stuck in the holding table and are unable to flow through to be processed. (closing the till from the back office sets the till and cashdraw in the cashdraw table with a status of ‘c’ which means any pending transactions sitting in the holding table will not be processed). press ‘f2’ solution to fix this, search for the server opening transaction number from back office\\tills and then locate the opening transaction number within the cashdraw table and then set the csdstatus value = ‘o’ (must be a capital ‘o’ else this breaks it!), csdclosed at = ‘ ’ and csdclosedby ‘ ’ for the given server transaction. the status of the till and cashdraw will reappear as open then clear the ttnerrormesssage and ttnstatus within tilltxns table and commit changes. open sql server management studio and enter the following sequence of commands:- select * from tilltxns select * from cashdraw begin transaction update cashdraw set csdstatus = 'o' , csdclosedat ='' , csdclosedby ='' where csdopentxnno = 58 commit begin transaction update tilltxns set ttnerrormessage ='' , ttnstatus ='' commit now the transactions that were stuck in the holding table will be processed. finally log back into the till and zread it. then perform a cashup if necessary but the zread must be done! note! when you set the cash draw as open in the cashdraw table, the ‘csdclosedat’ value for the give till/cashdraw record will have a status of ‘1900-01-01 00:00 00:000’. this means the till has been opened so there is no valid timestamp entry as seen in the below example… pos till: unable to open till/cashdraw log onto the till and check that there is no transaction files for this till and cash draw sitting in c:\\programs. files\\merac\\txnfiles. if there are, move them into the history folder. once they have been moved to the history folder, they are archived and you can then open the till/cashdraw and start trading. pos till: unable to zread a till the issue could be 1)security permission related or the 2)formats folder may have not updated on the till correctly to allow the till operator to login with authorized credentials to zread the till or 3)the till last tx no does not equal the last updated tx no. 1) if the below appears, the till operator does not have the required permission to zread the till… 2) if the above panel display a grey box with a button if the form highlighted below has not been copied to the till located in c:\\program files (x86)\\merac\\formats\\mstorestd\\ 3) summary:- open the till in question and check the last tx no against the last updated tx no verify whether the transactions have been uploaded to the server from sql. check txn file content amend newtxns and updtxns re-open till and check that the server receives the transactions cause this usually happens if the last tx no processed locally on the till is lower or higher than the last update tx no (which is the last transaction number that has been successfully sent to the sql server. transactions are marked locally as being backed up by the files being moved to the history folder. the till then knows that all transactions have been posted). if last tx no is lower than last update tx no, this would possibly happen if the till’s newtxns file has become corrupted or unreadable by the till program and so the till cannot read the file to determine the last transaction number it processed so randomly chooses a transaction number. logically the till would reset to transaction count to a ‘0’ value which means the next transaction number to be processed by the till would be ear tagged as last tx no = 1. note! a zread or the till drawer won’t open or close unless last tx no = last update tx no. from the below exhibit, you can see that updtxns has a type value of ‘001 archive’ which means it is whichever till you are on and cash drawer 1. as soon as you add items to the basket and then press subtotal button and process a payment (whether by cash or credit/debit card), the last tx no and last updated tx no should increment by one automatically. opening updtxns (time stamped 29/08/2014 @ 12:25), you can see that the last transaction number sent to the server is 13743 which ties up with the till. opening newtxns (time stamped 29/08/2014 @ 12:25), you can see the last till transaction processed by the till. this again ties up with the last updated tx no. this is good because we now know that all transactions processed on the till have been successfully posted to the sql server. to verify that the transactions have been uploaded to the database, open the tills screen from back office and view the transactions – preferably the 2nd and last transaction number. scenario1 if last tx no is higher than last update tx no, this usually happens when the till is perhaps offline or the server is offline or inaccessible so the till is unable to send it’s transactions to the server to be processed. in both situations, this would prevent a zread or for the till drawer from opening or closing. solution make sure the till and sql server are both online and then try add random items or no sale items to the basket and void all and the till should then reconnect to the database server. once the till last tx no = last update tx no, a zread can then be carried out or the cash draw can then be opened or closed. scenario2 now if the last tx no on the till is lower than the last updated tx no (a>b), the server is likely to have a later copy of transactions sent from the till which will prevent the till drawer from opening or closing. this normally occurs when the till attempts to read its newtxns file to determine the last transaction number processed by the till so it knows where to start from which would be . if the till program/software is behaving strangely or perhaps the till was shut down without carrying out a zread at the end of a previous trading day, the till may therefore not be able to read the contents of newtxns, so will randomly generate a new transaction number starting from ‘1’. solution open sql management studio and connect to the database and run the below sql query to determine the last transaction number uploaded onto the server: select * from txnheader where txhtillno=1 and txhtype not in (’o’,’c’) --[o = open, c = closed] order by txhtilltxnno desc copy the till’s local transaction log file (e.g. tnx001 seen in above example) to the merac support computer and run txnfileparser app to re-edit the local transaction log file contents so that it starts from the transaction number following the last transaction number uploaded onto the server. save the new transaction log file, rename the old transaction log file on the till in case we need to revert back to it for some reason and then copy over the new transaction log file onto the till. amend the tills updtxns file to include the value of the first transaction number in the list (from the new transaction log file) -1. [this value should match the last transaction number processed/uploaded onto the server as we determined earlier] amend the tills newtxns file to include the value of the last transaction number in the list (from the new transaction log file). log back into the pos till program and provided the till has a network connection, all remaining transactions that have not yet been processed by the server sitting in the new transaction log file will then be processed and once last tx no = last update tx no, a zread can then be carried out or the cash draw can then be opened or closed. note! void transactions and no sale transactions are also regarded as transactions. pos till: unable to clear data on till following merac server going offline normally caused by server being changed or going offline. problem when carrying out a zread to close a till, you will receive the following error message if the merac server momentarily went offline… if you log back into the till program you will notice that last tx no ! = last updated tx no. solution connect to the till and then connect to the merac server and run ipconfig to get the merac server ip address. check that the till c:\\program files\\merac\\mstore.ini and ensure that the server path is correctly set to serverpath=\\\\\\meracdata\\ update the etc\\hosts file to point to the correct merac server ip address if there is no dns server on the subnet from where the till is installed for name resolution. log back into the pos till program and process a void all transaction which should kick start the till and force it to re-establish a connection to the merac server and transaction data should automatically start updating again. carry out a zread on all other tills. note! when a till goes offline, a message will be displayed at the bottom in red/white saying ‘server offline at xx:xx’. it will then create a file called ‘netstatus.txt’ (a text file) in c:\\program files\\merac directory on the till. to get the till back online, delete this file to fix the issue or add items to the basket and the ‘void all’ to force a reconnection to the server. you could also click on the ‘offline’ message at the bottom of the till screen and select ‘re-try again’ to force re-connectivity. if you attempt to zread the till and receive a zread failure message stating that ‘not all transactions have been uploaded to the server’, check that pserverupdater is running in the background for ver 3.14 and disable uac. if running ver 3.15, restart meracupdater service. pos till: executenonquery: error converting data type float to decimal below sql holding table transaction error received… errormessage: txd-//i:executenonquery:failed to save transaction detail record for txnno 89425 on till 220 (error converting data type float to decimal.) txd line = txd,1,220,220,89425,1774,1,all in one child,all in one day child,s,1,-53222197.74,-53222197.74,222222220,53222221.69,0,0,0,0,0,0,0,0,23.95,v,0,0,0,1,s,-8870366.28,0,,0,0,,0,17,0,0,1796,0,,,,,0,0,0,,0,0,,,0,,0,,,,,,,0,25 oct 2015 15:24,0000,0,0,,0,0,0,0,0,0,0,0,0,9 txnline in holding table: txd,1,220,220,89425,1774,1,all in one child,all in one day child,s,1,-53222197.74,-53222197.74,222222220,53222221.69,0,0,0,0,0,0,0,0,23.95,v,0,0,0,1,s,-8870366.28,0,,0,0,,0,17,0,0,1796,0,,,,,0,0,0,,0,0,,,0,,0,,,,,,,0,25 oct 2015 15:24,0000,0,0,,0,0,0,0,0,0,0,0,0,9 cause and fix this issue is normally caused by scanning a barcode for example at the pos till into the ‘price’ field accidentally and then sql fails to convert the data being scanned to the correct numeric format. you can see that the above transaction line was voided so you could just delete the line from the holding table to fix the issue. pos till: two of the same till numbers are open using the same draw number fix if two of the same till number are opened using the same draw number, run the following commands to determine the till’s open transaction number (i.e. server allocated transaction number) which is greatest. this would be the one that was opened most recently (2nd of the two). select * from cashdraw where csdtillno = x and csddrawno = y and csdstatus = 'o' or open tills from back office and determine if there are more than one instance of a particular till and cash draw open and if so, view the most recently opened till/draw instance transactions to determine its opening server transaction number. then use this info. to delete it’s records from the following tables – txnheader,txndetail,payments,txntax,cashdraw and cashup and then if there are any errors in the holding table, clear these. this will allow all pending transactions to then be processed. note! the above solution would only stand if the 2nd instance till/draw opened has not processed any transactions else they will get stuck in the holding table. pos till: till x, cash draw y appending multiple open entries in txns file cause when the till is zread, the operator turns off the till during the process, the till would not get a chance to archive the txns file into the history folder but the cashdraw is successfully closed hence why the till when opened again, appends another open entry to the file. fix archive all transaction files updtxns, newtxns and txns files to history folder and get the operator to log back onto the till. the till will say failed to get last transaction number. would you like to obtain the last transaction number from server. click yes. the tills first transaction number will now be the servers last transaction number. pos till: ‘insert header till_draw subquery returned more than 1 value’ error txh-insert header error. till = 2draw = 2till txn = 17352 (subquery returned more than 1 value. this is not permitted when the subquery follows =, !=, , >= or when the subquery is used as an expression). reason there is more than one of the same cash draw open for the same till. cause usually caused by either a zread of the till not successfully completing - most often caused by a 1)poor network connection, 2)turning off the till in the process of completing a zread, 3)unplugging a mobile till ufd from a computer whilst merac system is in the process of completing a zread or 4)pdbupdater (3.14) or meracpdb (3.15) failing to mark the till and cash draw as closed following a zread (less likely to happen!) and then the next trading day, the till operator being unaware that the till/cashdraw has been closed off successfully, opens the same till/cashdraw and processes transactions from the till. the transaction then gets stuck in the holding table. how to replicate the scenario:- stop pdbupdater or meracpdb service on the server zread the till – the local transaction files will in affect be archived. locate the currently open till/cashdraw in tilltxns and delete the clo (closing record) for the given till re-start pdbupdater or meracpdb service on the server re-open the the same cashdrawno. on the same till (now two open records will appear in back office for same till/cashdraw) as soon as you start sending transactions to the server, pdbupdater will not like this and send pdbupdate notification error messages to the server and stop processing any transaction sitting in the table until the error is cleared. solution close the most recently opened duplicate till/cashdraw from back office and clear error messages displayed in ttnstatus and ttnerrormessage within the holding table to allow any transactions from the previous till/cashdraw to flow through the holding table and into the database. begin transaction update tilltxns set ttnstatus = '' , ttnerrormessage = '' where ttnstatus = 'failed' commit key highlighted factors to consider before closing the most recent till/cashdraw that was opened… 1 2 3 1)in the above, the timestamp must be dated other than todays date. this would indicate that the transactions stuck in the holding table are still pending to be processed from the originally opened till/cashdraw. 2)in the above, the last transaction without an error against it must have a timestamp other than todays date. 3)in the above, a closing record at the end of the list of transactions for the originally opened till/cashdraw would mean that once the 2nd mentioned of the two till/cashdraw is f2’ed, transactions will flow through following clearing error messages and will close. to confirm this, check back office tills screen or open the cashdraw table and ensure the till/cashdraw is closed – it should be, given that there is a closing record tag at the end of the first open till’s transaction file (i.e. there is a closing record sitting in the holding table), else the till will remain open and should be marked as open in the cashdraw table if busy trading. if it is determined that the till/cashdraw is not trading, you may need to close the till and cash draw manually. you can check if the till/cashdraw number is marked as closed in the database by searching cashdraw table based on csdopentxnnumber which in this case would be ‘20231’… if there are transactions pending to be processed for the 2nd mentioned till/cashdraw sitting in the holding table, you will need to re-open the till/cashdraw from the cashdraw table by searching its opening record line. pos till: open cash draw not appearing from pos till in a situation that a till has been trading for the day and then there is for example a power cut and the till shuts down unexpectedly, when the till restarts and you attempt to login to the till, there is no cash draw visible to allow the till operator to login to the till. the reason for this is because either newtxns or updtxns file contents are incorrect or blank. when windows experiences an unexpected shutdown and is readying from a file, the file or its contents may get corrupted. fix rebuild the newtxns file date stamped for the day which should appear blank (i.e. windows would blank the contents as a result of the unexpected shutdown – copy my own newtxns or updtxns contents as a template). open the local transactions file and get the last transaction processed by the till. copy an existing newtxns file and past it into the newtxns file date stamped for the day and edit the contents to include the last transaction number noted earlier and the draw/tillnumber and save. if there was an issue with the updtxns file, insert a transaction number prior to the first transaction number executed by the till and save. note! in later versions of merac software (3.15 or higher), meracpdb is a service that runs on the server only which moves transactions sitting in the holding table to the database and is clever enough to know that even if you set updtxns transaction number to a number already sent to the server, will not re-upload the same transaction number to the database causing duplicate transactions but instead will only send/upload those that have not yet been processed. like pserverupdater used by 3.14 to send transactions to the server from the till, meracupdater service does the same for 3.15. try re-opening up the till and cashdraw and log back into the pos till and everything should be ok. confirm this by adding random items to the basket and void all or restart meracupdater service on the till to allow the last update tx no to catch up with the last tx no. done! pos till: startup error – ‘error accessing line display’ system displaying opos error when starting up till: “failed to claim opos line display\". the customer line display (cld) unit only shows the ‘companyname’ and nothing else. cld is usb attached but uses a built-in usb-to-com port converter, which is a piece of software used to convert the usb attached cld to be detected by device manager as a com port. troubleshooting checked in opos utility that the hardware settings for the cld is set to com7 handshake should be set to ‘none’. try plugging the cld into another usb port and scan for hardware changes and reboot the till and test. swapped clds with a known working one – if it starts working then the device is damaged. pos till: customer line display (cld) not working first few things to check: open devices manager and make sure the com7 is enabled. reinstall the front line display software. installing aures sango customer line display if there are issues with the usb-to-com port drivers, try reinstall these – run the driver installer first and then the configuration utility to detect the device on the com port… once the driver is installed, run the setup from the d:\\sango_c95drivers\\graphic cust disp\\configuration v1.1.9\\ click scan device button click auto scan button the correct com port will be detected for the front line display which is com7… click change settings change the command type to 1-esc/pos and then click the set to device button… complete! make sure the handshake is set to ‘disabled’. if not then you will have to amend this manually by navigating to the following location c:\\program files\\opos\\epson2\\ and open the following file for editing - lddmd101 run an ‘interactive health check’ from epson setuppos ver2.00 utility for the line display and then check that the line display is showing text on the lcd screen. if the front line display is showing any dollar symbols then the device is incorrectly configured. pos till: description incorrect for items sold at the till problem scanned item description name on till incorrect for a sell item solution found that the plu associated to the barcode (e.g. 5029306666104) when searching the plu based on the code “5029306666104” had the wrong description of \"dw fluffy owl\" whereas the stock item with that same code had a description of \"dw cone snow\". have advised that a correction would need to be made to the plu to match the correct description name. a recreate till data would also be required to update the changes to all tills. pos till: wrong payment made for a booking amending payments made to a booking through sql can be done but ultimately it is encouraged for the customer to carry out the amendment through the till by recalling the booking and carrying out a refund. in some circumstances, even though the correct payment shows in the payment history window in back office and also reflected in bkgheader and bkgdetail for the particular booking number, you may still be required to reverse the payment through sql. note! ‘txnno’ column in payment history would be the server transaction number. solution open sql server management studio and enter the following sequence of commands:- select * from txnheader where txhno = select * from txndetail where txnno = /* note! txnorderno is the actual booking ref. no*/ select * from payments where paytxnno = select * from txntax where txtno = begin transaction delete from txnheader where txhno = delete from txndetail where txnno = delete from payments where paytxnno = delete from txntax where txtno = commit pos till: over payment showing in booking when using payment method voucher when a customer has over-paid for a booking i.e. in the below booking you can see that a £50 voucher was used to pay for a booking with a total amount due of £45 in the merac bo system… as a result, when you run transactional analysis by nominal code report, you will notice that the very top gives you details of the amount paid in (which includes vouchers, cash or card). the customer presented the cashier with a £50 voucher which was entered into the pos system as paid so far amount of £50 instead of £45 which is the actual amount due. this is an actual payment of £5 over. that is why when you look at the report, you see £118.50 which is the total amount paid. based upon the actual plu sell price of each item purchased using a combination of payment method credit card and voucher, the actual true transaction total amount should be £113.50. the item sold using the voucher was worth £45 as seen encircled in red. that leaves an over payment of £5 which you can see clearly at the very bottom of the report encircled in blue… pos till: error ‘sellcurrentitem - object variable or with block variable not set’ problem if you attempt to scan an item or enter the item code into the code field on the pos till, an error ‘sellcurrentitem - object variable or with block variable not set’ is returned as seen below… discontinued - stock items that you still want to sell but no longer want to re-order deleted - stock items you no longer want to sell a discontinued or deleted plu item means you cannot sell the item. if a stock item has been deleted and discontinued, search for the item by selecting the deleted and discontinued checkbox (it’s will be displayed as a 'strikethrough entry' (i.e. meaning the stock item is deleted) and highlighted in pink (i.e. meaning the stock item is discontinued). if a stock item has been discontinued, it can still be sold until all remaining stock has been depleted but the system will not be reordered through supplier. to search for the item, select the ‘discontinued’ checkbox (highlighted in pink (i.e. discontinued)) if a stock item has been deleted, it can no longer be sold. to search for the item, select the deleted checkbox ('strikethrough entry' (i.e. deleted)) note! to find a stock item that has been both deleted and discontinued you will have to select both deleted and discontinued checkboxes. if a plu (non-stocked item) has been discontinued, you will no longer be able to sell that item. you will receive the following series of error messages because when an item is sold, the routine would first check the contents of the meracdat.txt file to determine if the item exists and if it does the status of the plu being sold (i.e. active, discontinued or deleted) and then whether or not the plu is linked to a promotion. because the item exists in the meracdat file but has been discontinued, the below error messages will be displayed… pos till: mstore program error- capp ‘object variable or with block variable not set’ problem when clicking on the bookings button to recall bookings from the till, receive mstore program error “object variable or with block variable not set”. troubleshooting if the customer connects to multiple databases (e.g. longleat or nmrn or paignton zoo [paignton zoo have two site databases i.e. paignton zoo and living coast]). if this is the case, the first thing to check would be the meracdat.txt file. it is likely that someone may have logged into back office living coast database from the paignton zoo network and carried out some changes followed by a recreate till data which would have overwritten the paignton zoo server meracdat.txt file with the living coast version so when other tills from paignton turn on and run an update, their local meracdat.txt file contents will be incorrect and you may receive the above ‘object variable or with block variable not set’ error either when the pos till program starts up or if the till operator attempts to recall a booking or sell an item. example:- the mstore.ini file is pointing to the actual paignton zoo site merac server datapath as seen encircled above hence if a user attempts to log onto a different remote site database (i.e. living coast) from back office and runs recreate till data. the process will over-write its centrally stored meracdat.txt file in the meracdata share and an update run on each till will pick up the wrong configuration settings. fix advise the customer at paignton zoo to recreate till data by connecting to the paignton zoo database from back office and for all till operators to update their tills. pos till: plu sell item error - “object variable or with block variable not set” problem when trying to sell a plu from the till, receive error “object variable or with block variable not set”. fix try run till update try process a transaction selling a particular item and then check if that item price is in the meracdat.txt file on the till – search for the plu item to determine the pluid and then search “pri,” and search for the price entry for the given pluid. if it is there, then most likely the plu has either been marked for deletion or has been discontinued. if it is not there then most likely the sql database is locked (i.e. the prices table or an associated table may be locked) log onto the server and then restart both merac pdbupdater and sql service. get the till operator to run an update on all tills and this should fix the issue. if you now examine the meracdat.txt file, there should be a pluid and pri item in the file that matches that which is in the database or in back office. note! sql could also be locked by running a “begin transaction” query and not committing changes. pos till: cdraw/xread program error - “object variable or with block variable not set” when doing anything on the till i.e. pressing a button or logging out or logging on to the pos till. fix zread the till and then archive the contents of the txnfiles folder. pos till: physical cash draw not opening when making a payment from the pos till, the cash draw is not opening. receive the following error message: physical cash draw is plugged into the receipt printer and back office till configuration receipt/slip printer and cash drawer 1 are defined identical (e.g. tsp643d). if epson opos shows the opos printer and cash drawer as greyed out, this means that their settings are defined somewhere else. in this case, they are defined within another piece of software (e.g. starmicronics)… troubleshooting check that the pci express com ports installed are visible in device manager under ports (com & lpt). you can manually change the port number but these would also need to be changed from within the opos software to match. print a configuration slip from the receipt printer and make sure you set the baud rate within the opos software to match. if there are still issues with the physical cash draw or receipt printer not being detected following running a health check, the receipt printer could be faulty or if the receipt printer is working but not the physical cash drawer not, the cash draw could be faulty. pos till: customer search (‘find member’ command button from till) not returning results on till when searching for a customer to invoice from a till and the search feature does not find any information, check that the “source” field has a value in it… pos till: till ‘reprint receipt/reprint journal/till roll’ showing blank receipt details solution close the pos till and then from back office>>open till configuration and then click alter default till document button and then ensure that a receipt design is selected (checkbox checked) and click apply. now open the till again and then try and view transactions processed through the till through the reprint receipt|reprint journal or till roll and process the refund again. pos till: receipt blank on till first ensure that any printer is set as default from devices and printers. then ensure that for the particular till in question, a receipt printer is defined (e.g. winreceipt for windows printing) in back office>>till configuration. you may need to also click alt default till documents button and dirty the records checked and save the changes then go back in and revert them back to how they were>>recreate till data and update tills and then instruct the till operator to try re-printing the receipt. pos till: till transactions missing in dta problem if the merac database server goes down and a till as a result is missing certain transactions when running dta, do the following… solution remote onto the till and open explorer and navigate to ‘c:\\program files (x86)\\merac\\txnfiles\\history’ or ‘c:\\program files \\merac\\txnfiles\\history’ or ‘c:\\programdata\\merac\\txnfiles\\history’. copy the transaction file to the merac server. remote onto the merac server and make sure the server has the an updated version of pdbupdater. open merac back office and then click setup and click edit menu to manually upload contents of the transaction file to the merac server. now browse to the saved transaction file, select it and then click upload button click yes at the next window followed by ok. note! for both 3.14 and 3.15, pdbupdater is clever enough to know that any transactions that exist in the transaction file that have already been uploaded to the server would be ignored so that no duplicates would be present. done! pos till: printing and barcode scanning – error occurred in calling the checkhealth method when testing printers and scanners (connected via serial com port) and carrying out health checks through the opos system, only one application can claim the device at a time. therefore, best practice is to close the pos till software and then run a health check else an error message will be returned. healthcheck error: general hardware problems that may result in this error also being produced: mis-configuration faulty cable faulty com port faulty device pos till: barcode scanner not scanning a barcode download iphone app (code read r) and then insert the barcode having the problem scanning and it will return the symbology of the barcode. configure the device using that symbology and then print the scansheet to re-program the scanner and then if you then attempt to scan the barcode, it should work. or if the symbology is enabled on the barcode scanner and the device is attached via usb, open back office>>till configuration and then set the barcode reader setting to ‘none’ (since it is attached via usb). the device will appear in devices and printers as seen in below exhibit… if the scanner outputs a barcode following a scan with no space at the beginning, then the barcode scanner is not programmed correctly. send the customer the barcode scanner scan sheet to re-programme the device and then try scan again. this should fix the issue! if you scan an item and the barcode appears in the code field on the till and then disappears with no merac ‘item not found’ notification message being displayed, this means that system options>>stock tab>>plu to use for 'item not found' option is not defined - hence why the item not found window is not appearing allowing the till operator to add the plu manually. pos till: scanning barcodes – ‘item not found’ error problem pos till returning “item not found” error when an item barcode is scanned using the barcode scanner. note! this problem only occurs when scanning certain stock items. the fact that a response is being returned means that there is nothing wrong with the barcode. it there was, then when you scan a barcode, nothing will happen! if there is no response when scanning the barcode, get the customer to send us a photo of the stock item barcode and we can try and test scan the barcode from here. if the item is scanning correctly, the issue is with the scanner. check stock item print barcode configuration if no response from pos till when scanning barcodes. the symbology could be setup incorrectly when the barcode labels are printed or the barcode used could be incompatible with any symbology that would render the barcode scanable by the barcode scanning device. troubleshooting check configuration of barcode scanner and barcode printer: 1)configure and test the barcode scanner. if the device is attached using serial com port, ensure that it is configured correctly in opos. you could also re-program the scanner from here as well. 2)check merac mstore bo system>>till configuration>>if a serial com port attached barcode scanner, set the “barcode reader” field to the name make/model of device (e.g. eclipse/voyager/orbit) ensuring that the name showing in opos is identical to the name in the merac mstore bo system. note! if a usb barcode scanner, no need to specify any config. settings in merac mstore bo system as the scanner will be picked up automatically and will be available immediately through pnp. 3)get the customer to print a scan sheet for the appropriate device (if attached via usb i.e. not configured through opos metrologic administrator) and get them to scan every barcode and pq code in order from top to bottom to re-calibrate the scanner. 4)test that the item stockcode is picked up from the till by entering the code into the “code” field format: note! any items with codes that do not start with a character are recognised by the till as sell items and any items that start with a character are recognised by the till as barcodes). when a barcode is scanned and the till responds to the item being scanned (i.e. even if an error is returned such as “item not found”) means that the barcode is a valid barcode. with the correct item being added to the basket once the item is scanned would provide confirmation that the barcode is linked correctly to the item being sold. pos till: casio barcode handheld scanner error – ‘item not found’ problem when trying to scan barcodes (11 digit barcodes), receive error that item not found but scanning the item from the till works fine. fix enable \"output check digit\" which is the last digit of an upc-a symbology barcode. this will perform a checksum on the 11-digit barcode to verify that the barcode is correct. the ‘output check digit’ for any barcode is first digit to the far right. for ean13, this would be the 13th digit. for upc-a, this would be the 12th digit. how to enable “output check digit” run image scanner read utility from programs menu… click on ‘image scan read’ utility from taskbar and then click settings… click options tab and then change upca to include “output check digit”… close the ‘imgset’ window and then click on the image scan read icon in taskbar again and click close pos till: honeywell pda handheld stuck on ‘setting up device. please wait…’ whilst not connected to the dock what should follow is a screen that asks you to update the date/time troubleshooting steps:- plug the device into the usb dock and then browse the device to check that the correct private ip/port number details are entered into the mobileini.txt file. also check that the mobiledat.txt file has data in it. if not, then delete the mobiledat.txt file and then unplug the device from the dock and reboot the device. if it still does not get past the point of setting up the device, plug the device into the dock and cold boot the device to eliminate wifi and see if this resolves the issue. if the device can initialize whilst connected to the dock using the initial settings wizard but not when unplugged from the dock, then the wifi network could be flaky. (see ‘stock take using pda handheld.doc’ for more details) pos till: logitech usb camera freezing intermittently problem camera freezing intermittently. cause and troubleshooting if there are any 3rd-party software programs or microsoft processes claiming the device, the camera may tend to freeze up. the camera is plugged in via usb and uses either standard windows plug and play drivers or device-specific drivers (e.g. logitech). check that there is sufficient hard disk space and that they do not use memberships through back office at the same time for example, because if trying to access the camera from the till as well, there would be more than one program trying to claim the device and the camera image will either not be displayed or would freeze up. if this is not the case, run an on-demand virus scan and shut down the computer on a daily basis to free up resources and try swap usb ports to eliminate such problems from happening in the future. this issue is not caused by the merac software at all and there are no user/administrator-defined settings in back office that are used to allow integration with the camera. pos till: cash draw opening when cancelling a transaction aures posligne devices (i.e. odp100/200/333) are connected via serial and configured through their dedicated pos software and print faster than devices that may be attached via usb (i.e. this is because windows attached receipt printers print more quality receipts in comparison to being serially attached). if an cash draw is plugged into a aures posligne printer connected via serial com port and configured through their dedicated opos software. both printer and cash draw need to be defined in the software. when setup this way, the receipt printer will print receipts as and when needed and the cash draw will only open as and when needed. reason if the aures posligne printer is connected via usb, it can be setup through epsonopos but needs to use tm-t88iii drivers else it will not work. if the cash draw is plugged into the printer setup in this way, each and every time a transaction occurs even when the transaction is cancelled, the system will attempt to print a void receipt and the cash draw will open. note! aures posligne printers can only be setup as serial and usb printers within aures opos software whereas epson products can be setup as usb and serial through epson opos software. note! for windows attached receipt printers (e.g. aures posligne) which requires you to install the specific windows print drivers from the vendors website, you can configure receipt printer as either a serial or usb printer (to be named as 'winreceipt') and by so doing, the cash draw - if plugged into the receipt printer - will open each and every time a receipt is printed (i.e. whether a void/no sale or sale receipt is printed). any paper that passes the printer will open the cash draw! fix plug the cash draw into the dedicated cash draw port at the back of the till and configure the till to use ftcd via back office/till configuration. then recreate till data and test. pos till: till not prompting to take a photo of existing member when membership card swiped solution make sure that the membership type in back office is setup with a mandatory option for ‘photo’. note that you cannot test swiping a membership card from training till 999 to record membership entry. in other words, when swiping a membership card that does not have a photo setup, even though the above ‘photo’ option is selected, the training till will not prompt to take a photo if the photo is missing. as you can see from the till configuration window below in back office, this functionality only works for live tills… pos till: mstoreupdater or meracupdater not updating merac system files in some circumstances, mstoreupdater or meracupdater fails to update merac system files (e.g. formats folder missing on the local machine). fix log onto the merac computer with the problem and then navigate to c:\\program files (x86)\\merac\\updatenewver\\auth or c:\\program files\\merac\\updatenewver\\auth and delete perrtrap.dll. then re-run mstoreupdater or re-start meracupdater. pos till: till receiving error that unable to access photo folder for memberships fix close pos till program inserted file:// into trusted sites in internet explorer and restarted pos till program and log back in and tested should work now! pos till: more than one voucher not printing at till if a customer has “group ticket toggle” option enabled in system options, if the till operator attempts to purchase more than one of the same admissions voucher, the till will only print out one voucher as opposed to two or more depending on how much were purchased. fix find the plu and then update the ticket design to include “unique ticket barcode” (printlayoutline table pllmergefield value = ‘txnuniquebarcode’) and then save the changes. also make sure that unique tickets checkbox is selected for the plu and number per ticket value set to ‘1’ and then recreate till data and update the tills. bookings bookings: booking error – invalid use of null error when attempting to open a booking, receive a pmbos “invalid use of null” error. this is normally caused by either a booking created whereby afterwards, the plu is deleted or the bookable resource date and time availability has not been defined correctly… fix to identify if this is the case, from the ‘bkgdetail’ table, search for the booking refno. and if both ‘bkdresource’ and ‘bkdbcdid’ is set to ‘0’, delete this record from the database. if you then try to recall the booking from back office, you should be able to open the booking. the customer would need to review any bookable resources or plus added to the booking to determine their validity to prevent this error from re-occurring. similarly, if you try to re-call a booking from the till and receive the following error message – “pmstore object variable or with block variable not set: sellcurrentitem”… fix make sure that all bookable resources tied to the booking you are trying to re-call have plu items that are not discontinued. if so, re-enable them and then recreate till data and run an update on all tills. other sql error messages:- index out of bound this usually occurs if no drop-down selection was chosen for the given window when setting up a booking. invalid use of null an invalid use of null value being inserted into the booking bookings: error re-calling bookings from till – “item cannot be found in the collection corresponding to the requested name or ordinal” troubleshooting if this is happening for all bookings – test by opening up training till 999 from server and try search any random bookings. also check if you can open up the associated booking returning an error on the till from back office. note! below fix only applies to bo 3.14. if bo 3.15, the forms are held in the database so speak with dave! fix if this is happening for all bookings and opening up the booking from back office, everything is fine, then replace the formats\\ finfoform.frm and finfoform.frx files with known working versions (i.e. perhaps from another customer whereby the bookings window from the till screen is similar – “check with dave on the appropriate customer to copy from!”) copy the two files to the tills local c:\\program files (x86)\\merac\\formats\\stdxvga folder renaming the old files and re-launch the till and test. if it works, then copy the two files to the servers meracdata share within formats\\stdxvga and then add any text to meracdata\\formats\\updates.txt file so that when you click on update on the tills, they will detect a change/modification made to the text file and re-copy all contents of the server version formats folder to their local formats folder… bookings: error saving bookings from back office – “item cannot be found in the collection corresponding to the requested name or ordinal” check that linked plus are not deleted and the date validity information is correct. turn on sql database tracing (get nik to do this) and then carry out the activity again to obtain trace related information run select * from dbo.trace on sql server to determine what data is being passed back to the mc_savebooking stored procedure. if the data being passed back to the stored procedure does not include certain field items that the back office stored procedure (mc_savebooking accessed in right-hand pane in microsoft visual basic) is looking for, then the error would be presented. booking: taking booking deposits from the pos till problem ‘paid so far’ amount in bookings window showing differently to payment information in the payment history window. detail that is sourced from the payments table detail is sourced from txndetail table detail is sourced from payments table confirmation of the amount charged against the credit card (note! you would need to confirm what the till receipt says and not take the above payments table section details as gospel)… details of txn file: pay,1,2,1,40354,3,20,0,,,************8437,,01 mar 2018,,0,20,0,false,003153,62659413,16,,yespay,465946,,0,0,gbp,20,1 tax,1,40354,1,e,40,0,0 explanation in future when taking a deposit for booking, do not adjust the quantity from its default value of ‘1’ to another value other than this (in this case you changed it to ‘2’) because the pos till program always expects a quantity of ‘1’ when taking a deposit so when the payment was taken, it only took £20.00 instead of what you wanted it to charge (2 x £20.00). this is why the paid so far showed £40.00 which reflects the details you entered into the till at the time of taking the deposit and the payment history window only charged £20.00. bookings: deposit added to wrong booking requirements change a deposit made for a booking from one booking to another - deposit of £20 needs to be moved from booking ref. 1544 to booking ref. 1558 before… before… solution because there is only one transaction linked to the original booking, simply rename the booking reference number for the given transaction to the correct booking reference number. open sql server management studio and enter the following sequence of commands:- --select * from bkgheader --inner join bkgdetail on bkdref = bkhref select * from bkgheader inner join txndetail on txnorderno = bkhref where bkhref = 1544 select * from txnheader inner join txndetail on txnno = txhno where txnorderno = 1544 begin transaction update txndetail set txnorderno = 1558, txnshortdesc = 'deposit bk 1558', txnlongdesc = 'deposit bk 1558' where txnorderno = 1554 commit after… after… if you then click on payment history for the booking 1558, you can see below that because the transaction was simple moved from booking 1544 to 1558, the attributes for the transaction have been retained (e.g. date/time that credit card payment was made, method of payment, till no. from where the payment was made etc. which is useful for reporting purposes, etc.)… bookings: booking confirmation letters not opening example:- company: bristol zoo ‘\\\\10.0.0.159\\meracdata\\reports\\group bookings’ solution open ms word and change security settings: trust center>>trusted locations – add ‘local\\program files (x86)\\merac’ and ‘\\\\\\meracdata’ as trusted sources allow docs on network to be trusted enable macros disable data prevention mode and data execution prevention uncheck all options circled below… also when clicking on the email conf button to open a booking confirmation letter, if you receive ‘cmdemail_click’ program error when clicking on this button, as seen below… troubleshooting problem was identified to be caused by the email application (ms outlook) not allowing a connections to the merac back office app. bookings: online booking payment issue - payment setup correctly in back office but not at the till description if full payment was taken (and the booking is in the future, the status will be changed to ‘booked’) and then part of it refunded for a particular booking and then later the customer decides to amend the booking back to how it was (e.g. from 2 x 2 table - 1 x 2 table - 2 x 2 table) and despite booking when referenced from back office displaying the correct amount due, the till is still showing that full payment has already been taken even though was refunded previously to result in an amount still outstanding for payment. fix recall booking from till press on the deposits button when asked to take a deposit select 'yes' and then when asked would you like to refund the deposit say 'no' the items with the correct amount should display in the basket press the sessions button if sessions are involved subtotal>>select payment method that should fix the issue. bookings: booking confirmation letter empty following internet booking detail change question what does an internet booking not have that a normal booking does have?? the ’bookedby’ attribute encircled below is because the booking was made by the customer and not the employee… this means that the ‘bookedby’ field will be blank in the employee table in sql. when you attempt to make changes to the booking from back office and try re-sent the letter from the diary, you may find the email attached pdf booking confirmation letter contents is blank. fix modify the stored procedure dbo.mc_bkconf as seen below to prevent it inner joining bkgheader and employee table on ‘bookedby’ record data. modify the procedure to left join employee table to bkgheader table in which case all records in left table (bkgheader) will be returned even though there is no match on the right table (employee). in this case, the procedure will still run and return results importing the data into the letter… bookings: block bookings not showing in the diary if block bookings (i.e. classed as internet bookings) is enabled as seen below, then ‘bkhisinternet’ records will be set to null for each booking in ‘bkgheader’ table which means that if you try and search for a booking in the diary you will not find anything if you check either the ‘bookings’ or ‘show internet bookings’ radio button… to fix this issue you will have to set all ‘bkhisinternet’ records linked to an internet booking from null to ‘1’. permissions for block booking… bookings: price different when recalling a booking to the pos till if a booking has been created in back office and then you recall the booking to the pos till, if the price is different, it is likely either an everyone promotion is causing the price change or an account promotion or membership promotion or the admission that was purchased (e.g. at the beginning of the year), price is different to the price now due to the fact the admission ticket is seasonal (i.e. the price changes from season-to-season). fix simply log into merac back office and open system settings – uncheck the box “recalculate internet price” from the accounting tab. recreated till data and update all tills. sessions sessions: sessions and bookings – unable to delete session/tours problem if you open up add/edit sessions/tours within back office and attempt to delete session/tours assigned to a particular sessiontype and receive the below error of “please remove the individuals before cancelling”… fix open sql and run the below series of commands to find the session related information and delete the offending entries. then recreate the sessions/tours from back office add/edit sessions/tours… sessions: seat number not visible when creating sessionable bookings if a session has been defined to implement a seating plan, when creating a booking from back office, the choose seats button will only be visible after creating – saving and re-opening the booking. steps:- creating a sessionable booking from back office. select a valid date that the session/tour is available from the diary and then click new button. select the appropriate booking type from drop-down. select the appropriate source from drop-down. click ‘tour/sess’ radio button and then select the appropriate session type and session/tour time slot. then double-click on the session/tour time slot to view the sessional plus associated to the session type and then highlight the plu from the bottom plu section and click add… click find customer or new customer button to add a customer to the booking and then click save bkg button… exit the booking and then go back into the booking. the choose seats button is now available to allocate seats to the booking… sessions: session type not displaying correct availability if items are sold on the internet and the booking template does not have the style set to 'session/tours', then even though you allow selling of sessions over the internet they will not record availability correctly. to check what items have been manually booked - open add/edit session tours and then open the calendar date for which the session type has been defined and click make booking button. a list of all manually entered books will be displayed. if internet bookings are not showing up in the session detail report, make sure that the booking template to allow selling sessions on the internet has the style set to 'session/tours'. moving a session from one time slot to another from back office error when changing the time for an existing session for a booking, returns error below after saving changes: ---------------------------------------------------- ado error ---------------------------------------------------- sql error number: 23000: [microsoft][odbc sql server driver][sql server]cannot insert the value null into column 'sesseq', table 'mstore.dbo.sessionbkgs'; column does not allow nulls. update fails. provider-specific error code: 515 ---------------------------------------------------- ado error ---------------------------------------------------- sql error number: 01000: [microsoft][odbc sql server driver][sql server]the statement has been terminated. provider-specific error code: 3621 sql statement: exec mc_savebooking 'u', 31, 1, 14354, 2, 'rock', '', 0, 1, 11, 0, '30 nov 2014 16:15:00', '30 nov 2014 16:30:00', '', '', '', 0, 'mrs', 'katherine', 'rh10 3ph', 'kapmert22@aol.com', 1, 1, 'b', 1, 31721, 'roc31721 ', 'rock', 1, '3 oriel close', '', '', '', 'crawley', '', '07824530989', 'sagepay-ok', '30 dec 1899 10:30', '', '01 jan 1900', 0, 0, 106, 41, '18 nov 2014',8042,2,11494,1,0,'','',0,0,0,11 ************ solution have manually added the required sessions and then deleted the old ones and saved and this worked fine. footfall footfall: recorded on the wrong date for a given till moving footfall figures from one date to another for a given transaction scenario till 2 opened at 14:48pm on sunday the 14th recording 159 children and 230 adults and closed at 00:05am on monday 15th. (this footfall was supposed to be recorded for sunday the 14th figures - receipt no. 2/149471) problem till 2 had mistakenly recorded the above transaction on monday instead of sunday. now footfall on sunday and monday are showing incorrectly. requirements move the footfall for this given transaction from monday to sunday processed by the given till. solution log onto the merac mstore bo system and then open the tills screen and filter back to the respective dates for each till in question. then verify that these transactions actually occurred by double-clicking each till and then select file>>view transactions>>click next button to step through each of the transactions. easier method would be to run the transaction audit report to determine if the transaction was actually recorded. open sql server management studio and enter the following sequence of commands:- select * from txnheader where txhtillno = 2 and txhcompleted between '15 sep 2014 00:00' and '15 sep 2014 23:59' --the above date of the 15 sep 2014 would be monday’s date --two server transactions will be returned – items added (‘x’ children and ‘y’ adults) to basket and till cashup --the items added to the basket has recorded a server transaction number of 534125 /*below query is used to verify the footfall amount recorded against the server transaction number 534125 used to sell both the ‘children’ and ‘adults’ admission tickets which are set to record footfall*/ select * from footfall where ftftxnno in (534125) --below query is used just to verify the open transaction number within the cashdraw table select * from cashdraw where csdopentxnno = 534124 begin transaction update txnheader set txhstarted = dateadd(d,-1,txhstarted), txhcompleted = dateadd (d,-1,txhcompleted) where txhtillno = 2 and txhcompleted between '15 sep 2014' and '15 sep 2014 23:59' commit begin transaction update footfall set ftfdatetime = dateadd(d,-1,ftfdatetime) where ftftxnno = 534125 commit note! only plu’s with footfall set (i.e. plufootfall = ‘1’ in the ‘pricelookups’ table) will be recorded in the ‘footfall’ table. --find the open transaction number for the given till from tills screen in back office begin transaction update cashdraw set csdclosedat = dateadd(d,-1,csdclosedat) where csdopentxnno = commit promotions promotions: promotion save error – savepromitems:’violation of primary key constraint' error details: savepromitems:’violation of primary key constraint 'pk_promdetail'. cannot insert duplicate key in object 'dbo.promdetail'’. promotions are applied on either an analysis code level or on a plu record number level (plurecno). if you attempt to setup a promotion against an item that has already been setup from the sub analysiscode level, and then try and apply the promotion at the top-level analysiscode, sql will attempt to save the promotion on a plurecno level as well which will result in the below sql statement error… =================================================================== date and time: 30 jun 2015 12:06:34 operator: mjs error source: pmbos form/object: fpromdetails sub/function: savepromitems =================================================================== ----------------------------------------------------- error -2147217900 ----------------------------------------------- violation of primary key constraint 'pk_promdetail'. cannot insert duplicate key in object 'dbo.promdetail'. =================================================================== sql statement: insert into promdetail (probranch, prorecno, proanzcode, proplurecno, propercentage, proreduceby, pronettprice, prombdeal, probuynn, progetnn) values (1, 4, '', 2699, 25, 0, 0, 0, 0, 0) solution search for plurecno linked to the promotion record number (prorecno) and delete it from the table. select * from promdetail where prorecno=4 and proplurecno=2699 delete from promdetail where prorecno=4 and proplurecno=2699 printing printing: ticket printer fails to print problem ticket printer not responding when trying to print tickets when admission tickets are sold from the till. solution first few things to check: ticket printer is powered on. cables are attached securely on both ends and the data cable is plugged into the correct port/socket at the back of the till. the ticket roll is inserted into the printer correctly. if not, the print queue name may be named differently to the name set in the merac bo system configuration. boca ticket printers usually for a boca ticket printer, the name configured in the merac bo system is boca, so renaming the print queue to ‘boca’ would fix the issue. boca ticket printers are usb attached so install themselves through windows pnp. once installed, rename the printer correctly through devices and printers and set the size of the tickets being printed. (each customer has a predefined form that defines these dimensions!) printing: boca ticket printer printing blank tickets solution size settings have not been configured correctly in printer properties. open printer properties and click general tab>>preferences>>advanced and ensure that the correct paper/output paper size settings are defined. if a form has been defined, select the appropriate form from the dropdown menu. from printer properties, click advanced>>printing defaults>>advanced and ensure that the correct paper/output paper size settings are defined. if a form has been defined, select the appropriate form from the dropdown menu. (this would propagate changes to printer properties>>general tab>>preferences>>advanced) example:- size settings have been saved as “alnwick ticket” named form in the below example… note! the older model boca uses a different plu ticket design to the newer model boca. it is thus essential to define two different ticket designs each with different boca ‘paper size profiles – forms’. printing: barcode labels not printing if a label printer is printing a barcode incorrectly and the stock item barcode has a ‘0’ to the front of the barcode, try changing the symbology to correct this. printing: barcodes printing issue - epson tm-l90 appending a ‘0’ to the beginning of an ean13 barcode fix on the merac computer in question, search for the stock item in back office and click print barcode and then uncheck the box to ‘manually choose barcode symbology’ (this adds a ‘0’ to the beginning of the barcode) and then close the window and then click print button. printing: unable to print to a network printer when configuring network attached printers whereby the printer is installed on a print server, if the printing device is removed, the pos till may return the following example error message when attempting to print… (it’s a kitchen receipt printer so it is possibly an epson tmu220 or tmu230) troubleshooting if the replacement printer has been plugged in using an ethernet cable, get the user to print a configuration page on the printer to obtain the ip address of the new printer. a utility installed on the server called epson tmnet winconfig is used for network device discovery by mac address for attached or previously attached epson printers. start>>all programs>>epsonnet>>tmnet winconfig>>launch ‘tmnet winconfig ver.3’ if epson tmnet winconfig is installed on the server, from tmnet winconfig, click on ethernet in the left-hand pane and then ping each ip address to determine which is not pingable. this will more than likely be the old device that has been removed. highlight the old printer ip address and click the configuration button and then tcp/ip tab and change the ip address to match the new ip address. this will force tmnet winconfig to assign the correct ip address to the network attached printer. now on the till, delete and re-add the shared printer or re-edit the old printer setup through ‘devices and printers’ and change the ip address to the new ip address. now use this information to determine which shared printer the ip address is associated on the server within ‘devices and printers’ because you will need this later to re-add the shared printer back onto the till. a utility installed on the server called epson tmnet winconfig is used for network device discovery by mac address for attached or previously attached espon printers. start>>all programs>>epsonnet>>tmnet winconfig>>launch ‘tmnet winconfig ver.3’ if epson tmnet winconfig is installed on the server, from tmnet winconfig, click on ethernet in the left-hand pane and then highlight the old printer ip address and click the configuration button and then tcp/ip tab and change the ip address to match the new ip address. this will force tmnet winconfig to assign the correct ip address to the network attached printer. now on the till, delete and re-add the shared printer or re-edit the old printer setup through ‘devices and printers’ and change the ip address to the new ip address. the kitchen receipt printer should now be able to print. the problem printing should now be resolved! printing: unable to print receipts from tills screen in back office. ‘invalid use of null’ error error details below:- = date and time: 31 jul 2015 09:44:43 operator: mel error source: pmbos form/object: fviewtxn sub/function: showtxn = - error 94 invalid use of null = you can print receipts for other tills. for the offending till in till configuration, you will notice no receipt design defined in ‘alt default till documents’. if there is no receipt printer setup you cannot set a receipt design from till configuration so to get around this, do the following… solution select * from tills begin transaction update tills set tilreceiptdoc = 1 where tilreceiptdoc is null commit printing: failed to claim opos receipt printer if still not able to print and you get the following error messages when opening up the pos till program… first try close down both merac back office system and pos till program and then open opos and try run a health check. if this fails, the print device could very possibly be plugged into another com port not configured to the device defined in opos or it could be attached to a usb port in which case device would be regarded as defunct in opos and not considered at all when getting the printer to work. to check if the printer is attached to a usb port, open devices and printers and you may find a printer in the list with a random device make/model name which has been installed automatically by windows which you will then have to rename to winreceipt. then open the merac back office system>>till configuration>>receipt/slip printer and set to winreceipt. recreate till data and test printing. now when opening up the opos till software, no error message will be displayed and you should be able to print. printing: permissions error when trying to print a purchase order sales/purchase orders –these are online purchases of stock. if you try and print the below sales/purchase order picking list and receive a permissions error as seen below… fix check that the report is in the reports folder (pickinglist.rpt) and if not, import it from back office which should fix the issue. accounts/customers & memberships accounts|customers|memberships: unable to void new member entered through till if you open a till and click memberships\\new member button to open the mstore membership wizard and add a new membership, a membership card and welcome letter will be printed after which you will then need to swipe the membership card and enter in the joining fee and entry items to basket and then make payment. note! you cannot void the transaction once the new member has been entered into the till without completing the transaction. if you do you will receive the following “lock error”… fix to get around this, the till operator would need to complete the transaction and then carry out a refund of the receipt to balance the till and then open back office and find the member by searching the associated membership number and either set the expiry to yesterday’s date or simply delete the membership from back office. when adding a member from the till, the till expects payment at the end of each transaction so if this is not required, best is to add the member from back office. accounts|customers|memberships: giftaid signature outside of minmax date range problem when attempting to open a member from back office, the system returns the following error message… error details- =================================================================== date and time: 23 sep 2015 12:55:10 operator: pr error source: pmbos form/object: fcustindex sub/function: openmember =================================================================== ----------------------------------------------------- error 35773 ----------------------------------------------------- a date was specified that does not fall within the mindate and maxdate properties. =================================================================== sql statement: select isnull(pvtadoptbcdid, 0) as pvtadoptbcdid from privilegeschemes where pvtbranch = 1 and pvtcode = (select prvcode from accprivilege where prvbranch=1 and prvaccrecno=5744 and prvcusseq=1) =================================================================== fix select * from account where accgiftaid = 1 and accgiftaidsigned = '1899-12-30 00:00:00.000' begin transaction update account set accgiftaidsigned = getdate() where accgiftaid = 1 and accgiftaidsigned = '1899-12-30 00:00:00.000' rollback --commit accounts|customers|memberships: unable to add new contacts to a customer account when customers are imported into merac, the system returns error “this key is already associated with an element of this collection” when trying to add a contact, troubleshooting check to see whether the import has failed to set the account.acclastcustseq field to match the highest cusseq on that account. so it assumed the next customer on the account would be cusseq=1 which exists of course so it goes bang. reports reports: error – failed to retrieve data from the database problem receive the following error message when trying to run a report… solution one of the sql data entries extracted from the database had a character length which was a bit too long for the report so had extended these fields. reports: error – ‘frepparams / exportdata error’ problem when trying to run a transaction analysis report, the back office computer returns the following error message ‘frepparams/ exportdata’ error. troubleshooting first log onto the merac server and open sql management studio and try and run the sql statement given in the error message to determine what the cause of the error is. in the below example you can see that rep_txnanalysisnominalcodes expects an additional parameter called ‘outlet’ which is not available or is missing in the report. example:- try run the report from the server from back office and if it works then the local report (.rpt) file on the back office computer is out-of-date. to verify if the report is out of date, from the sql server, expand programmability container within the sql database tree and navigate to ‘txnanalysisnom dbo procedure’ (i.e. dbo.rep_txnanalysisnominlacodes) under stored procedures. take out the code and create a new query and press f5 to execute and see whether the report is displayed correctly without errors on the server. if it is, then the report must be out-of-date on the back office computer that was used to run the report. note! if you do not find anything obvious causing of the error when running the sql statement on the sql server, check the application event log from where the statement was run for more details as it could be an issue with the installation of crystal reports locally. solution 1)on the till in question, open merac mstore bo system>>reports>>transaction reports>>update (note! the update process may take a while to complete with no clear indication that anything is happening until you see the “all reports updated successfully” message) and then try re-run the report. or 2)delete c:\\program files\\merac\\reports\\txnanalysisnom.rpt or c:\\program files (x86)\\merac\\reports\\txnanalysisnom.rpt and then try re-run the report. note! if there is still an issue, it could be a local permissions issue. reports: error – ‘one or more fields could not be found in the result set. use verify database to update the report’ steps:- log onto the merac server and navigate to meracdata\\reports directory and verify the offending report file version (i.e. .rpt file modified version date) and compare it to the local copy. if heavily out-of-date, copy ours or a known working version over to customer’s server within meracdata\\reports. open sql management studio localhost>>navigate to by expanding the following containers - databases - database name (e.g. mstore) - programmability - stored procedures. (search for the appropriate dbo.xxxx stored procedure for the report and right-click and choose modify to view the code) check the change history comments field at the top of sql code to compare date with another customer’s stored procedure and if out-of-date, overwrite the broken version by doing the following – copy and paste all the code onto the server from where the problem is reported, remove the header lines in the code, highlight all the code copied and click the execute button and make sure the command executes successfully… try re-run the report again from the bo system. reports: update reports (for 3.14 and 3.15 alike) copy over a known good version report file to the desktop on the server. run good version stored procedure. delete the existing report from merac back office to remove the record from sql reports table. import the .rpt file saved on the desktop. this process will insert a new record into the sql reports table and copy the report into meracdata\\reports. click update to copy the new report file to the local merac\\reports folder. repeat the update procedure on each and every client to update their report version locally. this process will copy down the latest version from meracdata\\reports. reports: crystal reports .rpt file not found error solution from sql, use the select statement to view all contents of the reports table and then verify the name of the report and then delete the entry and then from any client (i.e. back office computer), re-import the report file back into back office/reports which should then update sql reports table with a new entry of the report. example:- select * from reports where reptitle = 'member visits' begin transaction delete from reports where reptitle = 'member visits' commit check that the ini file datapath is setup correctly. check that the reports folder location is setup correctly from back office>>system options>>general tab from the client (merac back office computer), navigate to the local reports directory and rename the existing report file (.rpt) and then navigate to back office/reports and then click update button to update all reports stored in the merac server reports folder. this will automatically update the reports table in sql with the report entry recently deleted from the table and should also copy across an up-to-date version of the report file from server to the client. if the report is not visible in back office/reports, click import button to import the report into merac back office system, which it would be, since we deleted it from the reports table in sql. done! reports: export error - odbc driver does not support the requested properties example:- the above error is referring to running the footfall report. troubleshooting sql statement: exec rep_footfall 0, 0, 0, 0, 0, '01 oct 2014 00:00:00', '30 oct 2014 23:59:59' by examining the code of the report in crystal reports, in the above example, the stored procedure is passing 8 parameters but the actual crystal reports file (.rpt) is expecting only 7 parameters passed to it by the stored procedure. solution in the above you can see that the stored procedure @daterange parameter has been commented out and then you just declare a value to the variable as seen in the second part of the exhibit encircled above since the crystal report file is not passing this parameter to the stored procedure so the stored procedure does not know what to do with this additionally defined parameter. then execute the stored procedure to recompile it and then this should fix the issue. reports: unable to run any reports - returning sql error – frepparams/invokerepparams solution have fixed this by updating the local mstore.ini path to point to the correct location of the local merac installation folder. if the exact same error is returned as seen above except that the error also mentions a permissions error, ensure that the everyone group is granted full permissions to c:\\program files (x86)\\merac (for back office 3.14 or below) or c:\\programdata\\merac (for back office 3.15). reports: reports taking a long time to load and display troubleshooting first try delete the local reports file and then re-run the report. secondly, try run the report from the server and if there are issues, copy and run a known working store procedure for the given report (e.g. txnanalysis.rpt) from another known working customer server and run the sql code for the procedure on the sql server to update its procedure with a known working version. re-run the report and it should work. reports: very slow when running any reports problem merac back office system crashes or takes a very long time to complete (e.g. 10 mins as opposed to 25 secs to run a report). troubleshooting tried running this from the server and the same problem occurs. hour glass appears and back office system hangs. checked resources and cpu is fine and working/dynamic memory availability is fine… solution this matter has been solved by increasing the amount of sql server memory allocation and configuring the sql server to use dynamic memory for indexing. steps:- open ‘sql server management studio’ and right-click the top level and select properties>>memory and make the below adjustments… now restarted the sql server service – open ‘sql server configuration manager’ and then click on sql server services and restart sql server (mssqlserver) note! best practice to stop and then restart the sql server service. now reconnect back to the database by clicking connect>>database engine and log back on… try re-run the report through a new query and see if there is any improvement on the response time (e.g. rep_bookings 1, '24 sep 2014', '30 sep 2014', 0, '') other important information regarding sql server management studio encircled below… in the highlighted management folder within microsoft sql server management studio tree structure, normally there is an additional indexing tool that allows you to defrag database indexing. sql command: sp_who --command outputs who is logged onto the sql server database note! as more and more reports are run on the sql server, so the temp reports table grows larger and larger in size and hence may hinder the performance on running reports. to fix this issue, either restart sql server service and the sql agent service (used for monitoring and maintenance purposes) or last resort, restart the sql server, which should return the size back to its default size (file name is temp.db). reports: back office crash following running a report for version 3.14 problem client or server back office installation crashes following clicking ‘screen’ button to run and view the contents of the report and then closing it. solution try run a repair of merac back office which should fix the issue. if however, you receive the following ‘business objects enterprise secldap.dll’ error during the repair, copy over the offending dll from a known working computer (located in either c:\\windows\\system32\\ and/or c:\\windows\\system32\\syswow64 folder) and place it in the path location specified by the error seen below… re-run the repair again. if it still complains that the dll has not been registered, ignore the error and once the installation is complete, open back office and login and then see if you can run a report. if you can, all is ok and working as it should. rename the dll usp10.dll to _usp10.dll.old. this dll is located in the following places: 32 bit operating system c:\\program files\\common files\\business objects\\3.0\\bin c:\\program files\\common files\\microsoft shared\\officexx 64 bit operating system c:\\program files (x86)\\common files\\business objects\\3.0\\bin c:\\program files (x86)\\common files\\microsoft shared\\officexx done! reports: data extract error or report error – subscript out of range solution open excel and change “include this many sheets” dropdown from 1 to 3 as seen below and then try and run the data extract again… reports: seating plan report returning an error troubleshooting review the stored procedure code and to determine what is causing the issue. looking at the two temp tables setup in the stored procedure… …all columns/fields are set to ‘not null’ which means the value “null” cannot be returned into the table. when you run the insert subqueries for both #tbljourneydetails and #tblbookingdetails, you can see a null value is returned for both jdseatingplandesc and bdbkhref… --select * from lookupgroups --where lkgdescription like 'booking types%' --select * from lookups --select lkudescription from lookups --where lkugroupcode = 8 --insert into #tbljourneydetails select slcjourneyline, left(lkudescription, 30), shdrecno, shddescription, substring(convert(varchar(20), shddatetime, 113), 13,5), slcdescr, sphdescr from sessionhdr inner join sessionlocations on shdbranch = slcbranch and shdseslocid = slcseslocid inner join lookups on slcjourneyline = lkurecno left join seatingplanheader on shdbranch = sphbranch and shdseatingplan = sphplanid -- where shddatetime >= @fdatetime and shddatetime = '7 dec 2014 00:00' and shddatetime = @fdatetime and shddatetime = '7 dec 2014 00:00' and shddatetime in the footfall analysis report, the footfall column is the actual sum of ‘ftfqty’ and ‘ftffootfall’ from the footfall table between the given dates… reports: promotions report – duplicate promotion descriptive names in the below sql extract, you can see that the promotion being used for ‘classic gardens’ validity date (‘prhstartdate’ and ‘prhenddate’) ‘txnpromdesc’ is would match the promotion name in back office short description name. reports: export button greyed out on the parameters window the fix is report specific so you would need to repeat the fix for each and every report that this problem occurs. fix the export button on the report parameters screen is only enabled if the repprocname field in the reports table is set with the actual stored procedure name. reports: report not importing correctly when a stored procedure for a report is updated as well as the .rpt file upadated, an import of the report fails as a result of the stored procedure not being found. fix delete the report entry in the reports table and then try re-import and make sure the entry in the table ‘repprocname’ is updated with the correct stored procedure name as seen in the below example… data extracts data extract: mailing extract error – the object invoked has disconnected from its client solution try close down merac back office and re-open and re-run the report. memberships>>mailing cause may have been caused by network connectivity issues. giftaid giftaid: claim submission failing giftaid claim submissions error - authentication failure. the supplied user credentials failed validation for the requested service if the account details are not setup correctly (i.e. the name of the 'registered charitable contact' is incorrect) even if the userid and password is correct and the user can login to the gateway directly (https://online.hmrc.gov.uk/login), the customer would need to contact the hmrc to get the below details verified... example:- giftaid claim submissions error - unable to submit giftaid claims receive error: ‘error when submitting claim to hmrc: please see error report’ the below schema error ‘your submission contains an unrecognised namespace’… fix uninstall giftaid from add/remove programs and then download the latest version of giftaid manager from the merac download page and this should fix the issue. note! this will not cause loss of current giftaid claims stored locally on the computer. these are stored in a location other than within the installation directory. giftaid write submission error after installing giftaid manager from merac website, if a write submission error is returned, then check that the correct permissions have been applied to the giftaid folder under c:\\program files (x86)\\merac\\ and if so, uninstall gift manager and reinstall. note! this will not cause loss of current giftaid claims stored locally on the computer. these are stored in a location other than within the installation directory. giftaid: declarations report hanging problem giftaid declarations report hanging when specifying partial date search criteria to find unclaimed entries. also when doing a full month report for the same month it does output report information. the report includes branch_number, giftaid unclaimed entries, till number and receipt information. example: if changing the date range to: 01 sep – 30 sep (this works) if changing the date range to: 22 sep - 30 sept (it just hangs) solution download the newer version of giftaid manager from the merac website and install it which should fix this issue. giftaid: ‘divisible by zero’ sql statement function error setting the plu sell price to £0.00 with the giftaid option still entered will render a till “divisible by zero” sql statement function error. fix this by disabling giftaid for the item set to £0.00. giftaid: plu view/add price showing giftaidable claimable amount not equal to 10% as system options defines reason the reason for this is because when the plu ‘adult admission’ ticket was initially setup, the sell price was set to £100.00 which means the system calculated 10% giftaid on this item correctly as you can see below. if the sell price is changed in the future, the giftaid contribution calculated when the plu was initially setup would need to be manually adjusted to reflect the newly revised giftaid contribution. ‘adult admission’ shows giftaid claimable amount of £10.00 which is correct because the initial sell price for the item had been set to £100.00 which was later changed to £50.00. there is no proof of this price change unfortunately because the item had not been sold at the original price so there is no transaction recorded against it. by default, all customers who donate to a charity (i.e. they are registered as a charity organization) will contribute 10% towards giftaid (i.e. there chosen charity). giftaid: fix taxing on giftaidable items to prevent taxing on giftaidable items sold, you can run ‘util_recalculategiftaidtable’ stored procedure to fix this. e.g. customername: painswick rococo gardens obviously, painswick do not want to pay tax on giftaid so nik has setup a sql statement to update the giftaid tables to prevent this from happening. item price claimable amount (normally 10% of the original price or rounded off to the closest price) e.g. plus incl. giftaid admission family 30.00 3.00 (not taxable) e.g. plus dis-incl. giftaid 27.00 (taxable) giftaid – giftaid conversion report not matching entries in the giftaid claim submissions list problem giftaid module addin used for giftaid claim submissions was showing indifferently (e.g. a higher amount) to the actual giftaid conversions report. solution giftaid backfix… narrowed it down to locate a specific date in time when the giftaid claim amount is different to the giftaid conversion report. select gftsurname,gftpostcode, txhcompleted,gftclaimamount from txnheader inner join giftaid on gfttxnno = txhno where txhcompleted between '13 jul 2014 03:00' and '13 jul 2014 23:59' --order by txhcompleted asc or select gftclaimamount from txnheader --select sum(gftclaimamount) from txnheader inner join giftaid on gfttxnno = txhno where txhcompleted between '13 nov 2014 10:39' and '13 nov 2014 10:40' --example:- --ga claimamount = 55.80 --ga conversion report = 27.90 --need to check stored procedure checked to see what transaction/s was/were involved to try establish or determine a pattern or whether the transaction was linked to a booking or member. select * from txnheader inner join txndetail on txnno = txhno where txhcompleted between '13 nov 2014 10:39' and '13 nov 2014 10:40' inspect the transaction file stored local on the till to find out if the transaction amounts tie up to the data written to the server. the data written to the local transaction file could be different to the actual data written to the database for a given transaction. establish from the date the problem was reported and to a wide date range in the future whether or not the same problem is occurring. if not, then the solution would be to back fix the data using ‘util_recalculategiftaidtable’ stored procedure. you can verify that the data is corrected once the util_recalculategiftaidtable stored procedure has been run using the below statement. there will be transactions whereby the sum of txnlinesellvalue for a given transaction is greater than the giftaid gftclaimamount. this is because some transactions may include items that are not giftaidable… select txhcompleted, txhno,gftclaimamount,sum(txnlinesellvalue) as ‘txnvalue’ from txnheader inner join giftaid on gfttxnno = txhno inner join txndetail on txnno = txhno where txhcompleted between '01 nov 2014 00:00' and '30 nov 2014 23:59' and gftclaimamount is not null group by txhno,gftclaimamount, txhcompleted order by gftclaimamount - sum(txnlinesellvalue) desc --in the above 'order by' statement, we know that the sum(txnlinesellvalue) will either be higher or equal to --gftclaimamount depending on whether all items are giftaidable for the given transaction (value = ‘0’) or the transaction --includes items that are not giftaidable in which case they will appear in the bottom of the list - not all ‘transaction line sell --values’ in a given transaction are giftaidable! --the above 'order by' will arrange entries starting from transactions that result in a value of ‘0’ followed by transactions that --result in a value less than ‘0’ --each transaction may include a number of line sell items/values where each transaction is linked to a giftaid table --gftclaimamount back office back office: unable to run ‘recreate till data’ - receive error: unable to connect to meracupdater service this is a known issue which occurs with merac bo v3.15 installed and is not really a problem. the error returned does not prevent any of the tills from updating. advise the customer at this point in time to ignore the error message. back office: merac back office installation troubleshooting if the merac installation fails to complete as a result of not finding a local path, this is caused by the user account being logged on with a roaming profile with folder redirection. cause if the setup.exe file is run from a redirected folder, the executable will check compatibility on the system before running the msi. because the temporary folder location used to store temp installation files during any installation is local (%userprofile%\\appdata\\local\\temp) and the executable is searching for the msi from the temp folder location within the user’s roaming profile on the remote server, it cannot be found and the installation fails. solution to get around this, run the executable and when presented with an error do not close the error window. navigate to %userprofile%\\appdata\\local\\temp and the msi installation folder should have copied across. copy the downloaded temp installation folder (i.e. in this case named “_is9189” containing the msi to the local computer desktop and then close the error windows after which the temp folder and its contents will be deleted. now re-run the installation. back office: login update notification message problem when logging into to back office from either a client or the server and you receive a message stating that meracos.exe is out of date, the notification window will ask you to click ‘yes’ or ‘no’ button to run the update or not. cause when you recreate till data, any changes made are copied to the sql database and uses the timestamp when the update was copied across to the database. because there is a timestamp mis-match between the server file version and files authorized in updatenewver folder on the server, the error is displayed stating that the offending file is out of date. solution obviously because we are experiencing the same error on the server, it is not a local client permissions or ini configuration file issue causing the problem. do the following:- select * from updateserverfiles begin transaction delete * from updateserverfiles where upsid = x commit back office: merac back office software out-of-date error problem when launching back office, receive a “program out of date” error as seen below… fix this is likely caused by either: not having the the correct write permissions to ‘c:\\programs files\\merac’ or ‘c:\\programs files(x86)\\merac’ folder. not having a connection to the \\meracdata share therefore preventing the system from running updates. uac settings on windows 7 or higher preventing the running of mstoreupdater.exe or meracupdater service. check that mstoreupdater.exe is in the windows startup folder or that meracupdater service is started. make sure that there are no ‘compatibility files’ listed in windows explorer pointing the merac installation to the wrong system files. back office: computer not able to communicate with the merac server troubleshooting either add an entry to the hosts file to include an entry for the merac server or ensure that if the back office computer is part of a workgroup and the server a domain, that the network has been defined as a ‘domain network’. if setup any different to this (i.e. public or private network), firewall settings could be blocking access to the server. or check that the switch that the computer is connected to is not blocking connections from the host by mac address (customer it department will need to check this). back office: trying to adjust a plu sell value returns message to specify a price matrix workaround you can update the sell value of a plu associated with a pricing matrix by clicking on edit>>copy and then making changes to the sell value with introduction to a price break. back office: selling of session tickets not displaying correct num qty in back office steps:- add the sessionable plus to basket press subtotal button the till will then prompt the till operator if they would like to book now (i.e. book meaning reserve the session so no bookingrefno will be created) press yes highlight the session for the chosen date and then insert a name that the session is booked for (i.e. in this case is for ‘chris’). the name will be inserted into the sessname field within the sessionbkgs table and then press ok sessname the session reservation will be displayed on the right-hand side as seen below… now when you select the session from add/edit sessiontours in back office and click make booking button you can see that the ‘num’ value encircled below does not match the actual value from the till. the till had a value of ‘2’ inserted and back office is showing a value of ‘1’… to verify the data in sql, do the following:- select * from sessionhdr where shddatetime = '20 aug 2015 16:00' and shddescription like 'leap of faith%' --shdrecno = 7958 for ‘leap of faith: session 5’ session type. if you reserve the same session type as seen above (one at 14:00 --and one at 16:00) each will have different sessrecno’s) select * from sessionbkgs select * from sessionhdr inner join sessionbkgs on shdrecno = sesshdrecno where shdrecno = 7958 and solution escalate to dev team back office: files not updating when meracupdater runs those errors mean one of 3 things:- 1) the files mentioned are not currently in the software distribution folder - \\\\\\meracdata\\updatenewver\\cache 2) the current locally-logged-on user does not have permissions to read the contents of this network shared folder 3) the current locally-logged-on user does not have permissions to copy those files to the local c:\\program files\\merac (or c:\\program files (x86)\\merac) folder troubleshooting you can test 1) by typing the path above into start > run on that computer. you can test 3) by manually attempting to copy one of those files from the source to the destination folders. back office: creating a new lookup item “violation of primary key constraint” error fix determine the maximum record number in the lookups table and then set the ‘recnum’ in the ‘recordids’ table to that number. this will ensure that when a new lookup item is created that, that the next available record number in the lookup table will be assigned. example of how adding a lookup item affects the respective tables:- back office: stock entry duplicate primary key error the above sql statement error usually occurs when your table ‘recordids’ are out of sync. to fix this run the following sequence of sql commands to update the ‘ridrecnum’ in the ‘recordids’ table to match that of the maximum ‘stkrecno’ in the stock table, as seen below. in this way, when a new stock item is added to the merac system, a non-duplicate ‘stkrecno’ will be assigned. examples:- back office: unable to move stock from ‘unknown stock location’ to known stock location if a stock count quantity has been assigned to a stock location and the stock location later gets deleted, when you click on the glasses icon within the stock maintenance window, you will notice that the stock location has a description of ‘unknown stock location'. moving stock from deleted stock location to known undeleted stock location when carrying out a stock movement from location to location from back office, because the stock location for which the quantity had been assigned has been deleted, ‘unknown stock location’ is not visible in the from location in order to move the item to another location. solution we need to move the stock count for the given stock item from ‘unknown stock location’ to the correct location and then delete the ‘unknown stock location’ so that it no longer appears in the list of stock locations as seen below… below are the known stock locations that exist in the database… (lkurecno = stlloc) as you can see, ‘unknown stock location’ (stlloc = 97) does not exist in lookups table where lkugroupcode = 12. begin transaction --delete from stockloc where stlloc = 97 --update stockloc set stlqty = 6 where stlrecno = 2110 and stlloc = 99 rollback commit the result will be as follows for the given stock item… back office: forecasts information not updated correctly for footfall proj – projection of footfall forecast from previous years actual footfall. they must equal normally but not necessarily. act – actual footfall of previous year. staff rota – can be changed from the forecasting display window manually by double-clicking the cell and then typing the value ‘closed’ or ‘r.1’ or ‘r.2’ into the cell. click save and then update forecast button. troubleshooting look at a given year where actual footfall difference appears (e.g. as seen above example encircled in red), there appears to be no forecast data for the 29/06/2014 but there is for 30/06/2014. check the below tables:- select * from forecasts select * from depsummary select * from forecasts where fordate between '29 jun 2014 00:00' and '30 jun 2014 23:59' --don’t worry if 'foractfootfall' is a value of '0'. this is not necessarily the actual footfall select * from depsummary where dsudate between '29 jun 2014 00:00' and '30 jun 2014 23:59' --you will notice that there will possibly be missing data for 29/06/2014. run the below stored procedures below to fix this. --mc_insertdepsummary --alter procedure [dbo].[mc_insertdepsummary] '01 dec 2013','01 feb 2017' --@fromdate as datetime = 0, --@todate as datetime = 0 note! in the mc_insertdepsummary stored procedure, make sure you choose a date range that encompasses a wide range to account for previous years that rely on previous year’s actuals to be included as well in order to tie up days with dates. for example – ‘thurs, 01 oct 2014’ may not necessarily be ‘thurs, 01 oct 2015’ but actually ‘sat, 01 oct 2015’ which could have been a non-trading date so projected footfall would not display correctly. alter procedure [dbo].[mc_updatedepsummary] @yearsback as tinyint = 0 -- 0=up to one month old transactions; 1=up to one year and one month old txns; and so on) mc_updatedepsummary 2 now if you go back into merac back office dashboard/forecasting and then click the update forecast button, the data missing will now appear. you may need to manually amend any projected footfall figures that have not updated with the previous years actual footfall figures. back office: mailing export/mailmerge to ms excel/word error pmbos: microsoft excel/word returned the following error:- application-defined or object-defined error example:- 2 1 3 1 - exports queried output displayed in the grey section to ms excel as a data list. click the export data to list button. 2 - if wanting to export the queried output displayed in the grey section to ms word for the purpose of mail merging the data list. click the browse button (3 dotted button) to the far right to browse to and choose the appropriate mail merge letter (i.e. in this case is called ‘renew ack letter.docx’). 3 - click the mail merge to word button. problem when choosing action sequence ‘1’ or ‘3’, the following error is produced… solution first open ms excel and open excel options and ensure that three sheets are defined for all workbooks open command prompt and try and ping the merac server hostname and ip address or try browse the server url. open internet explorer settings and click security tab and 'trusted sites’ add both \\meracdata and \\meracdata to trusted list and close all browser instances. now try click on the buttons again. once the letter has been merged into ms word, click mailing tab and then ‘finish & merge’ in the mailmerge toolbar. choose ‘all’ and the then the entire exported data list should be inserted into the mailmerge letter. done! back office: error when attempting to clone an existing receipt or ticket design search for the ticket design to clone, select it from the drop-down and then click on display button to view the details of the ticket design to clone… click clone button... insert document name in highlighted red field below and then click save changes button… if a sql statement error is returned, it is likely a ‘printlayoutheader’ table sequencing issue. run the following to correct this: from the above you can see that the last allocated sequence number in the printlayoutheader table is 1104. fix now amend the ‘ridrecnum’ value for both receiptdefinitions and ticketdefinitions within the ‘recordids’ table to a higher numerical value (e.g. 2000). debit/credit cards credit cards: card machines down ***(if using ack)*** ***************** log onto the customer’s merac server end process tree for wbtterm3.exe (old version exe’s are ecpwss_c.exe and ecpwssvc.exe – no need to terminate) stop/start both ack eft windows socket server and ack eft node encryption services restart normal polling (shortcut on desktop) [normal polling is a scheduled task to poll debit/credit card transactions] re – normal polling (aka. scheduled polling) usually a common error concerning normal polling crashed on server would be error message “batch transfer in process” which means the previous scheduled polling has been executed successfully but crashed thereafter. to fix the issue, implement the above fix. ***(if using yespay)*** ******************* log onto the till and kill java.exe and javaw.exe. log off the pos till program. restart startposserver.bat. re-run and log back into pos till program and test by taking a dummy payment. ***(if using verifone ocius sentinel)*** ********************************* note! default installation path: ‘c:\\program files\\verifone’ and ‘c:\\documents and settings\\all users\\application data\\verifone\\payware ocius sentinel’ log onto each till and terminate the pos till program. right-click in the system tray and exit ocius sentinel program (quit the ocius sentinel card machine program). double-click the ocius sentinel program shortcut icon in then startup folder in the start menu (not the desktop) to restart the program and then the icon should re-appear in the system tray. double-click the ocius sentinel icon in the system tray and then log back into ocius as follows: [enter pin code ‘1234’ and click enter button] twice… once logged in, double-click on the ocius sentinel icon again to verify that the card system is online which will be identified as the ocius sentinel window looking similar to the following… click on hide button and then re-launch the pos till program repeat for all tills (ask dave radford for registry change fix if needed!) note! the normal install sets up an ocius sentinel shortcut exe file in c:\\documents and settings\\all users\\start menu\\program files by default that does not work. solution browse to c:\\program files\\verifone folder and recreate a new ocius sentinel shortcut (for windows xp) copy the shortcut to ‘c:\\documents and settings\\all users\\start menu\\program files\\startup’ or ‘c:\\documents and settings\\till\\start menu\\program files\\startup’ and then repeat the ocius sentinel initialization process above. (for windows 7) copy the shortcut to ‘c:\\programdata\\microsoft\\windows\\start menu\\programs\\startup’ and then repeat the ocius sentinel initialization process above. if that does not resolve the issue, get the user to plug the serial to usb cable/converter into a different usb port and then restarted the ocius sentinel program – this should resolve the issue. this process has caused the pinpad ocius sentinel software to re-claim the device using an alternative usb port. credit card: unable to take card payments – till offline if customer is unable to carry out pdq credit card payments and the till is showing a red box at the bottom right-hand-side saying offline. solution delete/rename the tillstatus file in c:\\program files\\merac\\ note! when a till goes offline, a message will be displayed at the bottom in red/white saying ‘offline’. it will then create a file called ‘tillstatus’ or ‘netstatus’ (a text file) in c:\\program files\\merac directory on the till. to get the till back online, delete/rename this file to fix the issue or add items to the basket and the ‘void all’ to force a reconnection to the server. you could also click on the ‘offline’ message at the bottom of the till screen and select ‘re-try again’ to force re-connectivity. credit card: yespay error – “transaction failed : declined offline. please take alternative payment” sent log files to yespay support. credit card: unable to read debit/credit cards when swiped through the till pdq card reader problem till operator reports that credit card readers are becoming more and more mechanically unreliable, often not recognising perfectly good cards and staff have to ask customers to remove cards and try again. if the card readers are failing to read the chips correctly then it would be down to hardware. odds are that it could be resolved by using a cleaning card. they may have become dirty etc. solution get the customer to insert a smart card reader cleaning card into the card machine a few times to rid of stubborn contaminants (i.e. dust and dirt etc.). if needed, we can send the customer a cleaning card in the post at a small fee (discuss with dave or mikec but we normally charge £2.00 per card cleaner). this card cleaner is a single use card once opened from the wrapper – unwrap and then clean all machines in a single go and throw the card away as it will dry up and be of no use thereafter. if this does not improve things then sales@merac.co.uk can advise on how much a replacement pdq machine will be. a pinpad software update may be required. the cashier needs to be at the till at the time you remotely assist in carrying out a pinpad software update! the smart card reader for the card machine could be damaged. credit card: chip&pin not working if you insert a chip&pin card into a card reader and the card machine returns a message saying “swipe card (requires a customer signature)” instead of “chip found (does not require a customer signature)” message, then it cannot be a fault with the hardware. it is likely a firmware issue and the needs to be re-flashed or upgraded. credit card: yespay/worldpay – cashbacks not working provided worldpay confirm that cashbacks has been enabled for the respective tid, do the following:- go into c:\\yeseft\\common files\\conf and copy all the files and paste them in c:\\yeseft\\conf (replacing the existing files). go into c:\\yeseft\\common files\\properties and copy all the files and paste them in c:\\yeseft\\properties (replacing the existing files). go into c:\\yeseft\\conf and delete the three data set files and then initialize the terminal, namely: eftacquirerdataset.xml eftissuerdataset.xml eftmerchantdataset.xml follow the steps mentioned and then try to perform a cashback transaction. if the below “multiple terminal installation” message appears when re-initializing the software, contact yespay/worldpay and request a keychange… credit card: yespay - card refunds using easyvterminal version 3445 just a heads up. if you receive any calls from customers saying that they are unable to refund against a card with the pdq card machine returning error ‘transaction failed’. to fix this issue, upgrade their version software to 3445 and then when the till operator enters the card number and expiry, when they are presented with the below box… …advise then to not enter start date and issue no and simply press ok on this window and it should work fine. if you enter in the start date and issue no it crashes windows and the entire computer/till system shuts down resulting in them having to press the power button to turn the till back on. also when entering the expiry date on the card machine, the expiry date will appear differently from the easyvterminal window which is normal (confirmed by yespay support). credit card: yespay - card payment failure as a result of till going offline subtotal>>credit card card is inserted into the reader. then void receipt is printed. the above happens only if the customer is running easyvterminal 2.2.4.1 which does not support processing of offline transactions. for example if during a transaction, the till operator decides to take a card payment and the internet goes down, the above error message will be displayed. the outstanding transactions will be written to a file in the local yeseft folder. workaround zip the folder and send to yespay to upload the pending transactions. fix uninstall 2.2.4.1. and upgrade to 2.2.4.2 as this version onwards supports offline card payment transactions. credit card: polling query following moving from ack to yespay a customer may ask whether all polled transactions have been closed off following moving over from ack to yespay. you can verify this by checking for any pending transactions. this is done by running a batch file on the ack server to check authorized transactions against what the bank has processed (dave can take a look at that). ack (old system being decommissioned for use) uses dialup modem to connect. credit cards: ocius sentinel – ‘check for pinpad’ message from ocius sentinel window problem after reinitializing ocius sentinel to connect to the pinpad, the console displays the message ‘check for pinpad’ as seen below. solution wait until the software finds the device as the software it looking for the pinpad. if after a 5 mins it does not find anything and is stuck on this message, try restarting the till. credit cards: ocius sentinel not detecting device on com port configuring ocius sentinel to manually detect the pinpad plugged into an unknown com port. credit cards: yespay – easyvterminal startup issues when attempting to restart yespay using startposserver.bat, you may receive a combination of the following two error messages:- startup issue 1 error1: ‘unable to open easyvterminal. please check com port…’ and error2: ‘unable to initialize easyvterminal. ststerminalexception: unable to reset reader, response…’ close the pos till program. get the customer to check which com port the card machine is plugged into and ensure it matches the configuration panel. stop java.exe and javaw.exe. power off to the device and then wait 10 secs and then re-connect the power and wait for the device firmware to fully load (i.e. there should be a firmware version displayed on the screen when the device is fully loaded) double-click on yeseftinterface.bat or click startposserver.bat re-launch and log back into the pos till and test by trying to take payment. startup issue 2 yeseftinterface error: ‘portinuseexeption: port currently owned by sts.x’. cause if you receive the following error when clicking on startposserver.bat, this could mean the tid is possibly already registered and running at another till so to prevent fraudulent activity or abusing the license on more than one terminal at the same time, the yespay easyvterminal software will return the below error and fail to start up yespay at the till… the above can also be caused by other instances of java running in the background. terminate these from task manager and then relaunch startposserver.bat. and when clicking on “starting easyvterminal..” splash screen, the below error is displayed… solution contact yespay and request for a keychange and provide them the tid number as seen encircled below... note! the mid and tid info. is only displayed in yespay software version 2.2.4.2 upwards (which requires a keychange) and not 2.2.4.1 or earlier (which does not require a keychange). once the keychange has been performed, re-register the mid and tid. restart yespay easyvterminal whilst the pos till program is closed by double-clicking startposserver.bat. re-launch and log back into the pos till program. get the customer to try process another card payment transaction. credit cards: yespay error ‘stsserialportexception: javax.comm.nosuchportexception.1’ when starting startposserver, receive the above error fix check if pdq is attached via usb and if so if it is a verifone vx810/820, install the usb drivers and then ensure that easyvterminal setting have been set to correct com port in device manager. credit cards: yespay error ‘invalid key index’ when trying to run easyvterminal, receive error ‘invalid key index’ following keychange. cause this is because there is a discrepancy between the key registered for that terminal on the yespay server and that of which is registered on the pos terminal. fix any evt version following 2.2.4.1 required a keychange for new software installs. following a keychange and receiving ‘invalid key index’ error when starting evt would require you to copy the folder ‘\\\\svrcompany\\ftproot\\jtristem\\merac\\yespay\\commonfiles.zip’ to c:\\yeseft\\ on the till and then unzip and overwrite the existing folders with its contents. then restart evt and provided the card machine is powered on and plugged into the correct com port, should work! credit card: ack – problems processing card payments from till card payments failing on 1st payment attempt or all payment attempts at all tills problem error received when first payment attempt is made: “operation failed - card declined” or “please contact your bank to authorize”. what to determine: is the problem happening with multiple tills or at multiple card machines? if yes, then it is likely that they have an ack server setup or they could be experiencing network connectivity issues (i.e. no internet connection). if it is determine that they are using ack, then there could be a problem with normal polling. some customers have a single merac server and one or more ack servers to spread the load on card transactions. solution1 log onto the ack server and open task manager>>processes tab>>click ‘show all processes from all users’ and then locate and end process tree for wbtterm3.exe. open services snap-in and stop/start both ack eft windows socket server and ack eft node encryption services, then restart normal polling. or if the company/customer has more than one ack server in their environment, first determine which ack server you are connected to:- click start>>programs>>expand ack eft and then double-click ack maintenance manager… click open button to view the contents of the xml file… now click on normal polling in the taskbar to view the normal polling window and click cancel button. re-open the normal polling window from the taskbar and click close button (normal polling is linked to wbtterm3.exe). open task manager and end process for the following:- ecpwssxxx.exe instances (two of them for ‘ack eft windows socket server’ service) nodesvr.exe (for ‘ack eft node encryption’ service) open services and restart ack eft windows socket server and ack eft node encryption services. re-open normal polling by double-clicking on the normal polling icon on the desktop. open the command prompt on the ack server and enter the following sequence of commands to test that ack is configured correctly to make payments online. the ack software if configured correctly needs to communicating with the ack modem in order to dial out onto the telephone line. this dummy payment (using a non-existent card) is used to test a connection to the telephone line via the ack modem alone and does not actually connect to a bank… ******* you can also test that the ack modem connected to the server is able to dial out on the telephone line by opening the command prompt and then inserting the following series of commands: important: you must be in the command mode of your communication software to use the at commands +++ atdp (press enter key) (above at command instructs the modem to use pulse dial to dial out to the given number) atdt (press enter key) (above at command instructs the modem to use tone dial to dial out to the given number provided it is a touch-tone phone line) atd 9, (above at command instructs the modem to dial ‘9’ before dialling the given number) syntax: atd{dial modifier} 1234567 [enter] ; = resume command mode after dialling. if you need to dial a number that is too long to be contained in the command buffer (45 characters for the d command), use the semicolon (;) modifier to separate the dial string into multiple dial commands. all but the last command must end with the ; modifier. , = pause while dialling. the comma (,) dial modifier causes the modem to pause while dialling. the modem will pause the number of seconds specified in s-register s8 and then continue dialling. if a pause time longer than the value in s-register s8 needs to be used, it can be increased by either inserting more than one (,) in the dial command line or changing the value of s-register s8. in the following example, the command accesses the outside (public) telephone line with the 9 dial modifier. because the comma (,) dial modifier is present, the modem delays before dialling the telephone number 5551212. example: atd 9, 5551212 [enter] ! = using the hook flash. the exclamation point (!) dial modifier causes the modem to go on-hook (hang up) for one-half second and is equivalent to holding down the switch-hook on your telephone for one-half second. this feature is useful when transferring calls. w = wait for a subsequent dial tone. the w dial modifier causes a modem to wait for an additional dial tone before dialling the numbers that follow the w. the length of time the modem waits depends on the value in s-register s7. the modem can be instructed to dial through private branch exchanges (pbxs) or long-distance calling services that require delays during dialling. this can be done with the w command to wait for a secondary dial tone or with a comma (,) command to pause for a fixed time and then dial. example: atdt 9 w 12155551212 [enter] a/ = repeat. this command does not use the at prefix nor does it require a carriage return to enter. typing this command causes the modem to repeat the last command line entered, and is most useful for redialling telephone numbers that are busy. & fn = factory defaults. this command (in which n=0 or 1) returns all parameters to the selected set of factory defaults if the modem has factory defaults; not all modems do. h = hang up. this command tells the modem to go \"on-hook,\" or disconnect, the telephone line. o = online. this command returns the modem to the on-line mode and is usually used after the escape sequence (+++) to resume communication. zn = reset modem. this command (in which n=0 or 1) resets the modem to the configuration profile stored in non-volatile memory location 0 or 1. ******* after pressing the enter key, the acktgen agent window opens. click generate button… enter in a future expiry date (any)… enter a dummy card security number (any)… click on the enter button and then click none button twice when asked to enter postcode and house/flat number details. you should now see a connection being established with the bank if all is successful as seen below… obviously you get an “authorization failed…” error because the card does not exist. now get the customer to test by taking a card payment at the till from their end. solution2 if the problem is just with one card machine plugged into a particular till, it could be a till configuration issue in back office>>till configuration. ensure that the below is selected from ‘credit card sys’ drop down. then recreate till data and update the till… credit card: ack pdq credit card payments failing – no ack receipt printing when a credit card payment is made, if the system does not print an ack receipt then nothing was sent to the server and therefore no payment was made. customers could have a merac server and one or more ack servers. for customers using ack, they should have two distinct modems:- 1)sportster or usrobotics modem (used for polling allowing the banks to dial in to poll the server). 2)chiron 350 modem (used to seek live authorization). if a customer receives a modem timeout error when trying to make a payment, get the customer to try restart the chiron modem or if during manual polling, you receive the following error – ‘error establishing session. function not valid right now’… …try restart the sportster modem. credit card: ack cashback not working if cash back feature not working or available on till running ack, do the following: log onto the till in question and then run c:\\program files\\act\\eft\\acktgen click the configuration tab and ensure that 'cash back' is enabled open the command prompt and then run the following command:- xml2bin wait a couple minutes and then get the till operator to try again. credit card: processing card payments from the till – card payment screen fails to load problem when trying to process a card payment from the till and pressing sub-total>>credit card button, receive handle error “program error in: fepos / docommand”. invalid procedure call or argument for ‘show credit card payment screen’”. see below… cause and solution the wizard has not yet detected that there are items in the basket so returns the above fepos / docommand error. to get around this, wait a few more seconds to allow the wizard to finish what it was doing to allow it to determine what is in the basket and then press the credit button again and it should work. credit card: yespay – yeseft configuration tampered problem when running startposserver.bat receive the following error message: “yeseft configuration tampered, please re-run yeseftconfig.bat and press ok”. cause this normally happens if easyvterminal picks up any configuration changes in yeseftconfig. solution open yeseftconfig and ensure that settings are correct, then click apply followed by ok and then close yeseftconfig and try re-run startposserver.bat. note! any single change within yeseftconfig will over-write all contents of the c:\\yeseft\\config folder with changes to the configuration. it should run now without any errors credit card: yespay – yeseftinterface error: unable to load eft datasets solution contact yespay and ask them to carry out a keychange. credit card : yespay – yeseftinterface or startposserver: port currently owneed by sts.xxxx.stsemvterminal.x solution 1)first check that the pinpad is connected securely to the pos till and reboot the pinpad. 2)contact yespay and ask them to carry out a keychange. credit card: yespay – payment authorization failure message problem if a yespay credit card machine is not able to process payments (e.g. when attempting to process a payment, receive a message to contact your bank to authorize the payment). troubleshooting check the c:\\yeseft\\yeseftconfig.bat setup and till configuration. also try terminate the javaw.exe background process and then initialize startposserver.bat and then try process another payment. the c:\\yeseft\\startposserver.bat file should be placed in the windows startup folder. yeseftconfig needs to be set to use com3 and credit card device needs to be defined (e.g. vx810 or vx820). when credit card transactions are processed using yespay, javaw.exe is the process that runs in the background on the till to facilitate such transactions. if only one till is effected by processing credit card payments, try connect to the till and terminate javaw.exe on the till and restart yespay (you may need to run yespay again and terminate it again). credit card: credit card machine chip&pin working but not swipe function first try and clean the card reader mechanism by using a fresh card machine cleaner (an enwrapped card coated with a special cleaning agent) to clean the swipe mechanism at the till. if the device swipe mechanism is still not reading a card, swap the credit card machine with a known working one. – importantly to note whilst carrying out this procedure is that you take note of which ports each card machine is plugged into as the devices are fixed to these ports. you will need to restart the till once the known working card machine is plugged into the till. credit card: verifone ocius setup – cardholder copy receipts not printing correctly problem when taking card payments at a terminal with verifone ocius software installed, two customer receipts are printed. one that includes the items purchased with hashed out debit/credit card details and another with a message stating “unable to retrieve data”. fix basically, during the verifone installation, the program.settings.ccf file which was configured to be located in the local merac installation folder. this file was not copied to this location following the installation. instead the file was located in the root (c:\\) which the user has no access to and the pos till program is now looking in the local merac folder. move this file to c:\\program files (x86)\\merac. credit cards: integrated card machines payment cancel issue for merac ver 3.15, if you attempt to cancel an integrated card payment for a booking from the till, the transaction will be cancelled from the pdq but merac still registers the transaction but payments table is not updated with detail of the transaction which would indicate that the transaction was paid for successfully – which is what we would expect but the transaction details are still updated within the booking which makes it look like the booking was paid for. fix 1)add button to pos till - command – “disable integrated cc’ 2)recall booking from till and then refund the booking. 3)turn on integrated card payments again by reconfiguring the button using – command “enable integrated cc”. 4)advise the customer to attempt to take the customer not present payment again. problem with the above is that merac now thinks that no payment was taken for the booking because if you follow steps 2) and 3) at the same amount, they balance each other out which in effect means nothing was paid towards the booking as far as merac is concerning even though by pressing the command buttons below we know that ther customer has charged the card correctly. to fix this you would need to delete all offending transactions from the database! credit cards: corrupted log files causing issues taking card payments corrupt log files causing issues with taking card payments but this would need to be verified by yespay/worldpay. steps taken to un-corrupt/refresh yespay log files: 1. close easy v terminal application if running. 2. go to c:\\yeseft\\conf 3. rename yesefttransactionlog.xml file as backupyesefttransactionlog.xml. 4. make a copy of yesefttransactionlog-empty.xml file and rename as yesefttransactionlog.xml. 5 rename yesefttransactionlog-tmp.xml file as backupyesefttransactionlog-tmp.xml 6. make a copy of yesefttransactionlog-empty.xml file and rename as yesefttransactionlog-tmp.xml. 7. initialize easy v terminal twice then try to perform a transaction and share the result. 8. send us the backup copy of transaction log so we can check if there is any pending transaction to upload. hha error – there is some missing data for the membership when scanning an hha membership card from the pos terminal, if the below error appears. verify that mandatory information is included in the setup in the hha member details. in the below example, system options does not have any mandatory data required per membership setup… meracdata share drive mapping error using unc path membership card missing data error at pos till meracupdater customer notification message – meracupdater not working on a merac client sent from bluemail on 11 may 2017, at 03:20, customer notification > wrote: 11 may 2017 03:20:40 2017/05/11 03:20:40 - error in clssqlfunctions:getscalarvalue - desc:a transport-level error has occurred when receiving results from the server. (provider: tcp provider, error: 0 - the specified network name is no longer available.) sql:select isnull(upcforceupdatenextcheck,0) as upcforceupdatenextcheck from updateclient where upccomputername=@computername date 11 may 2017 03:20:40 customer name nottingham castle computer name ncm-notts-p2 ip address 192.168.1.231 appname meracupdater appmeracconnstrname server=81.174.163.111,14339;database=mstore;uid=applogin;pwd=vb6 fix select * from updateclient to workout what till it is. remotely connect and clear event viewer logs from windows and then replace meracupdater. till: unable to launch the pos till program when trying to run the till program, receive pmstore txread error. =================================================================== date and time: 24 may 2017 14:37:34 operator: error source: pmstore form/object: cdrawer sub/function: tillxread =================================================================== ----------------------------------------------------- error 91 -------------------------------------------------------- object variable or with block variable not set =================================================================== troubleshooting open up a new cashdraw and zread. compare the three files created on the new cashdraw with the cashdraw transaction files experiencing the issue to identify what the cause of the issue is. it would normally be something in the opening record that is causing the issue. may want to check if the userid used to open the cashdraw which appears in the opening record of the transaction file exists in the tills local meracdat.txt file emp line. workaround if the user account id does not exist, readme the id in the opening record to our merac id ‘100’.",
    "category": "INTERNAL Support Articles",
    "folder": "2017 Support Documents",
    "created_at": "2023-06-20T17:13:07+01:00",
    "updated_at": "2023-12-22T09:38:43+00:00",
    "status": 2,
    "tags": []
  }
]