[
  {
    "id": 103000334873,
    "title": "MARS key server data bijladen in artikellijst",
    "text": "beschrijving en handleiding mars calculatie variabelen bij gebruik van csv bestanden uit rve voor extra artikelvelden. let op: in deze handleiding is er vanuit gegaan dat de com server al is ingericht. de definities van de com server staan in het bestand com _svrs.ini in de map \\mars\\qlc voorbeeld: [comserver4] comservername=keysvr commachinename= comexternalname=keysvr.keyserv cominitparameter=c:\\filename.csv functioncount=7 fnc1name=initcomserver fnc1return=0 .. .. fnc7param4type=10 fnc7param5name=k4 fnc7param5type=10 fnc7param6name=k5 fnc7param6type=10 zie hiervoor ook de handleiding van mars ten behoeve van het “bijladen” van extra artikelvelden in mars vindt er elke nacht 4:00 uur een export plaats van de stamgegevens van de artikelkaart in drie bestanden. à sortering artikelnummer rve en à sortering artikelnummer fabrikant deze worden middels twee makro functies in rve uitgevoerd. (88 en 98) tevens vindt er een export plaats van de interfiliaaldata van elk artikel van een heel jaar. selectie alleen filiaal 99. deze export vindt plaatst door middel van een mrt opdracht in mars waaruit een csv bestand wordt gegenereerd. à sortering artikelnummer fabrikant alle drie bestanden worden geplaatst in de map: u:\\ mars opbouw van deze bestanden: de velden staan op één regel gescheiden door een puntkomma. en veldnaam ($ = alfanumeriek) veldinhoud artikel.csv artikel2.csv leeg artikelnummer rve of artikelnummer fabrikant $omschrijving artikelomschrijving $matchcode artikelmatchcode $kenmerk1 artikelkenmerk 1 $kenmerk2 artikelkenmerk 2 $kenmerk3 artikelkenmerk 3 $tekst1 extra artikeltekst 1ste regel $kleurnr eigen kleur nummer $kleur eigen artikelkleur $seizoen artikelseizoenskenmerk $fabrikant fabrikantnummer $fabrikantkleur fabrikant kleur $fabrikantartikelnummer artikelnummer van de fabrikant $laatstevkdatum artikel verkoopdatum (laatste) $laatstegodatum artikel goederenontvangst datum (laatste) $leverdatum; leverdatum laatste bestelling inkoopprijs artikelinkoopprijs (netto) verkoopprijs artikelverkoopprijs aktieprijs artikel aktie verkoopprijs vkak1prijs artikel speciale prijs1 avk1 vkak2prijs artikel speciale prijs2 avk2 voorbeeld artikel.csv: 122000032;linnen,jukstuk,bordu;e12;;70 %;;80817; 240;olijf;71; 42;240;714420;14.07.2009;10.04.2007;dd.mm.jjjj; 3,15; 14,95; 4,00; 0,00; 0,00; 122000033;9\"linnen,opgest.zakk;d32;;70 %;;80890; 240;olijf;71; 228;240;60045;20.06.2009;12.04.2007;dd.mm.jjjj; 3,25; 9,95; 3,00; 0,00; 0,00; 122000034;4.5\"fine twill br lu;r32;;70 %;;80901; 240;olijf;71; 228;240;60151;14.07.2009;14.04.2007;dd.mm.jjjj; 3,85; 10,95; 3,00; 0,00; 0,00; voorbeeld artikel2.csv: 0110243;poplin aop dessin,;f13;persival;;;z50265; 255;granny;01; 135;granny01;322000142;03.03.2010;14.01.2010;15.12.2009; 1,98; 12,95; 12,95; 0,00; 0,00; 0110244;poplin, bulky zakken;d55;;;;z50268; 602;donker grijs;01; 135;dolphin01;322000144;02.03.2010;22.01.2010;15.12.2009; 4,55; 13,95; 13,95; 0,00; 0,00; 0110244;poplin, bulky zakken;c55;;;;z50268; 470;fuchsia;01; 135;fuchsia01;322000145;03.03.2010;22.01.2010;15.12.2009; 4,55; 13,95; 13,95; 0,00; 0,00; veldnaam (“ “ = alfanumeriek) veldinhoud “artikel nummer fabrikant\" artikelnummer van fabrikant \"artikel nummer fabrikant-naam\" leeg \"boekingsdatum\" leeg \"$boekingsdatumnaam\" dag en datum van if boeking \"iftot_aant\" totaal aantal interfiliaal voorbeeld artikel3.csv \"0111211\";;;\"mo: 01-02-2010\";-270 \"0111212\";;;\"fr: 12-02-2010\";-272 \"0111213\";;;\"mo: 25-01-2010\";-308 \"0111214\";;;\"mo: 04-01-2010\";-314 toepassen van de extra variabelen door middel van een calculatie is het mogelijk de velden in het csv bestand in een mars lijst te verwerken. belangrijk is te bepalen of de sortering op eigen artikelnummer of fabrikant-artikelnummer is ingesteld. afhankelijk daarvan dient de juiste sleutel (key) te worden gekozen welke gekoppeld zijn aan het bestand artikel?.csv (? = 1 of 2) instelling in mars: sortering in mars artikelnummer à artikel.csv à keyserv_13 sortering in mars artikelnummer fabrikant à artikel2.csv à keyserv_14 à artikel3.csv à keyserv_15 (alleen if_datum) calculatievariabelen in het tabblad design is het mogelijk om ‘calculatievelden’ toe te voegen. middels dergelijke velden kunnen berekeningen, welke niet als standaard variabele zijn opgenomen, worden toegevoegd. het is niet mogelijk om op calculatievariabelen te sorteren. ook voor het toepassen van de extra velden uit de csv bestanden dient een calculatieveld te worden aangemaakt. omdat de waarden als het ware als sleutelwaardes zijn vastgelegd. de meeste calculatievelden voor de artikelvelden zijn al aangemaakt en kunnen op de normale wijze worden gekozen. nieuw item toevoegen wanneer in het tabblad design op lege cel met de rechtermuis wordt geklikt, kan gekozen worden voor de functie calculatie. het volgende scherm verschijnt vervolgens. of r-muisknop op de groep waaraan het item moet worden toegevoegd. kies daarna toevoegen veld (ctrl-i) voordeel dat hier meteen de juiste groep wordt ingevuld. vul een logische postnaam in. bijv. artkenmerk1 klik in het vak calculatie typ een = teken indien het een alfanumerieke variabele betreft typ dan een $ bij een numerieke variabele, geen $ teken klik op het tabblad functies en kies de juiste keysvr. zie hierboven. vanwege de opbouw van de layout en sortering moet gekozen worden voor keysvr_?.getdatabykey1 in dit geval is de sortering fabrikant artikel dus is gekozen voor keysvr_14.getdatabykey1 tussen de haakjes moet nu de verwijzing worden ingevuld de omschrijving van de variabele tussen enkele aanhalingstekens plaatsen. zie beschrijving van de kolomteksten. (inclusief $ teken indien nodig) =$keysvr_14.getdatabykey1('$kenmerk1',key.artikel nummer fabrikant) !! belangrijk is dat de exacte koptekst van de csv kolom in de formule wordt opgenomen. typ een komma gevolgd door het woord key en een punt =$keysvr_14.getdatabykey1('$kenmerk1',key.artikel nummer fabrikant) daarna volgt de tekst van het niveau waarop gesorteerd wordt. =$keysvr_14.getdatabykey1('$kenmerk1',key.artikel nummer fabrikant) !! belangrijk is dat de exacte tekst van de sortering in de formule wordt opgenomen. druk op ok",
    "category": "RVE - RFA - POSFLOW etc.  Customer Help",
    "folder": "MARS",
    "created_at": "2025-02-11T14:29:46+00:00",
    "updated_at": "2025-02-11T14:31:34+00:00",
    "status": 2,
    "tags": []
  }
]