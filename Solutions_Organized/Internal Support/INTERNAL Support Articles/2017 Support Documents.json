[
  {
    "id": 103000134227,
    "title": "2017 Notes on MStore Trouble Shooting",
    "text": "Table of Contents POS Till POS Till: Error when launching POS Till program from shortcut on Desktop for Training Till 999 POS Till: Till Data Load Error – ‘Critical Error: Failed to load till data‘ POS Till: Till taking a long time to load – Stuck on ‘Loading Till Data’ message POS Till: Unable to Recreate Till Data POS Till: Old Data File Notification Message received when a Till is turned on POS Till: Till Transactions stuck in Holding Table POS Till: Till Transactions – Holding Table PDBUpdater Error Message POS Till: Unable to Open Till/CashDraw POS Till: Unable to ZRead a Till POS Till: Unable to Clear Data on Till following Merac Server going offline POS Till: ExecuteNonQuery: Error converting data type float to decimal POS Till: Two of the same Till Numbers are open using the same Draw Number Fix POS Till: Till X, Cash Draw Y appending multiple Open entries in TXNS file POS Till: ‘Insert Header Till_Draw Subquery returned more than 1 value’ error POS Till: Open Cash Draw not appearing from POS Till POS Till: Startup Error – ‘Error Accessing Line Display’ POS Till: Customer Line Display (CLD) not working POS Till: Description Incorrect for Items Sold at the Till POS Till: Wrong Payment made for a Booking POS Till: Over Payment Showing in Booking when using Payment Method Voucher POS Till: Error ‘SellCurrentItem - Object variable or With block variable not set’ POS Till: MStore Program Error- CApp ‘Object variable or With Block variable not set’ POS Till: PLU Sell Item error - “Object variable or with block variable not set” POS Till: CDraw/XRead program error - “Object variable or with block variable not set” POS Till: Physical Cash Draw not Opening POS Till: Customer Search (‘Find Member’ command button from Till) not returning results on Till POS Till: Till ‘Reprint Receipt/Reprint Journal/Till Roll’ showing blank receipt details POS Till: Receipt Blank on Till POS Till: Till Transactions Missing in DTA POS Till: Printing and Barcode Scanning – Error occurred in calling the CheckHealth method POS Till: Barcode Scanner not scanning a barcode POS Till: Scanning Barcodes – ‘Item not found’ error POS Till: Casio Barcode Handheld Scanner error – ‘Item not found’ POS Till: Honeywell PDA Handheld stuck on ‘Setting up device. Please wait…’ whilst not connected to the dock POS Till: Logitech USB Camera Freezing Intermittently POS Till: Cash Draw opening when cancelling a Transaction POS Till: Till not prompting to take a Photo of Existing Member when Membership Card Swiped POS Till: MStoreUpdater or MeracUpdater not updating Merac system files POS Till: Receiving error that unable to access Photo folder for Memberships POS Till: More than one Voucher not Printing at Till Bookings Bookings: Booking Error – Invalid use of NULL error Bookings: Error Re-Calling Bookings from Till – “Item cannot be found in the collection corresponding to the requested name or ordinal” Bookings: Error Saving Bookings from Back Office – “Item cannot be found in the collection corresponding to the requested name or ordinal” Booking: Taking Booking Deposits from the POS Till Bookings: Deposit added to wrong Booking Bookings: Booking Confirmation Letters not opening Bookings: Online Booking Payment Issue - Payment Setup Correctly in Back Office but not at the Till Bookings: Booking Confirmation Letter Empty following Internet Booking Detail Change Bookings: Block Bookings not showing in the Diary Bookings: Price Different when recalling a Booking to the POS Till Sessions Sessions: Sessions and Bookings – Unable to Delete Session/Tours Sessions: Seat Number Not Visible when Creating Sessionable Bookings Sessions: Session Type not displaying correct Availability Moving a Session from one time slot to another from Back Office error Footfall Footfall: Recorded on the wrong Date for a given Till Promotions Promotions: Save error – SavePromItems:’Violation of PRIMARY KEY constraint' Printing Printing: Ticket printer fails to print Printing: BOCA Ticket Printer printing blank tickets Printing: Barcode Labels not printing Printing: Barcodes Printing Issue - Epson TM-L90 appending a ‘0’ to the beginning of an EAN13 barcode Printing: Unable to print to a Network Printer Printing: Unable to print Receipts from Tills screen in Back Office. ‘Invalid use of NULL’ error Printing: Failed to claim OPOS Receipt Printer Printing: Permissions error when trying to print a Purchase Order Accounts/Customers & Memberships Accounts|Customers|Memberships: Unable to Void New Member entered through Till Accounts|Customers|Memberships: GiftAid Signature outside of MinMax Date Range Accounts|Customers|Memberships: Unable to add new Contacts to a Customer Account Reports Reports: Error – Failed to retrieve data from the database Reports: Error – ‘FRepParams / ExportData error’ Reports: Error – ‘One or more fields could not be found in the result set. Use verify database to update the report’ Reports: Update Reports Reports: Crystal Reports .rpt File Not Found error Reports: Export Error - ODBC driver does not support the requested properties Reports: Unable to run any Reports - Returning SQL error – FRepParams/InvokeRepParams Reports: Reports taking a long time to load and display Reports: Very slow when running any Reports Reports: Back Office crash following running a report for version 3.14 Reports: Data Extract error or Report error – Subscript out of range Reports: Seating Plan Report returning an error Reports: Determining Discrepancy with FootFall Analysis Report and Actual Footfall Reports: Promotions report – duplicate Promotion Descriptive Names Reports: Export button greyed out on the Parameters window Reports: Report not importing correctly Data Extracts Data Extract: Mailing Extract Error – The object invoked has disconnected from its client GiftAid GiftAid: Claim Submission Failing GiftAid Claim Submissions Error - Unable to submit GiftAid Claims GiftAid Write Submission Error GiftAid: Declarations Report hanging GiftAid: ‘Divisible by zero’ SQL Statement function error GiftAid: PLU View/Add Price showing GiftAidable Claimable Amount not equal to 10% as System Options defines GiftAid: Fix Taxing on GiftAidable items GiftAid – GiftAid Conversion report not matching entries in the GiftAid Claim Submissions list Back Office Back Office: Unable to run ‘Recreate Till Data’ - receive error: Unable to connect to MeracUpdater service Back Office: Merac Back Office Installation Troubleshooting Back Office: Login Update Notification Message Back Office: Merac Back Office software Out-Of-Date Error Back Office: Computer not able to communicate with the Merac Server Back Office: Trying to adjust a PLU sell value returns message to specify a Price Matrix Back Office: Selling of Session Tickets not displaying correct Num QTY in Back Office Back Office: Files not Updating when MeracUpdater runs Back Office: Creating a new Lookup Item “Violation of PRIMARY KEY constraint” Error Back Office: Stock Entry Duplicate Primary Key error Back Office: Unable to Move Stock from ‘Unknown Stock Location’ to known Stock Location Back Office: Moving Stock from deleted Stock Location to known undeleted Stock Location Back Office: Forecasts Information not updated correctly for Footfall Back Office: Mailing Export/MailMerge to MS Excel/Word error Back Office: Error when attempting to Clone an existing Receipt or Ticket Design Debit/Credit Cards Credit Cards: Card Machines Down Credit Card: Unable to take Card Payments – Till Offline Credit Card: YesPay Error – “Transaction Failed: Declined offline. Please take alternative payment” Credit Card: Unable to read Debit/Credit cards when swiped through the Till PDQ Card Reader Credit Card: Chip&PIN not working Credit Card: YesPay/WorldPay – CashBacks not working Credit Card: YesPay - Card Refunds using EasyVTerminal version 3445 Credit Card: YesPay - Card Payment failure as a result of Till going Offline Credit Card: Polling Query following moving from ACK to YesPay Credit Cards: Ocius Sentinel – ‘Check for Pinpad’ message from Ocius Sentinel window Credit Cards: Ocius Sentinel not detecting Device on COM Port Credit Card: Verifone Ocius Setup – Cardholder Copy Receipts not printing correctly Credit Cards: YesPay – EasyVTerminal Startup Issues Credit Cards: YesPay error ‘Invalid Key Index’ Credit Card: ACK – Problems Processing Card Payments from Till Credit Card: ACK PDQ Credit Card Payments Failing – No ACK Receipt Printing Credit Card: ACK CashBack not working Credit Card: Processing Card Payments from the Till – Card Payment Screen fails to load Credit Card: YesPay – YesEFT Configuration tampered Credit Card: YesPay – YesEFTInterface error: Unable to load EFT Datasets Credit Card : YesPay – YesEFTInterface or StartPOSServer: Port currently owned by sts.xxxx.STSEMVTerminal.x Credit Cards: Yespay error ‘STSSerialPortException: javax.comm.NoSuchPortException.1’ Credit Card: YesPay – Payment Authorization failure message Credit Card: Credit Card Machine CHIP&PIN Working but not Swipe function Credit Cards: Integrated Card Machines Payment Cancel Issue Credit Cards: Corrupted Log Files causing issues taking card payments POS Till POS Till: Error when launching POS Till program from shortcut on Desktop for Training Till 999 If you try and launch a training Till (i.e. 999) from a Merac Back Office computer or POS Till and receive the below error message… Solution You can only launch the training Till from Back Office by clicking on POS \\\\\\Formats icon in the top toolbar. POS Till: Till Data Load Error – ‘Critical Error : Failed to load till data’ Problem When attempting to load Till 999, the screen prompt to change the resolution is displayed and when you click OK the window disappears and the Till fails to load. When you attempt to load any other Till on the network following making Back Office changes, you receive the following error and the Tills fail to load… Check the contents of the MeracDat.txt file on any Till reporting the error (e.g. check for any inconsistency in LKU records within the file by matching them with contents of Lookups table in SQL etc.) and then check all LKU records to see if there is an inconsistency in the data. If you find an LKU line entry that contains an error, FIX IT. Recreate Till Data and Update all Tills. This should fix the issues experienced loading Till Data. OR Problem When loading the POS Till program, if you receive the below error, this could mean that the MeracDat.txt file could be corrupted or the Till does not exist in Back Office>>Till Configuration… Fix Rename the original MeracDat.txt file stored locally and then re-run the POS Till program. This process with pull down a fresh copy of the MeracDat.txt file from the server. OR Check that the actual Till exists that you are attempting to open from Till Configuration. POS Till: Till taking a long time to load – Stuck on ‘Loading Till Data’ message If the computer/Till is part of a WORKGROUP environment and the server is part of a domain environment, this is likely the reason for the Till program not loading. The problem is aimed specifically at a domain authentication issue. You will find that browsing to the \\\\\\MeracData share does not work as credentials are required to connect to the share. Solution Open the command prompt and navigate to C:\\Program Files (x86)\\Merac or C:\\Program Files\\Merac and run the following command:- mstoreupdater –password Enter the MeracData network share UNC path, Username and Password and then click Update to MStore.ini button This process will append an encrypted HASHKEY to the end of the ini file used to authenticate when the client attempts to connect to the server which is part of a domain. This is required when the Till is part of a Workgroup and the Merac server is part of a domain. When you launch the POS Till and the Till detects the server online, it tries to query the server MeracData share to verify contents of the MeracData/Formats folder files using these credentials saved as an encrypted key. If the Till fails to receive a response, this results in the Till program failing to load. Note! Any changes to the Merac Back Office system through Edit Config will cause this encrypted password appended to the end of the MStore.ini file to be removed. Solution First check that the Till has enough memory Then check that the MeracDat.txt file has an ‘End-Of-File’ marker appended to the end of the file to make sure it is not corrupt. Make sure you can browse to the MeracData share using the UNC path \\\\\\MeracData\\ If you cannot, then re-create the encrypted key in the ini file. Run MstoreUpdater.exe to rebuild the MeracDat.txt file and then try re-launch the POS Till. Note! The usual issue causing this would be the fact that the customer has a lot of Stock items that the POS Till is loading from the meracdat.txt file which is why it is taking a lot of time to load. Would advise the customer to delete out old Stock Items no longer in use. POS Till: Unable to Recreate Till Data Problem Receive SQL ‘RecreateTillData’ statement error when attempting to Recreate Till Data from a Merac Back Office computer or POS Till. When you make changes on a Merac Back Office computer or POS Till and then attempt to Recreate Till Data from that device, the system attempt to write the changes immediately to its local MeracDat.txt file which is why you do not need to run Update to allow that device to pick up any changes made. For this to work correctly, ‘Full Access permission’ is required to the local Merac installation folder. It then copies the changes to the server MeracData share MeracDat.txt file which will allow all other Tills to pick up any changes made following running an Update. For the changes to be copied to the server copy MeracDat.txt file, full access to the server is required. If an authentication prompt is received when trying to browse to the server MeracData share, this is the reason why Recreate Till Data is returning an error. Solution Check permissions to local Merac installation folder. If the Till is part of a Workgroup and the server a domain, it is likely that if you browse to the server MeracData share using the UNC path, you will be prompted to enter in a Username and Password to authenticate. For BO 3.14, if the Till is added to a WORKGROUP, navigate to C:\\Program Files (x86)\\Merac or C:\\Program Files\\Merac and open command prompt as admin and run mstoreupdater.exe /password. Then enter the domain credentials to authenticate and connect to the server as seen below and then click Update to MStore.ini button… OR This process will append an encrypted hash key to the end of the ini file used to authenticate when the client attempts to connect to the server which is part of a domain. This is required when the Till is part of a Workgroup and the Merac server is part of a domain. Copy PMStore.exe, PMBOS.exe and MStoreUpdater.exe from the server to the local Merac installation directory and run MStoreUpdater.exe. If BO 3.14 or 3.15 and Till is added to the domain, browse to the server using the UNC path and if asked to enter authentication details, insert these and ensure you tick the box the remember credentials. Now try Recreate Till Data again and it should work. POS Till: Old Data File Notification Message received when a Till is turned on When we started up a Till, if the Till operator receives a pop up saying “The data file is over ‘x’ days old, you may still use it but please inform a supervisor”, this is normal. The Till purposely notifies you if the age of the Till’s data file (MeracDat.txt) is older than x days. Specifically it does this as an alert in case the Till isn’t updating from the network correctly. To get rid of this notification message, simply get the customer to Recreate Till Data and then from the ‘Three-Button/Four-Button’ program, press the Update button so that the next time the POS Till is opened, the message will no longer be displayed. This notification refers to its local copy MeracDat.txt file version. It is likely that the server copy is also out-of-date, so to fix the issue, from Back Office>>Recreate Till Data to over-write the server copy MeracDat.txt file (for version 3.14) with its local copy which will allocate the clients local copy timestamp to the server copy. Press the Update button on all Tills ensure that all Tills pick up any new changes. POS Till: Till Transactions stuck in Holding Table Troubleshooting Log onto the Merac server and check that PDBUpdater service is running. If it is and there are no errors in the Holding Table, then examine the “Connection String” in the below file and ensure the details are correct… POS Till: Till Transactions – Holding Error: TXH-Cash Drawer X on Till Y is not opened Problem Transactions stuck in the Holding Table. PDBUpdater error message – Cash Draw ‘X’ on Till ‘Y’ is not opened. e.g. error - PDBupdater-2,999,16,TristemLtd,FailedCash Drawer 999 on Till 2 is not opened ‘ttnStatus’ displays details on whether an error occurred or not with any transactions posted to the server to be processed. Any error reported would prevent all other transactions from being processed and uploaded to SQL. Ideally if all is ok, the Holding Table should be empty provided no other transactions are being sent by Tills to the Merac server. ‘ttnErrorMessage’ displays details about the error. Cause The error is caused when the Till is closed for that Cash Draw from Back Office and the Till has not been Zread (i.e. the CashDraw has either been F2ed OR In this situation the Cash Draw has not been closed locally using ZRead and so if the Till operator logs back into the Till, he/she will still be able to take transactions from the Till with the given Draw number. To get around this you could create an opening record in the Holding Table, clear out all Holding Table error messages and once all transactions have been successfully uploaded to the server, ‘F2’ the Till and then archive the local transaction files without ZReading the Till. Because the Till has been closed from the Back Office side, the CashDraw table marks the Till/CashDraw as closed and so transactions will get stuck in the Holding Table and are unable to flow through to be processed. (closing the Till from the Back Office sets the Till and CashDraw in the CashDraw table with a status of ‘C’ which means any pending transactions sitting in the Holding Table will not be processed). Press ‘F2’ Solution To fix this, search for the server opening transaction number from Back Office\\Tills and then locate the opening transaction number within the CashDraw table and then set the csdStatus value = ‘O’ (MUST BE A CAPITAL ‘O’ ELSE THIS BREAKS IT!), csdClosed At = ‘ ’ and csdClosedBy ‘ ’ for the given server transaction. The status of the Till and CashDraw will reappear as open Then clear the ttnErrorMesssage and ttnStatus within TillTXNs table and commit changes. Open SQL Server Management Studio and enter the following sequence of commands:- select * from TillTXNS select * from CashDraw begin transaction update CashDraw set csdStatus = 'O' , csdClosedAt ='' , csdClosedBy ='' where csdOpenTXNNo = 58 commit begin transaction update TillTXNs set ttnErrorMessage ='' , ttnStatus ='' commit Now the transactions that were stuck in the holding table will be processed. Finally log back into the Till and ZRead it. Then perform a CashUp if necessary BUT the ZRead must be done! Note! When you set the Cash Draw as open in the CashDraw table, the ‘csdClosedAt’ value for the give Till/CashDraw record will have a status of ‘1900-01-01 00:00 00:000’. This means the Till has been opened so there is no valid timestamp entry as seen in the below example… POS Till: Unable to Open Till/CashDraw Log onto the Till and check that there is no transaction files for this Till and Cash Draw sitting in C:\\Programs. Files\\Merac\\TXNFiles. If there are, move them into the History folder. Once they have been moved to the History folder, they are archived and you can then open the Till/CashDraw and start trading. POS Till: Unable to ZRead a Till The issue could be 1)security permission related or the 2)Formats folder may have not updated on the Till correctly to allow the Till operator to login with authorized credentials to ZRead the Till or 3)the Till Last TX No does not equal the Last Updated TX No. 1) If the below appears, the Till operator does not have the required permission to ZRead the Till… 2) If the above panel display a grey box with a button if the form highlighted below has not been copied to the Till located in C:\\Program Files (x86)\\Merac\\Formats\\MSTORESTD\\ 3) Summary:- Open the Till in question and check the Last TX No against the Last Updated TX No Verify whether the transactions have been uploaded to the server from SQL. Check TXN file content Amend NEWTXNS and UPDTXNS Re-open Till and check that the server receives the transactions Cause This usually happens if the Last TX No processed locally on the Till is lower or higher than the Last Update TX No (which is the last transaction number that has been successfully sent to the SQL server. Transactions are marked locally as being backed up by the files being moved to the History folder. The Till then knows that all transactions have been posted). If Last TX No is lower than Last Update TX No, this would possibly happen if the Till’s NEWTXNS file has become corrupted or unreadable by the Till program and so the Till cannot read the file to determine the last transaction number it processed so randomly chooses a transaction number. Logically the Till would reset to transaction count to a ‘0’ value which means the next transaction number to be processed by the Till would be ear tagged as Last TX No = 1. Note! A ZRead or the Till drawer won’t open or close unless Last TX No = Last Update TX No. From the below exhibit, you can see that UPDTXNS has a Type value of ‘001 Archive’ which means it is whichever Till you are on and Cash Drawer 1. As soon as you add items to the basket and then press SubTotal button and process a payment (whether by Cash or Credit/Debit Card), the Last TX No and Last Updated TX No should increment by one automatically. Opening UPDTXNS (time stamped 29/08/2014 @ 12:25), you can see that the last transaction number sent to the server is 13743 which ties up with the Till. Opening NEWTXNS (time stamped 29/08/2014 @ 12:25), you can see the last Till transaction processed by the Till. This again ties up with the Last Updated TX No. This is good because we now know that all transactions processed on the Till have been successfully posted to the SQL Server. To verify that the transactions have been uploaded to the database, open the Tills screen from Back Office and view the transactions – preferably the 2nd and last transaction number. Scenario1 If Last TX No is higher than Last Update TX No, this usually happens when the Till is perhaps offline or the server is offline or inaccessible so the Till is unable to send it’s transactions to the server to be processed. In both situations, this would prevent a ZRead or for the Till drawer from opening or closing. Solution Make sure the Till and SQL Server are both online and then try add random items or No Sale items to the basket and VOID ALL and the Till should then reconnect to the database server. Once the Till Last TX No = Last Update TX No, a ZRead can then be carried out or the Cash Draw can then be opened or closed. Scenario2 Now if the Last TX No on the Till is lower than the Last Updated TX No (A>B), the server is likely to have a later copy of transactions sent from the Till which will prevent the Till Drawer from opening or closing. This normally occurs when the Till attempts to read its NEWTXNS file to determine the last transaction number processed by the Till so it knows where to start from which would be . If the Till program/software is behaving strangely or perhaps the Till was shut down without carrying out a ZRead at the end of a previous trading day, the Till may therefore not be able to read the contents of NEWTXNS, so will randomly generate a new transaction number starting from ‘1’. Solution Open SQL Management Studio and connect to the database and run the below SQL query to determine the last transaction number uploaded onto the server: select * from txnheader where txhTillno=1 and txhtype not in (’O’,’C’) --[O = Open, C = Closed] order by txhTilltxnno desc Copy the Till’s local transaction log file (e.g. TNX001 seen in above example) to the Merac Support computer and run TXNFileParser app to re-edit the local transaction log file contents so that it starts from the transaction number following the last transaction number uploaded onto the server. Save the new transaction log file, rename the old transaction log file on the Till in case we need to revert back to it for some reason and then copy over the new transaction log file onto the Till. Amend the Tills UPDTXNS file to include the value of the first transaction number in the list (from the new transaction log file) -1. [this value should match the last transaction number processed/uploaded onto the server as we determined earlier] Amend the Tills NEWTXNS file to include the value of the last transaction number in the list (from the new transaction log file). Log back into the POS Till program and provided the Till has a network connection, all remaining transactions that have not yet been processed by the server sitting in the new transaction log file will then be processed and once Last TX No = Last Update TX No, a ZRead can then be carried out or the Cash Draw can then be opened or closed. Note! VOID transactions and NO SALE transactions are also regarded as transactions. POS Till: Unable to Clear Data on Till following Merac Server going offline Normally caused by server being changed or going offline. Problem When carrying out a ZRead to close a Till, you will receive the following error message if the Merac server momentarily went offline… If you log back into the Till program you will notice that Last TX No ! = Last Updated TX No. Solution Connect to the Till and then connect to the Merac Server and run ipconfig to get the Merac server IP Address. Check that the Till C:\\Program Files\\Merac\\MStore.ini and ensure that the Server Path is correctly set to ServerPath=\\\\\\MeracData\\ Update the etc\\hosts file to point to the correct Merac server IP Address if there is no DNS server on the subnet from where the Till is installed for name resolution. Log back into the POS Till program and process a VOID ALL transaction which should kick start the Till and force it to re-establish a connection to the Merac server and transaction data should automatically start updating again. Carry out a ZRead on all other Tills. Note! When a Till goes offline, a message will be displayed at the bottom in Red/White saying ‘Server Offline at xx:xx’. It will then create a file called ‘netstatus.txt’ (a text file) in C:\\Program Files\\Merac directory on the Till. To get the Till back online, delete this file to fix the issue or add items to the basket and the ‘VOID ALL’ to force a reconnection to the server. You could also click on the ‘Offline’ message at the bottom of the Till screen and select ‘Re-try again’ to force re-connectivity. If you attempt to ZRead the Till and receive a ZRead failure message stating that ‘Not all transactions have been uploaded to the server’, check that PServerUpdater is running in the background for ver 3.14 and disable UAC. If running ver 3.15, restart MeracUpdater service. POS Till: ExecuteNonQuery: Error converting data type float to decimal Below SQL Holding Table Transaction error received… ErrorMessage: TXD-//i:ExecuteNonQuery:Failed to save transaction detail record for TXNNo 89425 on Till 220 (Error converting data type float to decimal.) TXD line = TXD,1,220,220,89425,1774,1,All in One Child,All in One Day Child,S,1,-53222197.74,-53222197.74,222222220,53222221.69,0,0,0,0,0,0,0,0,23.95,V,0,0,0,1,S,-8870366.28,0,,0,0,,0,17,0,0,1796,0,,,,,0,0,0,,0,0,,,0,,0,,,,,,,0,25 Oct 2015 15:24,0000,0,0,,0,0,0,0,0,0,0,0,0,9 TXNLine in Holding Table: TXD,1,220,220,89425,1774,1,All in One Child,All in One Day Child,S,1,-53222197.74,-53222197.74,222222220,53222221.69,0,0,0,0,0,0,0,0,23.95,V,0,0,0,1,S,-8870366.28,0,,0,0,,0,17,0,0,1796,0,,,,,0,0,0,,0,0,,,0,,0,,,,,,,0,25 Oct 2015 15:24,0000,0,0,,0,0,0,0,0,0,0,0,0,9 Cause and Fix This issue is normally caused by scanning a barcode for example at the POS Till into the ‘Price’ field accidentally and then SQL fails to convert the data being scanned to the correct numeric format. You can see that the above transaction line was VOIDED so you could just delete the line from the Holding Table to fix the issue. POS Till: Two of the same Till Numbers are open using the same Draw Number Fix If two of the same Till Number are opened using the same Draw Number, run the following commands to determine the Till’s open transaction number (i.e. Server allocated Transaction Number) which is greatest. This would be the one that was opened most recently (2nd of the two). select * from CashDraw where csdTillNo = X and csdDrawNo = Y and csdStatus = 'O' OR Open Tills from Back Office and determine if there are more than one instance of a particular Till and Cash Draw open and if so, view the most recently opened Till/Draw instance transactions to determine its opening server transaction number. Then use this info. to delete it’s records from the following tables – txnHeader,txnDetail,Payments,TXNTax,CashDraw and CashUp and then if there are any errors in the Holding Table, clear these. This will allow all pending transactions to then be processed. Note! The above solution would only stand if the 2nd instance Till/Draw opened has not processed any transactions else they will get stuck in the Holding Table. POS Till: Till X, Cash Draw Y appending multiple Open entries in TXNS file Cause When the Till is ZRead, the operator turns off the Till during the process, the Till would not get a chance to archive the TXNS file into the History folder but the CashDraw is successfully closed hence why the Till when opened again, appends another Open entry to the file. Fix Archive all transaction files UPDTXNS, NEWTXNS and TXNS files to History folder and get the operator to log back onto the Till. The Till will say failed to get Last Transaction Number. Would you like to obtain the Last Transaction Number from Server. Click Yes. The Tills first transaction number will now be the Servers Last Transaction Number. POS Till: ‘Insert Header Till_Draw Subquery returned more than 1 value’ error TXH-Insert Header Error. Till = 2Draw = 2Till TXN = 17352 (Subquery returned more than 1 value. This is not permitted when the subquery follows =, !=, , >= or when the subquery is used as an expression). Reason There is more than one of the same Cash Draw open for the same Till. Cause Usually caused by either a ZRead of the Till not successfully completing - most often caused by a 1)poor network connection, 2)turning off the Till in the process of completing a ZRead, 3)unplugging a mobile Till UFD from a computer whilst Merac System is in the process of completing a ZRead or 4)PDBUpdater (3.14) or MeracPDB (3.15) failing to mark the Till and Cash Draw as closed following a ZRead (less likely to happen!) and then the next trading day, the Till operator being unaware that the Till/CashDraw has been closed off successfully, opens the same Till/CashDraw and processes transactions from the Till. The transaction then gets stuck in the Holding Table. How to replicate the scenario:- Stop PDBUpdater or MeracPDB service on the server ZRead the Till – the local transaction files will in affect be archived. Locate the currently open Till/CashDraw in TillTXNs and delete the CLO (Closing record) for the given Till Re-Start PDBUpdater or MeracPDB service on the server Re-open the the same CashDrawNo. on the same Till (Now two open records will appear in Back Office for same Till/CashDraw) As soon as you start sending transactions to the server, PDBUpdater will not like this and send PDBUpdate Notification error messages to the server and stop processing any transaction sitting in the table until the error is cleared. Solution Close the most recently opened duplicate Till/CashDraw from Back Office and clear error messages displayed in ttnStatus and ttnErrorMessage within the Holding Table to allow any transactions from the previous Till/CashDraw to flow through the Holding Table and into the database. begin transaction update TillTXNs set ttnStatus = '' , ttnErrorMessage = '' where ttnStatus = 'Failed' commit Key highlighted factors to consider before closing the most recent Till/CashDraw that was opened… 1 2 3 1)In the above, the timestamp must be dated other than todays date. This would indicate that the transactions stuck in the Holding Table are still pending to be processed from the originally opened Till/CashDraw. 2)In the above, the last transaction without an error against it must have a timestamp other than todays date. 3)In the above, a closing record at the end of the list of transactions for the originally opened Till/CashDraw would mean that once the 2nd mentioned of the two Till/CashDraw is F2’ed, transactions will flow through following clearing error messages and will close. To confirm this, check Back Office Tills screen or open the CashDraw table and ensure the Till/CashDraw is closed – it should be, given that there is a closing record tag at the end of the first open Till’s transaction file (i.e. there is a closing record sitting in the Holding Table), else the Till will remain open and should be marked as open in the CashDraw table if busy trading. If it is determined that the Till/CashDraw is not trading, you may need to close the Till and Cash Draw manually. You can check if the Till/CashDraw number is marked as closed in the database by searching CashDraw table based on csdOpenTXNNumber which in this case would be ‘20231’… If there are transactions pending to be processed for the 2nd mentioned Till/CashDraw sitting in the Holding Table, you will need to re-open the Till/CashDraw from the CashDraw table by searching its opening record line. POS Till: Open Cash Draw not appearing from POS Till In a situation that a Till has been trading for the day and then there is for example a power cut and the Till shuts down unexpectedly, when the Till restarts and you attempt to login to the Till, there is no Cash Draw visible to allow the till operator to login to the Till. The reason for this is because either NEWTXNS or UPDTXNS file contents are incorrect or blank. When Windows experiences an unexpected shutdown and is readying from a file, the file or its contents may get corrupted. Fix Rebuild the NewTXNS file date stamped for the day which should appear blank (i.e. Windows would blank the contents as a result of the unexpected shutdown – copy my own NEWTXNS or UPDTXNS contents as a template). Open the local transactions file and get the last transaction processed by the Till. Copy an existing NewTXNS file and past it into the NewTXNS file date stamped for the day and edit the contents to include the last transaction number noted earlier and the Draw/TillNumber and save. If there was an issue with the UPDTXNS file, insert a transaction number prior to the first transaction number executed by the Till and save. Note! In later versions of Merac software (3.15 or higher), MeracPDB is a service that runs on the server only which moves transactions sitting in the Holding Table to the database and is clever enough to know that even if you set UPDTXNS transaction number to a number already sent to the server, will not re-upload the same transaction number to the database causing duplicate transactions but instead will only send/upload those that have not yet been processed. Like PServerUpdater used by 3.14 to send transactions to the server from the Till, MeracUpdater service does the same for 3.15. Try re-opening up the Till and CashDraw and log back into the POS Till and everything should be OK. Confirm this by adding random items to the basket and Void All or restart MeracUpdater service on the Till to allow the Last Update TX No to catch up with the Last TX No. Done! POS Till: Startup Error – ‘Error Accessing Line Display’ System displaying OPOS error when starting up Till: “Failed to claim OPOS Line Display\". The Customer Line Display (CLD) unit only shows the ‘CompanyName’ and nothing else. CLD is USB attached but uses a built-in USB-to-COM port converter, which is a piece of software used to convert the USB attached CLD to be detected by Device Manager as a COM port. Troubleshooting Checked in OPOS utility that the hardware settings for the CLD is set to COM7 HandShake should be set to ‘None’. Try plugging the CLD into another USB port and scan for hardware changes and reboot the Till and test. Swapped CLDs with a known working one – If it starts working then the device is damaged. POS Till: Customer Line Display (CLD) not working First few things to check: Open Devices Manager and make sure the COM7 is enabled. Reinstall the Front Line Display Software. Installing Aures Sango Customer Line Display If there are issues with the USB-to-COM port drivers, try reinstall these – run the driver installer first and then the Configuration utility to detect the device on the COM port… Once the driver is installed, run the setup from the D:\\Sango_C95Drivers\\Graphic Cust Disp\\Configuration v1.1.9\\ Click Scan Device button Click Auto Scan button The correct COM port will be detected for the Front Line Display which is COM7… Click Change Settings Change the Command Type to 1-ESC/POS and then click the Set to Device button… Complete! Make sure the Handshake is set to ‘DISABLED’. If not then you will have to amend this manually by navigating to the following location C:\\Program Files\\OPOS\\Epson2\\ and open the following file for editing - LdDMD101 Run an ‘Interactive Health Check’ from Epson SetupPOS Ver2.00 utility for the Line Display and then check that the Line Display is showing text on the LCD screen. If the Front Line Display is showing any dollar symbols then the device is incorrectly configured. POS Till: Description Incorrect for Items Sold at the Till Problem Scanned Item Description Name on Till incorrect for a Sell Item Solution Found that the PLU associated to the barcode (e.g. 5029306666104) when searching the PLU based on the Code “5029306666104” had the wrong Description of \"DW Fluffy Owl\" whereas the Stock Item with that same Code had a Description of \"DW Cone Snow\". Have advised that a correction would need to be made to the PLU to match the correct Description Name. A recreate Till data would also be required to update the changes to all Tills. POS Till: Wrong Payment made for a Booking Amending Payments made to a Booking through SQL can be done but ultimately it is encouraged for the customer to carry out the amendment through the Till by recalling the booking and carrying out a refund. In some circumstances, even though the correct payment shows in the Payment History window in Back Office and also reflected in BKGHeader and BKGDetail for the particular booking number, you may still be required to reverse the payment through SQL. Note! ‘txnNo’ column in Payment History would be the server transaction number. Solution Open SQL Server Management Studio and enter the following sequence of commands:- select * from TXNHeader where txhNo = select * from TXNDetail where txnNo = /* Note! txnOrderNo is the actual Booking Ref. No*/ select * from Payments where payTxnNo = select * from TXNTax where txtNo = begin transaction delete from TXNHeader where txhNo = delete from TXNDetail where txnNo = delete from Payments where payTxnNo = delete from TXNTax where txtNo = commit POS Till: Over Payment Showing in Booking when using Payment Method Voucher When a customer has over-paid for a booking i.e. in the below booking you can see that a £50 voucher was used to pay for a booking with a Total Amount Due of £45 in the Merac BO System… As a result, when you run Transactional Analysis by Nominal Code report, you will notice that the very top gives you details of the amount paid in (which includes Vouchers, Cash or Card). The customer presented the cashier with a £50 voucher which was entered into the POS system as Paid So Far amount of £50 instead of £45 which is the actual amount due. This is an actual payment of £5 over. That is why when you look at the report, you see £118.50 which is the total amount paid. Based upon the actual PLU Sell Price of each item purchased using a combination of payment method Credit Card and Voucher, the actual true transaction total amount should be £113.50. The item sold using the Voucher was worth £45 as seen encircled in red. That leaves an over payment of £5 which you can see clearly at the very bottom of the report encircled in blue… POS Till: Error ‘SellCurrentItem - Object variable or With block variable not set’ Problem If you attempt to scan an item or enter the item code into the Code field on the POS Till, an error ‘SellCurrentItem - Object variable or With block variable not set’ is returned as seen below… Discontinued - Stock items that you still want to sell but no longer want to re-order Deleted - Stock items you no longer want to sell A Discontinued or Deleted PLU item means you cannot sell the item. If a Stock item has been deleted and discontinued, search for the item by selecting the Deleted and Discontinued checkbox (it’s will be displayed as a 'strikethrough entry' (i.e. meaning the Stock item is Deleted) and highlighted in Pink (i.e. meaning the Stock item is Discontinued). If a Stock item has been discontinued, it can still be sold until all remaining Stock has been depleted but the system will not be reordered through Supplier. To search for the item, select the ‘Discontinued’ checkbox (highlighted in Pink (i.e. Discontinued)) If a Stock item has been deleted, it can no longer be sold. To search for the item, select the Deleted checkbox ('strikethrough entry' (i.e. Deleted)) Note! To find a Stock item that has been both Deleted and Discontinued you will have to select both Deleted and Discontinued checkboxes. If a PLU (Non-Stocked item) has been discontinued, you will no longer be able to sell that item. You will receive the following series of error messages because when an item is sold, the routine would first check the contents of the MeracDat.txt file to determine if the item exists and if it does the status of the PLU being sold (i.e. Active, Discontinued or Deleted) and then whether or not the PLU is linked to a promotion. Because the item exists in the MeracDat file but has been discontinued, the below error messages will be displayed… POS Till: MStore Program Error- CApp ‘Object variable or With Block variable not set’ Problem When clicking on the Bookings button to recall bookings from the Till, receive MStore Program Error “Object variable or With Block variable not set”. Troubleshooting If the customer connects to multiple databases (e.g. Longleat or NMRN or Paignton Zoo [Paignton Zoo have two site databases i.e. Paignton Zoo and Living Coast]). If this is the case, the first thing to check would be the MeracDat.txt file. It is likely that someone may have logged into Back Office Living Coast database from the Paignton Zoo network and carried out some changes followed by a Recreate Till Data which would have overwritten the Paignton Zoo server MeracDat.txt file with the Living Coast version so when other Tills from Paignton turn on and run an update, their local MeracDat.txt file contents will be incorrect and you may receive the above ‘Object variable or With block variable not set’ error either when the POS Till program starts up or if the till operator attempts to recall a booking or sell an item. Example:- The MStore.ini file is pointing to the actual Paignton Zoo site Merac Server DataPath as seen encircled above hence if a user attempts to log onto a different remote site database (i.e. Living Coast) from Back Office and runs Recreate Till Data. The process will over-write its centrally stored MeracDat.txt file in the MeracData share and an update run on each Till will pick up the wrong configuration settings. Fix Advise the customer at Paignton Zoo to Recreate Till Data by connecting to the Paignton Zoo database from Back Office and for all Till operators to update their Tills. POS Till: PLU Sell Item error - “Object variable or with block variable not set” Problem When trying to sell a PLU from the Till, receive error “Object variable or with block variable not set”. Fix Try run Till Update Try process a transaction selling a particular item and then check if that item price is in the MeracDat.txt file on the Till – Search for the PLU item to determine the PLUID and then search “PRI,” and search for the price entry for the given PLUID. If it is there, then most likely the PLU has either been marked for deletion or has been discontinued. If it is not there then most likely the SQL database is Locked (i.e. the Prices table or an associated table may be locked) Log onto the server and then restart both Merac PDBUpdater and SQL Service. Get the Till operator to run an Update on all Tills and this should fix the issue. If you now examine the MeracDat.txt file, there should be a PLUID and PRI item in the file that matches that which is in the database or in Back Office. Note! SQL could also be locked by running a “begin transaction” query and not committing changes. POS Till: CDraw/XRead program error - “Object variable or with block variable not set” When doing anything on the till i.e. pressing a button or logging out or logging on to the POS Till. Fix ZRead the Till and then archive the contents of the TXNFiles folder. POS Till: Physical Cash Draw not Opening When making a payment from the POS Till, the Cash Draw is not opening. Receive the following error message: Physical Cash Draw is plugged into the Receipt Printer and Back Office Till Configuration Receipt/Slip Printer and Cash Drawer 1 are defined identical (e.g. TSP643D). If Epson OPOS shows the OPOS Printer and Cash Drawer as greyed out, this means that their settings are defined somewhere else. In this case, they are defined within another piece of software (e.g. StarMicronics)… Troubleshooting Check that the PCI Express COM Ports installed are visible in Device Manager under Ports (COM & LPT). You can manually change the port number but these would also need to be changed from within the OPOS software to match. Print a Configuration slip from the Receipt Printer and make sure you set the Baud Rate within the OPOS software to match. If there are still issues with the Physical Cash Draw or Receipt Printer not being detected following running A Health Check, the Receipt Printer could be faulty or if the Receipt Printer is working but not the Physical Cash Drawer not, the Cash Draw could be faulty. POS Till: Customer Search (‘Find Member’ command button from Till) not returning results on Till When searching for a Customer to Invoice from a Till and the search feature does not find any information, check that the “Source” field has a value in it… POS Till: Till ‘Reprint Receipt/Reprint Journal/Till Roll’ showing blank receipt details Solution Close the POS Till and then from Back Office>>open Till Configuration and then click Alter Default Till Document button and then ensure that a Receipt design is selected (checkbox checked) and click Apply. Now open the till again and then try and view transactions processed through the till through the Reprint Receipt|Reprint Journal or Till Roll and process the refund again. POS Till: Receipt Blank on Till First ensure that any printer is set as default from Devices and Printers. Then ensure that for the particular Till in question, a receipt printer is defined (e.g. WINRECEIPT for Windows printing) in Back Office>>Till Configuration. You may need to also click Alt Default Till Documents button and dirty the records checked and save the changes then go back in and revert them back to how they were>>Recreate Till Data and Update Tills and then instruct the till operator to try re-printing the receipt. POS Till: Till Transactions Missing in DTA Problem If the Merac database server goes down and a Till as a result is missing certain transactions when running DTA, do the following… Solution Remote onto the Till and open explorer and navigate to ‘C:\\Program Files (x86)\\Merac\\TxnFiles\\History’ or ‘C:\\Program Files \\Merac\\TxnFiles\\History’ or ‘C:\\ProgramData\\Merac\\TxnFiles\\History’. Copy the transaction file to the Merac Server. Remote onto the Merac Server and make sure the server has the an updated version of PDBUpdater. Open Merac Back Office and then click Setup and click Edit menu to manually upload contents of the transaction file to the Merac Server. Now browse to the saved transaction file, select it and then click Upload button Click Yes at the next window followed by OK. Note! For both 3.14 and 3.15, PDBUpdater is clever enough to know that any transactions that exist in the transaction file that have already been uploaded to the server would be ignored so that no duplicates would be present. Done! POS Till: Printing and Barcode Scanning – Error occurred in calling the CheckHealth method When testing Printers and Scanners (connected via serial COM port) and carrying out Health Checks through the OPOS system, only one application can claim the device at a time. Therefore, best practice is to close the POS Till software and then run a Health Check else an error message will be returned. HEALTHCHECK ERROR: General Hardware Problems that may result in this error also being produced: Mis-configuration Faulty Cable Faulty COM Port Faulty Device POS Till: Barcode Scanner not scanning a barcode Download iPhone App (Code Read R) and then insert the barcode having the problem scanning and it will return the symbology of the barcode. Configure the device using that symbology and then print the scansheet to re-program the scanner and then if you then attempt to scan the barcode, it should work. OR If the symbology is enabled on the barcode scanner and the device is attached via USB, open Back Office>>Till Configuration and then set the Barcode Reader setting to ‘None’ (since it is attached via USB). The device will appear in Devices and Printers as seen in below exhibit… If the scanner outputs a barcode following a scan with no space at the beginning, then the barcode scanner is not programmed correctly. Send the customer the barcode scanner scan sheet to re-programme the device and then try scan again. This should fix the issue! If you scan an item and the barcode appears in the Code field on the Till and then disappears with no Merac ‘Item not Found’ notification message being displayed, this means that System Options>>Stock tab>>PLU to use for 'Item Not Found' option is not defined - hence why the Item Not Found window is not appearing allowing the Till operator to add the PLU manually. POS Till: Scanning Barcodes – ‘Item not found’ error Problem POS Till returning “Item not Found” error when an item barcode is scanned using the barcode scanner. Note! This problem only occurs when scanning certain Stock items. The fact that a response is being returned means that there is nothing wrong with the barcode. It there was, then when you scan a barcode, nothing will happen! If there is no response when scanning the barcode, get the customer to send us a photo of the Stock item barcode and we can try and test scan the barcode from here. If the item is scanning correctly, the issue is with the scanner. Check Stock Item Print Barcode Configuration if no response from POS Till when scanning barcodes. The symbology could be setup incorrectly when the barcode labels are printed or the barcode used could be incompatible with any symbology that would render the barcode scanable by the barcode scanning device. Troubleshooting Check configuration of Barcode Scanner and Barcode Printer: 1)Configure and test the barcode scanner. If the device is attached using serial COM port, ensure that it is configured correctly in OPOS. You could also re-program the scanner from here as well. 2)Check Merac MStore BO System>>Till Configuration>>if a serial COM port attached barcode scanner, set the “BarCode Reader” field to the name Make/Model of device (e.g. Eclipse/Voyager/Orbit) ensuring that the name showing in OPOS is identical to the name in the Merac MStore BO System. Note! If a USB barcode scanner, no need to specify any config. Settings in Merac MStore BO System as the scanner will be picked up automatically and will be available immediately through PnP. 3)Get the customer to print a Scan Sheet for the appropriate device (if attached via USB i.e. not configured through OPOS Metrologic Administrator) and get them to scan every barcode and PQ code in order from top to bottom to re-calibrate the scanner. 4)Test that the item StockCode is picked up from the Till by entering the code into the “Code” field Format: Note! Any items with codes that do not start with a character are recognised by the Till as Sell Items and any items that start with a character are recognised by the Till as barcodes). When a barcode is scanned and the Till responds to the item being scanned (i.e. even if an error is returned such as “Item Not Found”) means that the barcode is a valid barcode. With the correct item being added to the basket once the item is scanned would provide confirmation that the barcode is linked correctly to the item being sold. POS Till: Casio Barcode Handheld Scanner error – ‘Item not found’ Problem When trying to scan barcodes (11 digit barcodes), receive error that item not found but scanning the item from the Till works fine. Fix Enable \"Output Check Digit\" which is the last digit of an UPC-A symbology barcode. This will perform a checksum on the 11-digit barcode to verify that the barcode is correct. The ‘Output Check Digit’ for any barcode is first digit to the far right. For EAN13, this would be the 13th digit. For UPC-A, this would be the 12th digit. How to Enable “Output Check Digit” Run Image Scanner Read utility from Programs menu… Click on ‘Image Scan Read’ utility from taskbar and then click Settings… Click Options tab and then change UPCA to include “Output Check Digit”… Close the ‘IMGSet’ window and then click on the Image Scan Read icon in taskbar again and click Close POS Till: Honeywell PDA Handheld stuck on ‘Setting up device. Please wait…’ whilst not connected to the dock What should follow is a screen that asks you to update the date/time Troubleshooting Steps:- Plug the device into the USB dock and then browse the device to check that the correct private IP/Port number details are entered into the Mobileini.txt file. Also check that the MobileDat.txt file has data in it. If not, then delete the MobileDat.txt file and then unplug the device from the dock and reboot the device. If it still does not get past the point of setting up the device, plug the device into the dock and cold boot the device to eliminate WiFi and see if this resolves the issue. If the device can initialize whilst connected to the dock using the initial settings wizard but not when unplugged from the dock, then the WiFi network could be flaky. (see ‘Stock Take using PDA Handheld.doc’ for more details) POS Till: Logitech USB Camera Freezing Intermittently Problem Camera freezing intermittently. Cause and Troubleshooting If there are any 3rd-party software programs or Microsoft processes claiming the device, the camera may tend to freeze up. The camera is plugged in via USB and uses either standard Windows Plug and Play drivers or device-specific drivers (e.g. Logitech). Check that there is sufficient hard disk space and that they do not use Memberships through Back Office at the same time for example, because if trying to access the camera from the Till as well, there would be more than one program trying to claim the device and the camera image will either not be displayed or would freeze up. If this is not the case, run an on-demand virus scan and shut down the computer on a daily basis to free up resources and try swap USB ports to eliminate such problems from happening in the future. This issue is not caused by the Merac software at all and there are no user/administrator-defined settings in Back Office that are used to allow integration with the camera. POS Till: Cash Draw opening when cancelling a Transaction Aures POSligne devices (i.e. ODP100/200/333) are connected via serial and configured through their dedicated POS software and print faster than devices that may be attached via USB (i.e. this is because Windows attached receipt printers print more quality receipts in comparison to being serially attached). If an Cash Draw is plugged into a Aures POSligne printer connected via serial COM port and configured through their dedicated OPOS software. Both Printer and Cash Draw need to be defined in the software. When setup this way, the receipt printer will print receipts as and when needed and the Cash Draw will only open as and when needed. Reason If the Aures POSLigne printer is connected via USB, it can be setup through EpsonOPOS but needs to use TM-T88III drivers else it will not work. If the Cash Draw is plugged into the printer setup in this way, each and every time a transaction occurs even when the transaction is cancelled, the system will attempt to print a void receipt and the Cash Draw will open. Note! Aures POSligne printers can only be setup as serial and USB printers within Aures OPOS software whereas Epson products can be setup as USB and serial through Epson OPOS software. Note! For Windows attached receipt printers (e.g. Aures POSligne) which requires you to install the specific Windows print drivers from the vendors website, you can configure receipt printer as either a serial or USB printer (to be named as 'WINRECEIPT') and by so doing, the Cash Draw - if plugged into the receipt printer - will open each and every time a receipt is printed (i.e. whether a void/no sale or sale receipt is printed). Any paper that passes the printer will open the Cash Draw! Fix Plug the Cash Draw into the dedicated Cash Draw port at the back of the Till and configure the Till to use FTCD via Back Office/Till Configuration. Then Recreate Till Data and test. POS Till: Till not prompting to take a Photo of Existing Member when Membership Card Swiped Solution Make Sure that the Membership Type in Back Office is setup with a mandatory option for ‘Photo’. Note that you cannot test swiping a Membership Card from training Till 999 to record membership entry. In other words, when swiping a membership card that does not have a photo setup, even though the above ‘Photo’ option is selected, the training Till will not prompt to take a photo if the photo is missing. As you can see from the Till Configuration window below in Back Office, this functionality only works for live Tills… POS Till: MStoreUpdater or MeracUpdater not updating Merac system files In some circumstances, MStoreUpdater or MeracUpdater fails to update Merac system files (e.g. Formats folder missing on the local machine). Fix Log onto the Merac computer with the problem and then navigate to C:\\Program Files (x86)\\Merac\\updatenewver\\auth OR C:\\Program Files\\Merac\\updatenewver\\auth and delete PErrTrap.dll. Then re-run MStoreUpdater or re-start MeracUpdater. POS Till: Till receiving error that unable to access Photo folder for Memberships Fix Close POS Till program Inserted file:// into Trusted sites in Internet Explorer and restarted POS Till program and log back in and tested Should work now! POS Till: More than one Voucher not Printing at Till If a customer has “Group Ticket Toggle” option enabled in System Options, if the till operator attempts to purchase more than one of the same Admissions voucher, the till will only print out one voucher as opposed to two or more depending on how much were purchased. Fix Find the PLU and then update the ticket design to include “unique ticket barcode” (PrintLayoutLine table pllMergeField value = ‘txnUniqueBarcode’) and then save the changes. Also make sure that Unique Tickets checkbox is selected for the PLU and Number per Ticket value set to ‘1’ and then Recreate Till Data and Update the tills. Bookings Bookings: Booking Error – Invalid use of NULL error When attempting to open a booking, receive a PMBOS “Invalid use of Null” error. This is normally caused by either a booking created whereby afterwards, the PLU is deleted or the Bookable Resource Date and Time availability has not been defined correctly… Fix To identify if this is the case, from the ‘BKGDetail’ table, search for the booking RefNo. and if both ‘bkdResource’ and ‘bkdBCDId’ is set to ‘0’, delete this record from the database. If you then try to recall the booking from Back Office, you should be able to open the booking. The customer would need to review any Bookable Resources or PLUs added to the booking to determine their validity to prevent this error from re-occurring. Similarly, if you try to re-call a booking from the Till and receive the following error message – “PMStore Object variable or with Block variable not set: SellCurrentItem”… Fix Make sure that all Bookable Resources tied to the booking you are trying to re-call have PLU items that are not discontinued. If so, re-enable them and then Recreate Till Data and run an Update on all Tills. Other SQL Error Messages:- Index Out of Bound This usually occurs if no drop-down selection was chosen for the given window when setting up a booking. Invalid use of NULL An invalid use of NULL value being inserted into the booking Bookings: Error Re-Calling Bookings from Till – “Item cannot be found in the collection corresponding to the requested name or ordinal” Troubleshooting If this is happening for all bookings – test by opening up training Till 999 from server and try search any random bookings. Also check if you can open up the associated booking returning an error on the Till from Back Office. Note! Below fix only applies to BO 3.14. If BO 3.15, the forms are held in the database so speak with Dave! Fix If this is happening for all Bookings and opening up the booking from Back Office, everything is fine, then replace the Formats\\ FinfoForm.frm and FinfoForm.frx files with known working versions (i.e. perhaps from another customer whereby the Bookings window from the Till screen is similar – “Check with Dave on the appropriate customer to copy from!”) Copy the two files to the Tills local C:\\Program Files (x86)\\Merac\\Formats\\STDXVGA folder renaming the old files and re-launch the Till and test. If it works, then copy the two files to the servers MeracData share within Formats\\STDXVGA and then add any text to MeracData\\Formats\\Updates.txt file so that when you click on Update on the Tills, they will detect a change/modification made to the text file and re-copy all contents of the server version Formats folder to their local Formats folder… Bookings: Error Saving Bookings from Back Office – “Item cannot be found in the collection corresponding to the requested name or ordinal” Check that linked PLUs are not deleted and the date validity information is correct. Turn on SQL database tracing (get Nik to do this) and then carry out the activity again to obtain trace related information Run select * from dbo.trace on SQL Server to determine what data is being passed back to the MC_SaveBooking Stored Procedure. If the data being passed back to the stored procedure does not include certain field items that the Back Office Stored Procedure (MC_SaveBooking accessed in right-hand pane in Microsoft Visual Basic) is looking for, then the error would be presented. Booking: Taking Booking Deposits from The POS Till Problem ‘Paid so Far’ amount in Bookings window showing differently to payment information in the Payment History window. Detail that is sourced from the Payments table Detail is sourced from txnDetail table Detail is sourced from Payments table Confirmation of the amount charged against the Credit Card (Note! You would need to confirm what the Till receipt says and not take the above Payments table section details as gospel)… Details of TXN File: PAY,1,2,1,40354,3,20,0,,,************8437,,01 Mar 2018,,0,20,0,False,003153,62659413,16,,YESPAY,465946,,0,0,GBP,20,1 TAX,1,40354,1,E,40,0,0 Explanation In future when taking a Deposit for Booking, do not adjust the quantity from its default value of ‘1’ to another value other than this (in this case you changed it to ‘2’) because the POS Till program always expects a quantity of ‘1’ when taking a Deposit so when the payment was taken, it only took £20.00 instead of what you wanted it to charge (2 x £20.00). This is why the Paid so far showed £40.00 which reflects the details you entered into the till at the time of taking the deposit and the Payment History window only charged £20.00. Bookings: Deposit added to wrong Booking Requirements Change a deposit made for a booking from one booking to another - deposit of £20 needs to be moved from booking ref. 1544 to booking ref. 1558 Before… Before… Solution Because there is only one transaction linked to the original booking, simply rename the booking reference number for the given transaction to the correct booking reference number. Open SQL Server Management Studio and enter the following sequence of commands:- --select * from bkgHeader --inner join bkgDetail on bkdRef = bkhref select * from bkgHeader inner join TXNDetail on txnOrderNo = bkhRef where bkhRef = 1544 select * from TXNHeader inner join TXNDetail on txnNo = txhno where txnOrderNo = 1544 begin transaction update TXNDetail set txnOrderNo = 1558, txnShortDesc = 'DEPOSIT Bk 1558', txnLongDesc = 'DEPOSIT Bk 1558' where txnOrderNo = 1554 commit After… After… If you then click on Payment History for the booking 1558, you can see below that because the transaction was simple moved from booking 1544 to 1558, the attributes for the transaction have been retained (e.g. Date/Time that Credit Card Payment was made, Method of payment, Till No. from where the payment was made etc. which is useful for reporting purposes, etc.)… Bookings: Booking Confirmation Letters not opening Example:- Company: Bristol Zoo ‘\\\\10.0.0.159\\Meracdata\\Reports\\Group Bookings’ Solution Open MS Word and change security settings: Trust Center>>Trusted Locations – Add ‘local\\Program Files (x86)\\Merac’ and ‘\\\\\\MeracData’ as trusted sources Allow docs on network to be trusted Enable Macros Disable Data Prevention Mode and Data Execution Prevention Uncheck all options circled below… Also when clicking on the Email Conf button to open a Booking Confirmation letter, if you receive ‘cmdEmail_click’ program error when clicking on this button, as seen below… Troubleshooting Problem was identified to be caused by the email application (MS Outlook) not allowing a connections to the Merac Back Office app. Bookings: Online Booking Payment Issue - Payment Setup Correctly in Back Office but not at the Till Description If full payment was taken (and the Booking is in the future, the status will be changed to ‘Booked’) and then part of it refunded for a particular booking and then later the customer decides to amend the booking back to how it was (e.g. from 2 x 2 table - 1 x 2 table - 2 x 2 table) and despite booking when referenced from Back Office displaying the correct amount due, the Till is still showing that Full payment has already been taken even though was refunded previously to result in an amount still outstanding for payment. Fix Recall booking from Till Press on the Deposits button When asked to take a Deposit select 'Yes' and then when asked would you like to Refund the deposit say 'No' The items with the correct amount should display in the basket Press the Sessions button if sessions are involved SubTotal>>select Payment Method That should fix the issue. Bookings: Booking Confirmation Letter Empty following Internet Booking Detail Change Question What does an Internet Booking not have that a normal Booking does have?? The ’BookedBy’ attribute encircled below is because the booking was made by the customer and not the employee… This means that the ‘BookedBy’ field will be blank in the Employee table in SQL. When you attempt to make changes to the Booking from Back Office and try re-sent the letter from the Diary, you may find the email attached pdf Booking Confirmation letter contents is blank. Fix Modify the Stored Procedure dbo.MC_BKCONF as seen below to prevent it INNER JOINING BKGHeader and Employee table on ‘BookedBy’ record data. Modify the procedure to LEFT JOIN Employee table to BKGHeader table in which case all records in left table (BKGHeader) will be returned even though there is no match on the right table (Employee). In this case, the procedure will still run and return results importing the data into the letter… Bookings: Block Bookings not showing in the Diary If Block Bookings (i.e. classed as Internet Bookings) is enabled as seen below, then ‘bkhIsInternet’ records will be set to NULL for each booking in ‘BKGHeader’ table which means that if you try and search for a booking in the Diary you will not find anything if you check either the ‘Bookings’ or ‘Show Internet Bookings’ radio button… To fix this issue you will have to set all ‘bkhIsInternet’ records linked to an Internet Booking from NULL to ‘1’. Permissions for Block Booking… Bookings: Price Different when recalling a Booking to the POS Till If a booking has been created in Back Office and then you recall the booking to the POS Till, if the price is different, it is likely either an Everyone promotion is causing the price change or an Account Promotion or Membership Promotion or the admission that was purchased (e.g. at the beginning of the year), price is different to the price now due to the fact the admission ticket is seasonal (i.e. the price changes from season-to-season). Fix Simply log into Merac Back Office and open System Settings – uncheck the box “Recalculate Internet Price” from the Accounting tab. Recreated Till Data and Update all tills. Sessions Sessions: Sessions and Bookings – Unable to Delete Session/Tours Problem If you open up Add/Edit Sessions/Tours within Back Office and attempt to delete session/tours assigned to a particular SessionType and receive the below error of “Please remove the individuals before cancelling”… Fix Open SQL and run the below series of commands to find the session related information and delete the offending entries. Then recreate the Sessions/Tours from Back Office Add/Edit Sessions/Tours… Sessions: Seat Number Not Visible when Creating Sessionable Bookings If a Session has been defined to implement a Seating Plan, when creating a booking from Back Office, the Choose Seats button will only be visible after creating – saving and re-opening the booking. Steps:- Creating a Sessionable Booking from Back Office. Select a valid date that the session/tour is available from the Diary and then click New button. Select the appropriate Booking Type from drop-down. Select the appropriate Source from drop-down. Click ‘Tour/Sess’ radio button and then select the appropriate Session Type and Session/Tour Time Slot. Then double-click on the Session/Tour Time Slot to view the sessional PLUs associated to the Session Type and then highlight the PLU from the bottom PLU section and click Add… Click Find Customer or New Customer button to add a customer to the booking and then click Save Bkg button… Exit the booking and then go back into the booking. The Choose Seats button is now available to allocate seats to the booking… Sessions: Session Type not displaying correct Availability If items are sold on the internet and the Booking Template does not have the Style set to 'Session/Tours', then even though you allow selling of sessions over the internet they will not record availability correctly. To check what items have been manually booked - open Add/Edit Session Tours and then open the calendar date for which the Session Type has been defined and click Make Booking button. A list of all manually entered books will be displayed. If Internet Bookings are not showing up in the Session Detail report, make sure that the Booking Template to allow selling sessions on the internet has the Style set to 'Session/Tours'. Moving a Session from one time slot to another from Back Office error When changing the time for an existing Session for a Booking, returns error below after saving changes: ---------------------------------------------------- ADO Error ---------------------------------------------------- SQL Error Number: 23000: [Microsoft][ODBC SQL Server Driver][SQL Server]Cannot insert the value NULL into column 'sesSeq', table 'MStore.dbo.SessionBkgs'; column does not allow nulls. UPDATE fails. Provider-specific Error Code: 515 ---------------------------------------------------- ADO Error ---------------------------------------------------- SQL Error Number: 01000: [Microsoft][ODBC SQL Server Driver][SQL Server]The statement has been terminated. Provider-specific Error Code: 3621 SQL Statement: exec MC_SaveBooking 'U', 31, 1, 14354, 2, 'Rock', '', 0, 1, 11, 0, '30 Nov 2014 16:15:00', '30 Nov 2014 16:30:00', '', '', '', 0, 'Mrs', 'Katherine', 'RH10 3PH', 'kapmert22@aol.com', 1, 1, 'B', 1, 31721, 'Roc31721 ', 'Rock', 1, '3 Oriel Close', '', '', '', 'Crawley', '', '07824530989', 'SAGEPAY-OK', '30 Dec 1899 10:30', '', '01 Jan 1900', 0, 0, 106, 41, '18 Nov 2014',8042,2,11494,1,0,'','',0,0,0,11 ************ Solution Have manually added the required Sessions and then deleted the old ones and saved and this worked fine. Footfall Footfall: Recorded on the wrong Date for a given Till Moving Footfall figures from one date to another for a given transaction Scenario Till 2 opened at 14:48pm on Sunday the 14th recording 159 Children and 230 Adults and closed at 00:05am on Monday 15th. (this Footfall was supposed to be recorded for Sunday the 14th figures - Receipt No. 2/149471) Problem Till 2 had mistakenly recorded the above transaction on Monday instead of Sunday. Now Footfall on Sunday and Monday are showing incorrectly. Requirements Move the Footfall for this given transaction from Monday to Sunday processed by the given Till. Solution Log onto the Merac MStore BO System and then open the Tills screen and filter back to the respective dates for each Till in question. Then verify that these transactions actually occurred by double-clicking each Till and then select File>>View Transactions>>click Next button to step through each of the transactions. Easier method would be to run the Transaction Audit report to determine if the transaction was actually recorded. Open SQL Server Management Studio and enter the following sequence of commands:- select * from TXNHeader where txhTillNo = 2 and txhCompleted between '15 Sep 2014 00:00' and '15 Sep 2014 23:59' --the above date of the 15 Sep 2014 would be Monday’s date --two server transactions will be returned – Items added (‘X’ Children and ‘Y’ Adults) to basket and Till CashUp --the items added to the basket has recorded a server transaction number of 534125 /*below query is used to verify the footfall amount recorded against the server transaction number 534125 used to sell both the ‘Children’ and ‘Adults’ admission tickets which are set to record footfall*/ select * from Footfall where ftfTXNNo in (534125) --below query is used just to verify the open transaction number within the CashDraw table select * from CashDraw where csdOpenTXNNo = 534124 begin transaction update TXNHeader set txhStarted = DATEADD(d,-1,txhstarted), txhCompleted = DATEADD (d,-1,txhcompleted) where txhTillNo = 2 and txhCompleted between '15 Sep 2014' and '15 Sep 2014 23:59' commit begin transaction update Footfall set ftfDateTime = DATEADD(d,-1,ftfdatetime) where ftfTXNNo = 534125 commit Note! Only PLU’s with Footfall set (i.e. pluFootfall = ‘1’ in the ‘PriceLookups’ table) will be recorded in the ‘Footfall’ table. --find the Open Transaction Number for the given Till from Tills screen in Back Office begin transaction update CashDraw set csdClosedAt = DATEADD(d,-1,csdClosedAt) where csdOpenTXNNo = commit Promotions Promotions: Promotion Save error – SavePromItems:’Violation of PRIMARY KEY constraint' Error details: SavePromItems:’Violation of PRIMARY KEY constraint 'PK_PromDetail'. Cannot insert duplicate key in object 'dbo.PromDetail'’. Promotions are applied on either an Analysis Code Level or on a PLU Record Number Level (PLURecNo). If you attempt to setup a promotion against an item that has already been setup from the sub AnalysisCode level, and then try and apply the promotion at the top-level AnalysisCode, SQL will attempt to save the promotion on a PLURecNo level as well which will result in the below SQL Statement error… =================================================================== Date and Time: 30 Jun 2015 12:06:34 Operator: MJS Error Source: PMBOS Form/Object: FPromDetails Sub/Function: SavePromItems =================================================================== ----------------------------------------------------- Error -2147217900 ----------------------------------------------- Violation of PRIMARY KEY constraint 'PK_PromDetail'. Cannot insert duplicate key in object 'dbo.PromDetail'. =================================================================== SQL Statement: INSERT INTO PromDetail (proBranch, proRecNo, proAnzCode, proPLURecNo, proPercentage, proReduceBy, proNettPrice, proMBDeal, proBuynn, proGetnn) values (1, 4, '', 2699, 25, 0, 0, 0, 0, 0) Solution Search for PLURecNo linked to the promotion record number (proRecNo) and delete it from the table. select * from PromDetail where proRecNo=4 and proPLURecNo=2699 delete from PromDetail where proRecNo=4 and proPLURecNo=2699 Printing Printing: Ticket printer fails to print Problem Ticket printer not responding when trying to print tickets when Admission Tickets are sold from the Till. Solution First few things to check: Ticket printer is powered on. Cables are attached securely on both ends and the data cable is plugged into the correct port/socket at the back of the Till. The ticket roll is inserted into the printer correctly. If not, the print queue name may be named differently to the name set in the Merac BO System configuration. BOCA Ticket Printers Usually for a BOCA Ticket printer, the name configured in the Merac BO system is BOCA, so renaming the print queue to ‘BOCA’ would fix the issue. BOCA Ticket printers are USB attached so install themselves through Windows PnP. Once installed, rename the printer correctly through Devices and Printers and set the size of the Tickets being printed. (Each customer has a predefined form that defines these dimensions!) Printing: BOCA Ticket Printer printing blank tickets Solution Size settings have not been configured correctly in Printer Properties. Open Printer Properties and click General tab>>Preferences>>Advanced and ensure that the correct Paper/Output Paper Size settings are defined. If a form has been defined, select the appropriate form from the dropdown menu. From Printer Properties, click Advanced>>Printing Defaults>>Advanced and ensure that the correct Paper/Output Paper Size settings are defined. If a form has been defined, select the appropriate form from the dropdown menu. (this would propagate changes to Printer Properties>>General tab>>Preferences>>Advanced) Example:- Size Settings have been saved as “Alnwick ticket” named form in the below example… Note! The older model BOCA uses a different PLU Ticket Design to the newer model BOCA. It is thus essential to define two different Ticket Designs each with different BOCA ‘Paper Size Profiles – Forms’. Printing: Barcode Labels not printing If a label printer is printing a barcode incorrectly and the Stock item barcode has a ‘0’ to the front of the barcode, try changing the symbology to correct this. Printing: Barcodes Printing Issue - Epson TM-L90 appending a ‘0’ to the beginning of an EAN13 barcode Fix On the Merac computer in question, search for the Stock item in Back Office and click Print Barcode and then uncheck the box to ‘Manually choose barcode symbology’ (this adds a ‘0’ to the beginning of the barcode) and then close the window and then click Print button. Printing: Unable to print to a Network Printer When configuring network attached printers whereby the printer is installed on a print server, if the printing device is removed, the POS Till may return the following example error message when attempting to print… (It’s a kitchen receipt printer so it is possibly an EPSON TMU220 or TMU230) Troubleshooting If the replacement printer has been plugged in using an Ethernet cable, get the user to print a configuration page on the printer to obtain the IP Address of the new printer. A utility installed on the server called Epson TMNet WinConfig is used for network device discovery by MAC Address for attached or previously attached Epson printers. Start>>All Programs>>EpsonNet>>TMNet WinConfig>>launch ‘TMNet WinConfig Ver.3’ If Epson TMNET WinConfig is installed on the server, from TMNet WinConfig, click on Ethernet in the left-hand pane and then ping each IP Address to determine which is not pingable. This will more than likely be the old device that has been removed. Highlight the old printer IP Address and click the Configuration button and then TCP/IP tab and change the IP Address to match the new IP Address. This will force TMNet WinConfig to assign the correct IP Address to the network attached printer. Now on the Till, delete and re-add the shared printer or re-edit the old printer setup through ‘Devices and Printers’ and change the IP Address to the new IP Address. Now use this information to determine which shared printer the IP Address is associated on the server within ‘Devices and Printers’ because you will need this later to re-add the shared printer back onto the Till. A utility installed on the server called Epson TMNet WinConfig is used for network device discovery by MAC Address for attached or previously attached Espon printers. Start>>All Programs>>EpsonNet>>TMNet WinConfig>>launch ‘TMNet WinConfig Ver.3’ If Epson TMNET WinConfig is installed on the server, from TMNet WinConfig, click on Ethernet in the left-hand pane and then highlight the old printer IP Address and click the Configuration button and then TCP/IP tab and change the IP Address to match the new IP Address. This will force TMNet WinConfig to assign the correct IP Address to the network attached printer. Now on the Till, delete and re-add the shared printer or re-edit the old printer setup through ‘Devices and Printers’ and change the IP Address to the new IP Address. The kitchen receipt printer should now be able to print. The problem printing should now be resolved! Printing: Unable to print Receipts from Tills screen in Back Office. ‘Invalid use of NULL’ error Error details below:- = Date and Time: 31 Jul 2015 09:44:43 Operator: MEL Error Source: PMBOS Form/Object: FViewTXN Sub/Function: ShowTXN = - Error 94 Invalid use of Null = You can print receipts for other Tills. For the offending Till in Till Configuration, you will notice no Receipt Design defined in ‘Alt Default Till Documents’. If there is no receipt printer setup you cannot set a Receipt design from Till Configuration so to get around this, do the following… Solution select * from Tills begin transaction update TillS set tilReceiptDoc = 1 where tilReceiptDoc is null commit Printing: Failed to claim OPOS Receipt Printer If still not able to print and you get the following error messages when opening up the POS Till program… First try close down both Merac Back Office system and POS Till program and then open OPOS and try run a health check. If this fails, the print device could very possibly be plugged into another COM port not configured to the device defined in OPOS or it could be attached to a USB port in which case device would be regarded as defunct in OPOS and not considered at all when getting the printer to work. To check if the printer is attached to a USB port, open Devices and Printers and you may find a printer in the list with a random device Make/Model name which has been installed automatically by Windows which you will then have to rename to WINRECEIPT. Then open the Merac Back Office system>>Till Configuration>>Receipt/Slip Printer and set to WINRECEIPT. Recreate Till Data and test printing. Now when opening up the OPOS Till software, no error message will be displayed and you should be able to print. Printing: Permissions error when trying to print a Purchase Order Sales/Purchase Orders –These are online purchases of Stock. If you try and print the below Sales/Purchase Order Picking List and receive a permissions error as seen below… Fix Check that the report is in the Reports folder (PickingList.rpt) and if not, import it from Back Office which should fix the issue. Accounts/Customers & Memberships Accounts|Customers|Memberships: Unable to Void New Member entered through Till If you open a Till and click Memberships\\New Member button to open the MStore Membership Wizard and add a new membership, a membership card and welcome letter will be printed after which you will then need to swipe the membership card and enter in the Joining Fee and Entry items to basket and then make payment. Note! You cannot void the transaction once the new member has been entered into the Till without completing the transaction. If you do you will receive the following “lock error”… Fix To get around this, the Till operator would need to complete the transaction and then carry out a Refund of the receipt to balance the Till and then open Back Office and find the member by searching the associated membership number and either set the Expiry to yesterday’s date or simply delete the membership from Back Office. When adding a member from the Till, the Till expects payment at the end of each transaction so if this is not required, best is to add the member from Back Office. Accounts|Customers|Memberships: GiftAid Signature outside of MinMax Date Range Problem When attempting to open a member from Back Office, the system returns the following error message… Error Details- =================================================================== Date and Time: 23 Sep 2015 12:55:10 Operator: PR Error Source: PMBOS Form/Object: FCustIndex Sub/Function: OpenMember =================================================================== ----------------------------------------------------- Error 35773 ----------------------------------------------------- A date was specified that does not fall within the MinDate and MaxDate properties. =================================================================== SQL Statement: select isnull(pvtAdoptBCDID, 0) as pvtAdoptBCDID from PrivilegeSchemes where pvtBranch = 1 and pvtCode = (select prvCode from AccPrivilege where prvBranch=1 and prvAccRecNo=5744 and prvCusSeq=1) =================================================================== Fix select * from Account where accGiftAid = 1 and accGiftAidSigned = '1899-12-30 00:00:00.000' begin transaction update Account set accGiftAidSigned = GETDATE() where accGiftAid = 1 and accGiftAidSigned = '1899-12-30 00:00:00.000' rollback --commit Accounts|Customers|Memberships: Unable to add new Contacts to a Customer Account When Customers are imported into Merac, the system returns error “This key is already associated with an element of this collection” when trying to add a Contact, Troubleshooting Check to see whether the import has failed to set the Account.accLastCustSeq field to match the highest cusSeq on that account. So it assumed the next customer on the account would be cusSeq=1 which exists of course so it goes bang. Reports Reports: Error – Failed to retrieve data from the database Problem Receive the following error message when trying to run a report… Solution One of the SQL data entries extracted from the database had a character length which was a bit too long for the report so had extended these fields. Reports: Error – ‘FRepParams / ExportData error’ Problem When trying to run a Transaction Analysis Report, the Back Office computer returns the following error message ‘FRepParams/ ExportData’ error. Troubleshooting First log onto the Merac server and open SQL Management Studio and try and run the SQL statement given in the error message to determine what the cause of the error is. In the below example you can see that REP_TXNANALYSISNOMINALCODES expects an additional parameter called ‘OUTLET’ which is not available or is missing in the report. Example:- Try run the report from the server from Back Office and if it works then the local report (.rpt) file on the Back Office computer is out-of-date. To verify if the report is out of date, from the SQL Server, expand Programmability container within the SQL database tree and navigate to ‘TXNAnalysisNOM dbo procedure’ (i.e. dbo.REP_TXNANALYSISNOMINLACODES) under Stored Procedures. Take out the code and create a new query and press F5 to execute and see whether the report is displayed correctly without errors on the server. If it is, then the report must be out-of-date on the Back Office computer that was used to run the report. Note! If you do not find anything obvious causing of the error when running the SQL statement on the SQL server, check the Application Event Log from where the statement was run for more details as it could be an issue with the installation of Crystal Reports locally. Solution 1)On the Till in question, open Merac MStore BO System>>Reports>>Transaction Reports>>Update (Note! The update process may take a while to complete with no clear indication that anything is happening until you see the “All reports updated successfully” message) and then try re-run the report. OR 2)Delete C:\\Program Files\\Merac\\Reports\\TXNAnalysisNOM.rpt or C:\\Program Files (x86)\\Merac\\Reports\\TXNAnalysisNOM.rpt and then try re-run the report. Note! If there is still an issue, it could be a local permissions issue. Reports: Error – ‘One or more fields could not be found in the result set. Use verify database to update the report’ Steps:- Log onto the Merac Server and navigate to Meracdata\\Reports directory and verify the offending report file version (i.e. .rpt file modified version date) and compare it to the local copy. If heavily out-of-date, copy ours or a known working version over to customer’s server within Meracdata\\Reports. Open SQL Management Studio localhost>>navigate to by expanding the following containers - Databases - database name (e.g. MStore) - Programmability - Stored Procedures. (search for the appropriate dbo.xxxx Stored Procedure for the report and right-click and choose Modify to view the code) Check the Change History comments field at the top of SQL code to compare date with another customer’s Stored Procedure and if out-of-date, overwrite the broken version by doing the following – copy and paste all the code onto the server from where the problem is reported, remove the header lines in the code, highlight all the code copied and click the Execute button and make sure the command executes successfully… Try re-run the Report again from the BO System. Reports: Update Reports (for 3.14 and 3.15 alike) Copy over a known good version report file to the Desktop on the server. Run good version Stored Procedure. Delete the existing report from Merac Back Office to remove the record from SQL Reports table. Import the .rpt file saved on the Desktop. This process will insert a new record into the SQL Reports table and copy the report into Meracdata\\Reports. Click Update to copy the new report file to the local Merac\\Reports folder. Repeat the Update procedure on each and every client to update their report version locally. This process will copy down the latest version from Meracdata\\Reports. Reports: Crystal Reports .rpt File Not Found error Solution From SQL, use the select statement to view all contents of the Reports table and then verify the name of the report and then delete the entry and then from any client (i.e. Back Office computer), re-import the report file back into Back Office/Reports which should then update SQL Reports table with a new entry of the report. Example:- select * from Reports where repTitle = 'Member Visits' begin transaction delete from Reports where repTitle = 'Member Visits' commit Check that the ini file DataPath is setup correctly. Check that the Reports folder location is setup correctly from Back Office>>System Options>>General tab From the client (Merac Back Office computer), navigate to the local Reports directory and rename the existing report file (.rpt) and then navigate to Back Office/Reports and then click Update button to update all reports stored in the Merac Server Reports folder. This will automatically update the Reports table in SQL with the report entry recently deleted from the table and should also copy across an up-to-date version of the report file from server to the client. If the Report is not visible in Back Office/Reports, click Import button to import the report into Merac Back Office system, which it would be, since we deleted it from the reports table in SQL. Done! Reports: Export Error - ODBC driver does not support the requested properties Example:- The above error is referring to running the Footfall report. Troubleshooting SQL Statement: exec REP_FOOTFALL 0, 0, 0, 0, 0, '01 Oct 2014 00:00:00', '30 Oct 2014 23:59:59' By examining the code of the report in Crystal Reports, in the above example, the Stored Procedure is passing 8 parameters but the actual Crystal Reports file (.rpt) is expecting only 7 parameters passed to it by the Stored Procedure. Solution In the above you can see that the Stored Procedure @DATERANGE parameter has been commented out and then you just declare a value to the variable as seen in the second part of the exhibit encircled above since the crystal report file is not passing this parameter to the Stored Procedure so the Stored Procedure does not know what to do with this additionally defined parameter. Then Execute the Stored Procedure to recompile it and then this should fix the issue. Reports: Unable to run any Reports - Returning SQL error – FRepParams/InvokeRepParams Solution Have fixed this by updating the local MStore.ini path to point to the correct location of the local Merac installation folder. If the exact same error is returned as seen above except that the error also mentions a Permissions Error, ensure that the Everyone group is granted Full Permissions to C:\\Program Files (x86)\\Merac (for Back Office 3.14 or below) or C:\\ProgramData\\Merac (for Back Office 3.15). Reports: Reports taking a long time to load and display Troubleshooting First try delete the local reports file and then re-run the report. Secondly, try run the report from the server and if there are issues, copy and run a known working store procedure for the given report (e.g. txnanalysis.rpt) from another known working customer server and run the SQL Code for the procedure on the SQL server to update its procedure with a known working version. Re-run the report and it should work. Reports: Very slow when running any Reports Problem Merac Back Office system crashes or takes a very long time to complete (e.g. 10 mins as opposed to 25 secs to run a report). Troubleshooting Tried running this from the server and the same problem occurs. Hour glass appears and Back Office system hangs. Checked resources and CPU is fine and working/dynamic memory availability is fine… Solution This matter has been solved by increasing the amount of SQL Server memory allocation and configuring the SQL Server to use dynamic memory for Indexing. Steps:- Open ‘SQL Server Management Studio’ and right-click the top level and select Properties>>Memory and make the below adjustments… Now restarted the SQL Server service – open ‘SQL Server Configuration Manager’ and then click on SQL Server Services and restart SQL Server (MSSQLSERVER) Note! Best practice to stop and then restart the SQL Server service. Now reconnect back to the database by clicking Connect>>Database Engine and log back on… Try re-run the report through a new query and see if there is any improvement on the response time (e.g. REP_BOOKINGS 1, '24 Sep 2014', '30 Sep 2014', 0, '') Other Important Information regarding SQL Server Management Studio encircled below… In the highlighted Management folder within Microsoft SQL Server Management Studio tree structure, normally there is an additional Indexing Tool that allows you to defrag database Indexing. SQL command: sp_who --command outputs who is logged onto the SQL Server database Note! As more and more reports are run on the SQL Server, so the temp Reports table grows larger and larger in size and hence may hinder the performance on running reports. To fix this issue, either restart SQL Server service and the SQL Agent service (used for monitoring and maintenance purposes) or last resort, restart the SQL Server, which should return the size back to its default size (file name is temp.db). Reports: Back Office crash following running a report for version 3.14 Problem Client or Server Back Office installation crashes following clicking ‘Screen’ button to run and view the contents of the report and then closing it. Solution Try run a repair of Merac Back Office which should fix the issue. If however, you receive the following ‘Business Objects Enterprise secldap.dll’ error during the repair, copy over the offending dll from a known working computer (located in either C:\\Windows\\System32\\ and/or C:\\Windows\\System32\\SysWOW64 folder) and place it in the path location specified by the error seen below… Re-run the repair again. If it still complains that the dll has not been registered, ignore the error and once the installation is complete, open Back Office and login and then see if you can run a report. If you can, all is OK and working as it should. Rename the DLL USP10.DLL to _USP10.DLL.Old. This DLL is located in the following places: 32 Bit Operating System C:\\Program Files\\Common Files\\Business Objects\\3.0\\bin C:\\Program Files\\Common Files\\Microsoft Shared\\OfficeXX 64 Bit Operating System C:\\Program Files (x86)\\Common Files\\Business Objects\\3.0\\bin C:\\Program Files (x86)\\Common Files\\Microsoft Shared\\OfficeXX Done! Reports: Data Extract error or Report error – Subscript out of range Solution Open Excel and change “Include this many sheets” dropdown from 1 to 3 as seen below and then try and run the Data Extract again… Reports: Seating Plan Report returning an error Troubleshooting Review the Stored Procedure code and to determine what is causing the issue. Looking at the two temp tables setup in the Stored Procedure… …all columns/fields are set to ‘NOT NULL’ which means the value “NULL” cannot be returned into the table. When you run the insert subqueries for both #tblJourneyDetails and #tblBookingDetails, you can see a NULL value is returned for both jdSeatingPlanDesc and bdBkhRef… --select * from LookupGroups --where lkgDescription like 'Booking Types%' --select * from Lookups --select lkudescription from Lookups --where lkuGroupCode = 8 --insert into #tblJourneyDetails select slcJourneyLine, left(lkuDescription, 30), shdRecNo, shdDescription, substring(convert(varchar(20), shdDateTime, 113), 13,5), slcDescr, sphDescr from SessionHdr inner join SessionLocations on shdBranch = slcBranch and shdSesLocId = slcSesLocId inner join Lookups on slcJourneyLine = lkuRecNo left join SeatingPlanHeader on shdBranch = sphBranch and shdSeatingPlan = sphPlanId -- where shdDateTime >= @FDatetime and shdDateTime = '7 Dec 2014 00:00' and shdDateTime = @FDatetime and shdDateTime = '7 Dec 2014 00:00' and shdDateTime In the FootFall Analysis report, the FootFall column is the actual sum of ‘ftfQty’ and ‘ftfFootfall’ from the Footfall table between the given dates… Reports: Promotions report – duplicate Promotion Descriptive Names In the below SQL extract, you can see that the promotion being used for ‘classic gardens’ validity date (‘prhStartDate’ and ‘prhEndDate’) ‘txnPromDesc’ is would match the Promotion name in Back Office Short Description name. Reports: Export button greyed out on the Parameters window The fix is report specific so you would need to repeat the fix for each and every report that this problem occurs. Fix The Export button on the report parameters screen is only enabled if the repProcName field in the Reports table is set with the actual stored procedure name. Reports: Report not importing correctly When a Stored Procedure for a report is updated as well as the .rpt file upadated, an import of the report fails as a result of the StoreD Procedure not being found. Fix Delete the report entry in the Reports table and then try re-import and make sure the entry in the table ‘repProcName’ is updated with the correct Stored Procedure name as seen in the below example… Data Extracts Data Extract: Mailing Extract Error – The object invoked has disconnected from its client Solution Try close down Merac Back Office and re-open and re-run the report. Memberships>>Mailing Cause May have been caused by network connectivity issues. GiftAid GiftAid: Claim Submission Failing GiftAid Claim Submissions Error - Authentication Failure. The supplied user credentials failed validation for the requested service If the Account details are not setup correctly (i.e. the name of the 'Registered Charitable Contact' is incorrect) even if the UserID and Password is correct and the user can login to the gateway directly (https://online.hmrc.gov.uk/login), the customer would need to contact the HMRC to get the below details verified... Example:- GiftAid Claim Submissions Error - Unable to submit GiftAid Claims Receive error: ‘Error when Submitting Claim to HMRC: Please see error report’ The below schema error ‘Your submission contains an unrecognised namespace’… Fix Uninstall GiftAid from Add/Remove Programs and then download the latest version of GiftAid Manager from the Merac download page and this should fix the issue. Note! This will not cause loss of current GiftAid Claims stored locally on the computer. These are stored in a location other than within the installation directory. GiftAid Write Submission Error After installing GiftAid Manager from Merac website, if a Write Submission error is returned, then check that the correct permissions have been applied to the GiftAid folder under C:\\Program Files (x86)\\Merac\\ and if so, uninstall Gift Manager and reinstall. Note! This will not cause loss of current GiftAid Claims stored locally on the computer. These are stored in a location other than within the installation directory. GiftAid: Declarations Report hanging Problem GiftAid Declarations Report hanging when specifying partial Date search criteria to find Unclaimed Entries. Also when doing a full month report for the same month it does output report information. The report includes Branch_Number, GiftAid Unclaimed Entries, Till Number and Receipt information. Example: If changing the Date range to: 01 Sep – 30 Sep (this works) If changing the Date range to: 22 Sep - 30 Sept (it just hangs) Solution Download the newer version of GiftAid Manager from the Merac website and install it which should fix this issue. GiftAid: ‘Divisible by zero’ SQL Statement function error Setting the PLU Sell price to £0.00 with the GiftAid option still entered will render a Till “Divisible by zero” SQL Statement function error. Fix this by disabling GiftAid for the item set to £0.00. GiftAid: PLU View/Add Price showing GiftAidable Claimable Amount not equal to 10% as System Options defines Reason The reason for this is because when the PLU ‘Adult Admission’ ticket was initially setup, the Sell price was set to £100.00 which means the system calculated 10% GiftAid on this item correctly as you can see below. If the Sell price is changed in the future, the GiftAid contribution calculated when the PLU was initially setup would need to be manually adjusted to reflect the newly revised GiftAid contribution. ‘Adult Admission’ shows GiftAid Claimable Amount of £10.00 which is correct because the initial Sell price for the item had been set to £100.00 which was later changed to £50.00. There is no proof of this price change unfortunately because the item had not been sold at the original price so there is no transaction recorded against it. By default, all customers who donate to a charity (i.e. they are registered as a Charity Organization) will contribute 10% towards GiftAid (i.e. there chosen charity). GiftAid: Fix Taxing on GiftAidable items To prevent taxing on GiftAidable items sold, you can run ‘UTIL_RecalculateGiftAidTable’ Stored Procedure to fix this. e.g. CustomerName: Painswick Rococo Gardens Obviously, Painswick do not want to pay tax on GiftAid so Nik has setup a SQL statement to update the GiftAid Tables to prevent this from happening. Item Price Claimable Amount (normally 10% of the original price or rounded off to the closest price) e.g. PLUs incl. GiftAid Admission Family 30.00 3.00 (NOT TAXABLE) e.g. PLUs dis-incl. GiftAid 27.00 (TAXABLE) GiftAid – GiftAid Conversion report not matching entries in the GiftAid Claim Submissions list Problem GiftAid Module addin used for GiftAid Claim Submissions was showing indifferently (e.g. a higher amount) to the actual GiftAid Conversions report. Solution GiftAid BackFix… Narrowed it down to locate a specific date in time when the GiftAid Claim Amount is different to the GiftAid Conversion report. select gftSurname,gftPostcode, txhCompleted,gftClaimAmount from TXNHeader INNER JOIN Giftaid on gftTxnNo = txhNo where txhCompleted between '13 Jul 2014 03:00' and '13 Jul 2014 23:59' --order by txhCompleted asc OR select gftClaimAmount from TXNHeader --select sum(gftClaimAmount) from TXNHeader INNER JOIN Giftaid on gftTxnNo = txhNo where txhCompleted between '13 Nov 2014 10:39' and '13 Nov 2014 10:40' --Example:- --GA CLaimAmount = 55.80 --GA Conversion Report = 27.90 --Need to check Stored Procedure Checked to see what transaction/s was/were involved to try establish or determine a pattern or whether the transaction was linked to a Booking or Member. select * from TXNHeader inner join TXNDetail on txnNo = txhNo where txhCompleted between '13 Nov 2014 10:39' and '13 Nov 2014 10:40' Inspect the transaction file stored local on the Till to find out if the transaction amounts tie up to the data written to the server. The data written to the local transaction file could be different to the actual data written to the database for a given transaction. Establish from the date the problem was reported and to a wide date range in the future whether or not the same problem is occurring. If not, then the solution would be to back fix the data using ‘UTIL_RecalculateGiftAidTable’ Stored Procedure. You can verify that the data is corrected once the UTIL_RecalculateGiftAidTable Stored Procedure has been run using the below statement. There will be transactions whereby the sum of txnLineSellValue for a given transaction is greater than the GiftAid gftClaimamount. This is because some transactions may include items that are not GiftAidable… select txhCompleted, txhno,gftclaimamount,SUM(txnlinesellvalue) as ‘TXNValue’ from TXNHeader INNER JOIN Giftaid on gftTxnNo = txhNo INNER JOIN TXNDetail on txnNo = txhNo where txhCompleted between '01 Nov 2014 00:00' and '30 Nov 2014 23:59' and gftclaimamount is not NULL group by txhNo,gftClaimAmount, txhCompleted order by gftClaimAmount - SUM(txnlinesellvalue) desc --in the above 'order by' statement, we know that the SUM(txnlinesellvalue) will either be higher or equal to --gftClaimAmount depending on whether all items are GiftAidable for the given transaction (value = ‘0’) or the transaction --includes items that are not GiftAidable in which case they will appear in the bottom of the list - not all ‘transaction line sell --values’ in a given transaction are GiftAidable! --the above 'order by' will arrange entries starting from transactions that result in a value of ‘0’ followed by transactions that --result in a value less than ‘0’ --each transaction may include a number of line sell items/values where each transaction is linked to a GiftAid table --gftClaimAmount Back Office Back Office: Unable to run ‘Recreate Till Data’ - receive error: Unable to connect to MeracUpdater service This is a known issue which occurs with Merac BO v3.15 installed and is not really a problem. The error returned does not prevent any of the Tills from updating. Advise the customer at this point in time to ignore the error message. Back Office: Merac Back Office Installation Troubleshooting If the Merac installation fails to complete as a result of not finding a local path, this is caused by the user account being logged on with a roaming profile with folder redirection. Cause If the Setup.exe file is run from a redirected folder, the executable will check compatibility on the system before running the MSI. Because the temporary folder location used to store temp installation files during any installation is local (%USERPROFILE%\\AppData\\Local\\Temp) and the executable is searching for the MSI from the temp folder location within the user’s roaming profile on the remote server, it cannot be found and the installation fails. Solution To get around this, run the executable and when presented with an error do not close the error window. Navigate to %USERPROFILE%\\AppData\\Local\\Temp and the MSI Installation folder should have copied across. Copy the downloaded temp installation folder (i.e. in this case named “_is9189” containing the MSI to the local computer Desktop and then close the error windows after which the temp folder and its contents will be deleted. Now re-run the installation. Back Office: Login Update Notification Message Problem When logging into to Back Office from either a client or the server and you receive a message stating that MeracOS.exe is out of date, the notification window will ask you to click ‘Yes’ or ‘No’ button to run the update or not. Cause When you Recreate Till Data, any changes made are copied to the SQL database and uses the timestamp when the update was copied across to the database. Because there is a timestamp mis-match between the server file version and files authorized in updatenewver folder on the server, the error is displayed stating that the offending file is out of date. Solution Obviously because we are experiencing the same error on the server, it is not a local client permissions or ini configuration file issue causing the problem. Do the following:- select * from updateserverfiles begin transaction delete * from updateserverfiles where upsid = X commit Back Office: Merac Back Office software Out-Of-Date Error Problem When launching Back Office, receive a “Program out of date” error as seen below… Fix This is likely caused by either: Not having the the correct write permissions to ‘C:\\Programs Files\\Merac’ or ‘C:\\Programs Files(x86)\\Merac’ folder. Not having a connection to the \\MeracData share therefore preventing the system from running updates. UAC settings on Windows 7 or higher preventing the running of MStoreUpdater.exe or MeracUpdater service. Check that MStoreUpdater.exe is in the Windows Startup folder or that MeracUpdater service is started. Make sure that there are no ‘Compatibility Files’ listed in Windows Explorer pointing the Merac installation to the wrong system files. Back Office: Computer not able to communicate with the Merac Server Troubleshooting Either add an entry to the hosts file to include an entry for the Merac server OR Ensure that if the Back Office computer is part of a WORKGROUP and the server a domain, that the network has been defined as a ‘domain network’. If setup any different to this (i.e. public or private network), firewall settings could be blocking access to the server. OR Check that the Switch that the computer is connected to is not blocking connections from the host by MAC Address (customer IT department will need to check this). Back Office: Trying to adjust a PLU sell value returns message to specify a Price Matrix Workaround You can update the sell value of a PLU associated with a Pricing Matrix by clicking on Edit>>Copy and then making changes to the sell value with introduction to a Price Break. Back Office: Selling of Session Tickets not displaying correct Num QTY in Back Office Steps:- Add the sessionable PLUs to basket Press SubTotal button The Till will then prompt the Till operator if they would like to book now (i.e. book meaning reserve the session so no BookingRefNo will be created) Press Yes Highlight the session for the chosen date and then insert a name that the session is booked for (i.e. in this case is for ‘Chris’). The name will be inserted into the sessName field within the SessionBkgs table and then press OK sessName The session reservation will be displayed on the right-hand side as seen below… Now when you select the session from Add/Edit SessionTours in Back Office and click Make Booking button You can see that the ‘Num’ value encircled below does not match the actual value from the Till. The Till had a value of ‘2’ inserted and Back Office is showing a value of ‘1’… To verify the data in SQL, do the following:- select * from SessionHdr where shdDateTime = '20 Aug 2015 16:00' and shdDescription like 'Leap of Faith%' --shdRecNo = 7958 for ‘Leap of Faith: Session 5’ Session Type. If you reserve the same Session Type as seen above (one at 14:00 --and one at 16:00) each will have different sessRecNo’s) select * from SessionBkgs select * from SessionHdr inner join SessionBkgs on shdRecNo = sesshdRecNo where shdRecNo = 7958 and Solution Escalate to Dev Team Back Office: Files not Updating when MeracUpdater runs Those errors mean one of 3 things:- 1) The files mentioned are not currently in the software distribution folder - \\\\\\meracdata\\updatenewver\\cache 2) The current locally-logged-on user does not have permissions to read the contents of this network shared folder 3) The current locally-logged-on user does not have permissions to copy those files to the local C:\\Program Files\\Merac (or C:\\Program Files (x86)\\Merac) folder Troubleshooting You can test 1) by typing the path above into Start > Run on that computer. You can test 3) by manually attempting to copy one of those files from the source to the destination folders. Back Office: Creating a new Lookup Item “Violation of PRIMARY KEY constraint” Error Fix Determine the Maximum Record Number in the Lookups table and then set the ‘RecNum’ in the ‘RecordIDs’ table to that number. This will ensure that when a new Lookup item is created that, that the next available Record Number in the Lookup table will be assigned. Example of how adding a Lookup Item affects the respective tables:- Back Office: Stock Entry Duplicate Primary Key error The above SQL Statement error usually occurs when your table ‘RecordIDs’ are out of sync. To fix this run the following sequence of SQL commands to update the ‘ridRecNum’ in the ‘RecordIDs’ table to match that of the maximum ‘stkRecNo’ in the Stock table, as seen below. In this way, when a new Stock item is added to the Merac system, a non-duplicate ‘stkRecNo’ will be assigned. Examples:- Back Office: Unable to Move Stock from ‘Unknown Stock Location’ to known Stock Location If a stock count quantity has been assigned to a Stock Location and the Stock Location later gets deleted, when you click on the glasses icon within the Stock Maintenance window, you will notice that the Stock Location has a description of ‘Unknown Stock Location'. Moving Stock from deleted Stock Location to known undeleted Stock Location When carrying out a Stock Movement from location to location from Back Office, because the Stock Location for which the quantity had been assigned has been deleted, ‘Unknown Stock Location’ is not visible in the From Location in order to move the item to another location. Solution We need to move the Stock Count for the given Stock item from ‘Unknown Stock Location’ to the correct location and then delete the ‘Unknown Stock Location’ so that it no longer appears in the list of Stock Locations as seen below… Below are the known Stock Locations that exist in the database… (lkuRecNo = stlLoc) As you can see, ‘Unknown Stock Location’ (stlLoc = 97) does not exist in Lookups table where lkuGroupCode = 12. begin transaction --delete from StockLoc where stlLoc = 97 --update StockLoc set stlQty = 6 where stlRecNo = 2110 and stlLoc = 99 rollback commit The result will be as follows for the given Stock item… Back Office: Forecasts Information not updated correctly for Footfall Proj – Projection of Footfall forecast from previous years Actual Footfall. They must equal normally but not necessarily. Act – Actual Footfall of previous year. Staff Rota – can be changed from the Forecasting display window manually by double-clicking the cell and then typing the value ‘Closed’ or ‘R.1’ or ‘R.2’ into the cell. Click Save and then Update Forecast button. Troubleshooting Look at a given year where Actual Footfall difference appears (e.g. as seen above example encircled in red), there appears to be no forecast data for the 29/06/2014 but there is for 30/06/2014. Check the below tables:- select * from Forecasts select * from Depsummary select * from Forecasts where fordate between '29 Jun 2014 00:00' and '30 Jun 2014 23:59' --don’t worry if 'forActFootfall' is a value of '0'. This is not necessarily the Actual Footfall select * from DepSummary where dsuDate between '29 Jun 2014 00:00' and '30 Jun 2014 23:59' --you will notice that there will possibly be missing data for 29/06/2014. Run the below Stored Procedures below to fix this. --MC_InsertDepSummary --ALTER PROCEDURE [dbo].[MC_InsertDepSummary] '01 Dec 2013','01 feb 2017' --@FromDate as datetime = 0, --@ToDate as datetime = 0 Note! In the MC_InsertDepSummary Stored Procedure, make sure you choose a date range that encompasses a wide range to account for previous years that rely on previous year’s actuals to be included as well in order to tie up days with dates. For example – ‘Thurs, 01 Oct 2014’ may not necessarily be ‘Thurs, 01 Oct 2015’ but actually ‘Sat, 01 Oct 2015’ which could have been a non-trading date so projected footfall would not display correctly. ALTER PROCEDURE [dbo].[MC_UpdateDepSummary] @YearsBack as tinyint = 0 -- 0=up to one month old transactions; 1=up to one year and one month old txns; and so on) MC_UpdateDepSummary 2 Now if you go back into Merac Back Office Dashboard/Forecasting and then click the Update Forecast button, the data missing will now appear. You may need to manually amend any projected Footfall figures that have not updated with the previous years Actual Footfall figures. Back Office: Mailing Export/MailMerge to MS Excel/Word error PMBOS: Microsoft Excel/Word returned the following error:- Application-defined or object-defined error Example:- 2 1 3 1 - Exports queried output displayed in the grey section to MS Excel as a data list. Click the Export Data To List button. 2 - If wanting to export the queried output displayed in the grey section to MS Word for the purpose of Mail Merging the data list. Click the browse button (3 dotted button) to the far right to browse to and choose the appropriate mail merge letter (i.e. in this case is called ‘Renew Ack Letter.docx’). 3 - Click the Mail Merge to Word button. Problem When choosing action sequence ‘1’ or ‘3’, the following error is produced… Solution First open MS Excel and open Excel Options and ensure that three sheets are defined for all Workbooks Open Command Prompt and try and ping the Merac Server Hostname and IP Address or try browse the server URL. Open Internet Explorer settings and click Security tab and 'Trusted Sites’ Add both \\MeracData and \\MeracData to trusted list and close all browser instances. Now try click on the buttons again. Once the letter has been merged into MS Word, click Mailing tab and then ‘Finish & Merge’ in the MailMerge toolbar. Choose ‘all’ and the then the entire exported data list should be inserted into the MailMerge Letter. Done! Back Office: Error when attempting to Clone an existing Receipt or Ticket Design Search for the Ticket Design to clone, select it from the drop-down and then click on Display button to view the details of the ticket design to clone… Click Clone button... Insert Document Name in highlighted red field below and then click Save Changes button… If a SQL Statement error is returned, it is likely a ‘PrintLayoutHeader’ table sequencing issue. Run the following to correct this: From the above you can see that the last allocated sequence number in the PrintLayoutHeader table is 1104. Fix Now amend the ‘ridRecNum’ value for both ReceiptDefinitions and TicketDefinitions within the ‘RecordIDs’ table to a higher numerical value (e.g. 2000). Debit/Credit Cards Credit Cards: Card Machines Down ***(If using ACK)*** ***************** Log onto the customer’s Merac Server End Process Tree for wbtterm3.exe (old version exe’s are ECPWSS_C.exe and ECPWSSVC.exe – no need to terminate) Stop/Start both ACK EFT Windows Socket Server and ACK EFT Node Encryption services Restart Normal Polling (shortcut on Desktop) [Normal Polling is a scheduled task to poll debit/credit card transactions] RE – Normal Polling (aka. Scheduled Polling) Usually a common error concerning Normal Polling crashed on server would be error message “Batch Transfer in Process” which means the previous scheduled polling has been executed successfully but crashed thereafter. To fix the issue, implement the above fix. ***(If using YesPay)*** ******************* Log onto the Till and kill java.exe and javaw.exe. Log off the POS Till program. Restart StartPOSServer.bat. Re-run and log back into POS Till program and test by taking a dummy payment. ***(If using Verifone Ocius Sentinel)*** ********************************* Note! Default Installation Path: ‘C:\\Program Files\\Verifone’ and ‘C:\\Documents and Settings\\All Users\\Application Data\\VeriFone\\PAYware Ocius Sentinel’ Log onto each Till and terminate the POS Till program. Right-click in the system tray and Exit Ocius Sentinel program (Quit the Ocius Sentinel Card Machine program). Double-click the Ocius Sentinel program shortcut icon in then Startup folder in the Start menu (not the Desktop) to restart the program and then the icon should re-appear in the system tray. Double-click the Ocius Sentinel icon in the system tray and then log back into Ocius as follows: [enter PIN code ‘1234’ and click Enter button] twice… Once logged in, double-click on the Ocius Sentinel icon again to verify that the card system is online which will be identified as the Ocius Sentinel window looking similar to the following… Click on Hide button and then re-launch the POS Till Program Repeat for all Tills (ask Dave Radford for registry change fix if needed!) Note! The normal install sets up an Ocius Sentinel shortcut exe file in C:\\Documents and Settings\\All Users\\Start Menu\\Program Files by default that does not work. Solution Browse to C:\\Program Files\\Verifone folder and recreate a new Ocius Sentinel shortcut (for Windows XP) Copy the shortcut to ‘C:\\Documents and Settings\\All Users\\Start Menu\\Program Files\\Startup’ or ‘C:\\Documents and Settings\\Till\\Start Menu\\Program Files\\Startup’ and then repeat the Ocius Sentinel initialization process above. (for Windows 7) Copy the shortcut to ‘C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Startup’ and then repeat the Ocius Sentinel initialization process above. If that does not resolve the issue, get the user to plug the Serial to USB cable/converter into a different USB port and then restarted the Ocius Sentinel program – this should resolve the issue. This process has caused the PinPad Ocius Sentinel software to re-claim the device using an alternative USB port. Credit Card: Unable to take Card Payments – Till Offline If customer is unable to carry out PDQ credit card payments and the Till is showing a red box at the bottom right-hand-side saying offline. Solution Delete/Rename the Tillstatus file in C:\\Program Files\\Merac\\ Note! When a Till goes offline, a message will be displayed at the bottom in Red/White saying ‘Offline’. It will then create a file called ‘Tillstatus’ or ‘netstatus’ (a text file) in C:\\Program Files\\Merac directory on the Till. To get the Till back online, delete/rename this file to fix the issue or add items to the basket and the ‘VOID ALL’ to force a reconnection to the server. You could also click on the ‘Offline’ message at the bottom of the Till screen and select ‘Re-try again’ to force re-connectivity. Credit Card: YesPay Error – “Transaction Failed : Declined offline. Please Take alternative payment” Sent log files to YesPay Support. Credit Card: Unable to read Debit/Credit cards when swiped through the Till PDQ Card Reader Problem Till operator reports that Credit Card Readers are becoming more and more mechanically unreliable, often not recognising perfectly good cards and staff have to ask customers to remove cards and try again. If the card readers are failing to read the chips correctly then it would be down to hardware. Odds are that it could be resolved by using a cleaning card. They may have become dirty etc. Solution Get the customer to insert a Smart Card Reader cleaning card into the card machine a few times to rid of stubborn contaminants (i.e. dust and dirt etc.). If needed, we can send the customer a cleaning card in the post at a small fee (discuss with Dave or MikeC but we normally charge £2.00 per card cleaner). This card cleaner is a single use card once opened from the wrapper – unwrap and then clean all machines in a single go and throw the card away as it will dry up and be of no use thereafter. If this does not improve things then sales@merac.co.uk can advise on how much a replacement PDQ machine will be. A pinpad Software Update may be required. The cashier needs to be at the Till at the time you remotely assist in carrying out a pinpad Software Update! The Smart Card Reader for the card machine could be damaged. Credit Card: Chip&PIN not working If you insert a Chip&PIN card into a card reader and the Card Machine returns a message saying “Swipe Card (requires a customer signature)” instead of “Chip Found (does not require a customer signature)” message, then it cannot be a fault with the hardware. It is likely a firmware issue and the needs to be re-flashed or upgraded. Credit Card: YesPay/WorldPay – CashBacks not working Provided WorldPay confirm that CashBacks has been enabled for the respective TID, do the following:- Go into C:\\YESEFT\\common files\\conf and copy all the files and paste them in C:\\YESEFT\\conf (replacing the existing files). Go into C:\\YESEFT\\common files\\properties and copy all the files and paste them in C:\\YESEFT\\properties (replacing the existing files). Go into C:\\YESEFT\\conf and delete the three data set files and then initialize the terminal, namely: EFTAcquirerDataset.xml EFTIssuerDataset.xml EFTMerchantDataset.xml Follow the steps mentioned and then try to perform a Cashback transaction. If the below “Multiple Terminal Installation” message appears when re-initializing the software, contact YesPay/WorldPay and request a KeyChange… Credit Card: YesPay - Card Refunds using EasyVTerminal version 3445 Just a heads up. If you receive any calls from customers saying that they are unable to refund against a card with the PDQ card machine returning error ‘Transaction Failed’. To fix this issue, upgrade their version software to 3445 and then when the Till operator enters the card number and expiry, when they are presented with the below box… …advise then to not enter Start Date and Issue No and simply press OK on this window and it should work fine. If you enter in the Start Date and Issue No it crashes Windows and the entire computer/Till system shuts down resulting in them having to press the power button to turn the Till back on. Also when entering the Expiry Date on the card machine, the Expiry Date will appear differently from the EasyVTerminal window which is normal (confirmed by YesPay Support). Credit Card: YesPay - Card Payment failure as a result of Till going Offline SubTotal>>Credit Card Card is inserted into the reader. Then Void Receipt is printed. The above happens only if the customer is running EasyVTerminal 2.2.4.1 which does not support processing of offline transactions. For example if during a transaction, the till operator decides to take a card payment and the Internet goes down, the above error message will be displayed. The outstanding transactions will be written to a file in the local YesEFT folder. Workaround Zip the folder and send to YesPay to upload the pending transactions. Fix Uninstall 2.2.4.1. and upgrade to 2.2.4.2 as this version onwards supports offline card payment transactions. Credit Card: Polling Query following moving from ACK to YesPay A customer may ask whether all polled transactions have been closed off following moving over from ACK to YesPay. You can verify this by checking for any pending transactions. This is done by running a batch file on the ACK server to check authorized transactions against what the bank has processed (Dave can take a look at that). ACK (old system being decommissioned for use) uses dialup modem to connect. Credit Cards: Ocius Sentinel – ‘Check for Pinpad’ message from Ocius Sentinel window Problem After reinitializing Ocius Sentinel to connect to the pinpad, the console displays the message ‘Check for Pinpad’ as seen below. Solution Wait until the software finds the device as the software it looking for the pinpad. If after a 5 mins it does not find anything and is stuck on this message, try restarting the Till. Credit Cards: Ocius Sentinel not detecting Device on COM Port Configuring Ocius Sentinel to manually detect the pinpad plugged into an unknown COM port. Credit Cards: YesPay – EasyVTerminal Startup Issues When attempting to restart YesPay using StartPOSServer.bat, you may receive a combination of the following two error messages:- Startup Issue 1 Error1: ‘Unable to open EasyVTerminal. Please check COM port…’ AND Error2: ‘Unable to initialize EasyVTerminal. STSTerminalException: unable to reset reader, response…’ Close the POS Till program. Get the customer to check which COM port the card machine is plugged into and ensure it matches the configuration panel. Stop java.exe and javaw.exe. Power off to the device and then wait 10 secs and then re-connect the power and wait for the device firmware to fully load (i.e. there should be a firmware version displayed on the screen when the device is fully loaded) Double-click on YesEFTInterface.bat or click StartPOSServer.bat Re-launch and log back into the POS Till and test by trying to take payment. Startup Issue 2 YesEFTInterface Error: ‘PortInUseExeption: Port currently owned by STS.x’. Cause If you receive the following error when clicking on StartPOSServer.bat, this could mean the TID is possibly already registered and running at another Till so to prevent fraudulent activity or abusing the license on more than one terminal at the same time, the YesPay EasyVTerminal software will return the below error and fail to start up YesPay at the Till… The above can also be caused by other instances of java running in the background. Terminate these from Task Manager and then relaunch StartPOSServer.bat. And when clicking on “Starting EasyVTerminal..” splash screen, the below error is displayed… Solution Contact YesPay and request for a KeyChange and provide them the TID number as seen encircled below... Note! The MID and TID info. is only displayed in YESPay software version 2.2.4.2 upwards (which requires a KeyChange) and not 2.2.4.1 or earlier (which does not require a KeyChange). Once the KeyChange has been performed, re-register the MID and TID. Restart YesPay EasyVTerminal whilst the POS Till program is closed by double-clicking StartPOSServer.bat. Re-launch and log back into the POS Till program. Get the customer to try process another card payment transaction. Credit Cards: Yespay error ‘STSSerialPortException: javax.comm.NoSuchPortException.1’ When starting StartPOSServer, receive the above error Fix Check if PDQ is attached via USB and if so if it is a Verifone VX810/820, install the USB drivers and then ensure that EasyVTerminal setting have been set to correct COM port in Device Manager. Credit Cards: YesPay error ‘Invalid Key Index’ When trying to run EasyVTerminal, receive error ‘Invalid Key Index’ following KeyChange. Cause This is because there is a discrepancy between the key registered for that terminal on the YesPay server and that of which is registered on the POS terminal. Fix Any EVT version following 2.2.4.1 required a KeyChange for new software installs. Following a KeyChange and receiving ‘Invalid Key Index’ error when starting EVT would require you to copy the folder ‘\\\\svrcompany\\ftproot\\JTristem\\Merac\\YesPay\\CommonFiles.zip’ to C:\\YesEFT\\ on the Till and then unzip and overwrite the existing folders with its contents. Then restart EVT and provided the Card Machine is powered on and plugged into the correct COM port, should work! Credit Card: ACK – Problems Processing Card Payments from Till Card Payments failing on 1st payment attempt or all payment attempts at all Tills Problem Error received when first payment attempt is made: “Operation Failed - Card Declined” or “Please contact your bank to Authorize”. What to determine: Is the problem happening with multiple Tills or at multiple card machines? If yes, then it is likely that they have an ACK server setup or they could be experiencing network connectivity issues (i.e. no Internet connection). If it is determine that they are using ACK, then there could be a problem with Normal Polling. Some customers have a single Merac server and one or more ACK servers to spread the load on card transactions. Solution1 Log onto the ACK server and open Task Manager>>Processes tab>>click ‘Show all processes from all users’ and then locate and end process tree for wbtterm3.exe. Open Services snap-in and stop/start both ACK EFT Windows Socket Server and ACK EFT Node Encryption services, then restart Normal Polling. OR If the Company/Customer has more than one ACK server in their environment, first determine which ACK Server you are connected to:- Click Start>>Programs>>expand ACK EFT and then double-click ACK Maintenance Manager… Click Open button to view the contents of the xml file… Now click on Normal Polling in the taskbar to view the Normal Polling window and click Cancel button. Re-open the Normal Polling window from the taskbar and click Close button (Normal Polling is linked to wbtterm3.exe). Open Task Manager and end process for the following:- ECPWSSxxx.exe instances (two of them for ‘ACK EFT Windows Socket Server’ service) Nodesvr.exe (for ‘ACK EFT Node Encryption’ service) Open Services and restart ACK EFT Windows Socket Server and ACK EFT Node Encryption services. Re-open Normal Polling by double-clicking on the Normal Polling icon on the Desktop. Open the command prompt on the ACK server and enter the following sequence of commands to test that ACK is configured correctly to make payments online. The ACK software if configured correctly needs to communicating with the ACK Modem in order to dial out onto the telephone line. This dummy payment (using a non-existent card) is used to test a connection to the telephone line via the ACK Modem alone and does not actually connect to a bank… ******* You can also test that the ACK Modem connected to the server is able to dial out on the telephone line by opening the command prompt and then inserting the following series of commands: IMPORTANT: You must be in the Command mode of your communication software to use the AT commands +++ atdp (press Enter key) (above AT command instructs the Modem to use pulse dial to dial out to the given number) atdt (press Enter key) (above AT command instructs the Modem to use tone dial to dial out to the given number provided it is a touch-tone phone line) atd 9, (above AT command instructs the Modem to dial ‘9’ before dialling the given number) Syntax: ATD{dial modifier} 1234567 [Enter] ; = Resume command mode after dialling. If you need to dial a number that is too long to be contained in the command buffer (45 characters for the D command), use the semicolon (;) modifier to separate the dial string into multiple dial commands. All but the last command must end with the ; modifier. , = Pause While Dialling. The comma (,) dial modifier causes the modem to pause while dialling. The modem will pause the number of seconds specified in S-Register S8 and then continue dialling. If a pause time longer than the value in S-Register S8 needs to be used, it can be increased by either inserting more than one (,) in the dial command line or changing the value of S-Register S8. In the following example, the command accesses the outside (public) telephone line with the 9 dial modifier. Because the comma (,) dial modifier is present, the modem delays before dialling the telephone number 5551212. Example: ATD 9, 5551212 [Enter] ! = Using the Hook Flash. The exclamation point (!) dial modifier causes the modem to go on-hook (hang up) for one-half second and is equivalent to holding down the switch-hook on your telephone for one-half second. This feature is useful when transferring calls. W = Wait for a Subsequent Dial Tone. The W dial modifier causes a modem to wait for an additional dial tone before dialling the numbers that follow the W. The length of time the modem waits depends on the value in S-Register S7. The modem can be instructed to dial through Private Branch Exchanges (PBXs) or long-distance calling services that require delays during dialling. This can be done with the W command to wait for a secondary dial tone or with a comma (,) command to pause for a fixed time and then dial. Example: ATDT 9 W 12155551212 [Enter] A/ = Repeat. This command does not use the AT prefix nor does it require a carriage return to enter. Typing this command causes the modem to repeat the last command line entered, and is most useful for redialling telephone numbers that are busy. & Fn = Factory Defaults. This command (in which n=0 or 1) returns all parameters to the selected set of factory defaults if the modem has factory defaults; not all modems do. H = Hang Up. This command tells the modem to go \"on-hook,\" or disconnect, the telephone line. O = Online. This command returns the modem to the on-line mode and is usually used after the escape sequence (+++) to resume communication. Zn = Reset Modem. This command (in which n=0 or 1) resets the modem to the configuration profile stored in non-volatile memory location 0 or 1. ******* After pressing the Enter key, the ACKTGen Agent window opens. Click Generate button… Enter in a future Expiry Date (any)… Enter a dummy card security number (any)… Click on the Enter button and then click None button twice when asked to enter PostCode and House/Flat Number details. You should now see a connection being established with the bank if all is successful as seen below… Obviously you get an “Authorization failed…” error because the card does not exist. Now get the customer to test by taking a card payment at the Till from their end. Solution2 If the problem is just with one card machine plugged into a particular Till, it could be a Till configuration issue in Back Office>>Till Configuration. Ensure that the below is selected from ‘Credit Card Sys’ drop down. Then Recreate Till Data and Update the Till… Credit Card: ACK PDQ Credit Card Payments Failing – No ACK Receipt Printing When a credit card payment is made, if the system does not print an ACK receipt then nothing was sent to the server and therefore no payment was made. Customers could have a Merac server and one or more ACK servers. For customers using ACK, they should have two distinct modems:- 1)Sportster or USRobotics modem (used for Polling allowing the banks to dial in to poll the server). 2)Chiron 350 modem (used to seek live authorization). If a customer receives a Modem Timeout error when trying to make a payment, get the customer to try restart the Chiron modem or if during manual polling, you receive the following error – ‘Error establishing session. Function not valid right now’… …try restart the Sportster modem. Credit Card: ACK CashBack not working If Cash Back feature not working or available on Till running ACK, do the following: Log onto the Till in question and then run C:\\Program Files\\ACT\\EFT\\ACKTGen Click the Configuration tab and ensure that 'Cash Back' is enabled Open the command prompt and then run the following command:- xml2bin Wait a couple minutes and then get the Till operator to try again. Credit Card: Processing Card Payments from the Till – Card Payment Screen fails to load Problem When trying to process a card payment from the Till and pressing Sub-Total>>Credit Card button, receive handle error “PROGRAM ERROR in: FEPOS / DoCommand”. Invalid procedure call or argument for ‘Show Credit Card payment screen’”. See below… Cause and Solution The wizard has not yet detected that there are items in the basket so returns the above FEPOS / DoCommand error. To get around this, wait a few more seconds to allow the wizard to finish what it was doing to allow it to determine what is in the basket and then press the Credit button again and it should work. Credit Card: YesPay – YesEFT Configuration tampered Problem When running StartPOSServer.bat receive the following error message: “YESEFT Configuration tampered, Please re-run YesEFTConfig.bat and press OK”. Cause This normally happens if EasyVTerminal picks up any configuration changes in YesEFTConfig. Solution Open YesEFTConfig and ensure that settings are correct, then click Apply followed by OK and then close YesEFTConfig and try re-run StartPOSServer.bat. Note! Any single change within YesEFTConfig will over-write all contents of the C:\\YESEFT\\config folder with changes to the configuration. It should run now without any errors Credit Card: YesPay – YesEFTInterface error: Unable to load EFT Datasets Solution Contact YesPay and ask them to carry out a KeyChange. Credit Card : YesPay – YesEFTInterface or StartPOSServer: Port currently owneed by sts.xxxx.STSEMVTerminal.x Solution 1)First check that the PINPAD is connected securely to the POS Till and reboot the PINPAD. 2)Contact YesPay and ask them to carry out a KeyChange. Credit Card: YesPay – Payment Authorization failure message Problem If a YesPay Credit Card machine is not able to process payments (e.g. when attempting to process a payment, receive a message to contact your bank to authorize the payment). Troubleshooting Check the C:\\YesEFT\\YesEFTConfig.bat setup and Till Configuration. Also try terminate the javaw.exe background process and then initialize StartPOSServer.bat and then try process another payment. The C:\\YesEFT\\StartPOSServer.bat file should be placed in the Windows Startup folder. YesEFTConfig needs to be set to use COM3 and credit card device needs to be defined (e.g. VX810 or VX820). When Credit Card transactions are processed using YesPay, javaw.exe is the process that runs in the background on the Till to facilitate such transactions. If only one Till is effected by processing credit card payments, try connect to the Till and terminate javaw.exe on the Till and restart YesPay (you may need to run YesPay again and terminate it again). Credit Card: Credit Card Machine CHIP&PIN Working but not Swipe function First try and clean the Card Reader mechanism by using a fresh Card Machine cleaner (an enwrapped card coated with a special cleaning agent) to clean the swipe mechanism at the Till. If the device swipe mechanism is still not reading a card, swap the Credit Card machine with a known working one. – importantly to note whilst carrying out this procedure is that you take note of which ports each Card Machine is plugged into as the devices are fixed to these ports. You will need to restart the Till once the known working Card Machine is plugged into the Till. Credit Card: Verifone Ocius Setup – Cardholder Copy Receipts not printing correctly Problem When taking card payments at a terminal with Verifone Ocius software installed, two customer receipts are printed. One that includes the items purchased with hashed out Debit/Credit card details and another with a message stating “Unable to retrieve data”. Fix Basically, during the Verifone installation, the program.settings.ccf file which was configured to be located in the local Merac installation folder. This file was not copied to this location following the installation. Instead the file was located in the root (C:\\) which the user has no access to and the POS Till Program is now looking in the local Merac folder. Move this file to C:\\Program Files (x86)\\Merac. Credit Cards: Integrated Card Machines Payment Cancel Issue For Merac ver 3.15, if you attempt to cancel an integrated card payment for a booking from the Till, the transaction will be cancelled from the PDQ but Merac still registers the transaction but Payments table is not updated with detail of the transaction which would indicate that the transaction was paid for successfully – which is what we would expect but the transaction details are still updated within the Booking which makes it look like the Booking was paid for. Fix 1)Add button to POS Till - Command – “Disable Integrated CC’ 2)Recall Booking from Till and then refund the booking. 3)Turn on Integrated Card Payments again by reconfiguring the button using – Command “Enable Integrated CC”. 4)Advise the customer to attempt to take the Customer Not Present payment again. Problem with the above is that Merac now thinks that no payment was taken for the booking because if you follow steps 2) and 3) at the same amount, they balance each other out which in effect means nothing was paid towards the booking as far as Merac is concerning even though by pressing the command buttons below we know that ther customer has charged the card correctly. To fix this you would need to delete all offending transactions from the database! Credit Cards: Corrupted Log Files causing issues taking card payments Corrupt Log files causing issues with taking card payments but this would need to be verified by Yespay/Worldpay. Steps taken to un-corrupt/refresh Yespay log files: 1. Close Easy V terminal application if running. 2. Go to C:\\YESEFT\\conf 3. Rename YESEFTTransactionLog.xml file as BackupYESEFTTransactionLog.xml. 4. Make a copy of YESEFTTransactionLog-Empty.xml file and rename as YESEFTTransactionLog.xml. 5 Rename YESEFTTransactionLog-tmp.xml file as BackupYESEFTTransactionLog-tmp.xml 6. Make a copy of YESEFTTransactionLog-Empty.xml file and rename as YESEFTTransactionLog-tmp.xml. 7. Initialize Easy V terminal twice then try to perform a transaction and share the result. 8. Send us the backup copy of transaction log so we can check if there is any pending transaction to upload. HHA Error – There is some missing data for the membership When scanning an HHA membership card from the POS Terminal, if the below error appears. Verify that mandatory information is included in the setup in the HHA Member details. In the below example, System Options does not have any mandatory data required per membership setup… MeracData share drive mapping error using UNC path Membership Card missing data error at POS Till MeracUpdater customer notification message – MeracUpdater not working on a Merac Client Sent from BlueMail On 11 May 2017, at 03:20, customer notification > wrote: 11 May 2017 03:20:40 2017/05/11 03:20:40 - Error in clsSQLFunctions:GetScalarValue - Desc:A transport-level error has occurred when receiving results from the server. (provider: TCP Provider, error: 0 - The specified network name is no longer available.) SQL:SELECT isnull(upcForceUpdateNextCheck,0) as upcForceUpdateNextCheck FROM updateclient WHERE upcComputerName=@ComputerName Date 11 May 2017 03:20:40 Customer Name Nottingham Castle Computer Name NCM-NOTTS-P2 IP Address 192.168.1.231 AppName MeracUpdater AppMeracConnStrName Server=81.174.163.111,14339;database=MStore;uid=applogin;pwd=VB6 Fix Select * from updateclient to workout what till it is. Remotely connect and clear Event Viewer logs from Windows and then replace Meracupdater. Till: Unable to launch the POS Till program When trying to run the till program, receive PMStore TXRead error. =================================================================== Date and Time: 24 May 2017 14:37:34 Operator: Error Source: PMStore Form/Object: CDrawer Sub/Function: TillXRead =================================================================== ----------------------------------------------------- Error 91 -------------------------------------------------------- Object variable or With block variable not set =================================================================== Troubleshooting Open up a new cashdraw and ZRead. Compare the three files created on the new cashdraw with the cashdraw transaction files experiencing the issue to identify what the cause of the issue is. It would normally be something in the opening record that is causing the issue. May want to check if the userid used to open the cashdraw which appears in the opening record of the transaction file exists in the tills local MeracDat.txt file EMP line. Workaround If the user account id does not exist, readme the id in the opening record to our Merac id ‘100’.",
    "category": "INTERNAL Support Articles",
    "folder": "2017 Support Documents",
    "created_at": "2023-06-20T17:13:07+01:00",
    "updated_at": "2023-12-22T09:38:43+00:00",
    "status": 2,
    "tags": [],
    "description": "<p><a class=\"Hyperlink SCXW245259517 BCX0\" href=\"onenote%3A#2017%20Notes%20on%20Merac%20Trouble%20Shooting&amp;section-id={0CED2557-2827-4C76-A491-95F9CD8189E7}&amp;page-id={BCBBE53F-F11A-4A1C-A6CE-F580401B6D09}&amp;end&amp;base-path=https%3A//axk3btg.sharepoint.com/sites/SDSupport/Shared%20Documents/General/Knowledge%20and%20Training/Support%20Product%20Knowledge%20Base/MStore.one\" rel=\"noreferrer noopener\" style=\"margin: 0px; padding: 0px; user-select: text; -webkit-user-drag: none; -webkit-tap-highlight-color: transparent; cursor: text; text-decoration: none; color: inherit;\" target=\"_blank\"></a></p><p dir=\"ltr\">&nbsp;</p><h1>Table of Contents</h1><p><a href=\"#_POS_Till__1\"><strong>POS Till</strong></a></p><p><a href=\"#_POS_Till%3A_Error\">POS Till: Error when launching POS Till program from shortcut on Desktop for Training Till 999</a></p><p><a href=\"#_POS_Till%3A_Till\">POS Till: Till Data Load Error – ‘Critical Error: Failed to load till data‘</a></p><p><a href=\"#_POS_Till%3A_Till_1\">POS Till: Till taking a long time to load – Stuck on ‘Loading Till Data’ message</a></p><p><a href=\"#_POS_Till%3A_Unable\">POS Till: Unable to Recreate Till Data</a>&nbsp; &nbsp;&nbsp;</p><p><a href=\"#_POS_Till%3A_Old\">POS Till: Old Data File Notification Message received when a Till is turned on &nbsp; &nbsp;</a></p><p><a href=\"#_POS_Till%3A_Till_2\">POS Till: Till Transactions stuck in Holding Table</a></p><p><a href=\"#_POS_Till%3A_Till_3\">POS Till: Till Transactions – Holding Table PDBUpdater Error Message</a>&nbsp;</p><p><a href=\"#_POS_Till%3A_Unable_1\">POS Till: Unable to Open Till/CashDraw</a>&nbsp;</p><p><a href=\"#_POS_Till%3A_Unable_2\">POS Till: Unable to ZRead a Till</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p><a href=\"#_POS_Till%3A_Unable_3\">POS Till: Unable to Clear Data on Till following Merac Server going offline</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p><a href=\"#_POS_Till%3A_ExecuteNonQuery%3A\">POS Till: ExecuteNonQuery: Error converting data type float to decimal</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p><a href=\"#_POS_Till%3A_Two\">POS Till: Two of the same Till Numbers are open using the same Draw Number Fix</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p><a href=\"#_POS_Till%3A_Till_4\">POS Till: Till X, Cash Draw Y appending multiple Open entries in TXNS file</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p><a href=\"#_POS_Till%3A_%E2%80%98Insert\">POS Till: ‘Insert Header Till_Draw Subquery returned more than 1 value’ error</a> &nbsp;</p><p><a href=\"#_POS_Till%3A_Open\">POS Till: Open Cash Draw not appearing from POS Till</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p><a href=\"#_POS_Till%3A_Startup\">POS Till: Startup Error – ‘Error Accessing Line Display’</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p><a href=\"#_POS_Till%3A_Customer\">POS Till: Customer Line Display (CLD) not working</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p><a href=\"#_POS_Till%3A_Description\">POS Till: Description Incorrect for Items Sold at the Till</a>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p><a href=\"#_POS_Till%3A_Wrong\">POS Till: Wrong Payment made for a Booking</a>&nbsp; &nbsp; &nbsp; &nbsp;</p><p><a href=\"#_POS_Till%3A_Over\">POS Till: Over Payment Showing in Booking when using Payment Method Voucher</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p><a href=\"#_POS_Till%3A_error_1\">POS Till: Error ‘SellCurrentItem - Object variable or With block variable not set’</a>&nbsp;</p><p><a href=\"#_POS_Till%3A_MStore\">POS Till: MStore Program Error- CApp ‘Object variable or With Block variable not set’</a>&nbsp; &nbsp; &nbsp;&nbsp;</p><p><a href=\"#_POS_Till%3A_PLU\">POS Till: PLU Sell Item error - “Object variable or with block variable not set”</a>&nbsp; &nbsp;&nbsp;</p><p><a href=\"#_POS_Till%3A_CDraw/XRead\">POS Till: CDraw/XRead program error - “Object variable or with block variable not set” &nbsp; &nbsp;</a></p><p><a href=\"#_POS_Till%3A_Physical\">POS Till: Physical Cash Draw not Opening</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p><a href=\"#_POS_Till%3A_Customer_1\">POS Till: Customer Search (‘Find Member’ command button from Till) not returning results on Till</a> &nbsp;</p><p><a href=\"#_POS_Till%3A_Till_5\">POS Till: Till ‘Reprint Receipt/Reprint Journal/Till Roll’ showing blank receipt details</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p><a href=\"#_POS_Till%3A_Receipt\">POS Till: Receipt Blank on Till</a></p><p><a href=\"#_POS_Till%3A_Till_6\">POS Till: Till Transactions Missing in DTA</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p><a href=\"#_POS_Till%3A_Printing\">POS Till: Printing and Barcode Scanning – Error occurred in calling the CheckHealth method</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p><a href=\"#_POS_Till%3A_Barcode\">POS Till: Barcode Scanner not scanning a barcode</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p><a href=\"#_POS_Till%3A_Scanning\">POS Till: Scanning Barcodes – ‘Item not found’ error</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p><a href=\"#_POS_Till%3A_Casio\">POS Till: Casio Barcode Handheld Scanner error – ‘Item not found’</a>&nbsp; &nbsp; &nbsp;</p><p><a href=\"#_POS_Till%3A_Honeywell\">POS Till: Honeywell PDA Handheld stuck on ‘Setting up device. Please wait…’ whilst not connected to the dock</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p><a href=\"#_POS_Till%3A_Logitech\">POS Till: Logitech USB Camera Freezing Intermittently</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p><a href=\"#_POS_Till%3A_Cash\">POS Till: Cash Draw opening when cancelling a Transaction&nbsp;</a></p><p><a href=\"#_POS_Till%3A_Till_7\">POS Till: Till not prompting to take a Photo of Existing Member when Membership Card Swiped</a>&nbsp; &nbsp; &nbsp;</p><p><a href=\"#_POS_Till%3A_MStoreUpdater\">POS Till: MStoreUpdater or MeracUpdater not updating Merac system files</a>&nbsp; &nbsp; &nbsp;&nbsp;</p><p><a href=\"#_Till_receiving_error\">POS Till: Receiving error that unable to access Photo folder for Memberships</a>&nbsp; &nbsp;&nbsp;</p><h2><a href=\"#_POS_Till%3A_More\">POS Till: More than one Voucher not Printing at Till</a></h2><p><strong>Bookings&nbsp;</strong></p><p><a href=\"#_Bookings%3A_Booking_Error\">Bookings: Booking Error – Invalid use of NULL error</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p><a href=\"#_Bookings%3A_Error_Re-Calling\">Bookings: Error Re-Calling Bookings from Till – “Item cannot be found in the collection corresponding to the requested name or ordinal”</a></p><p><a href=\"#_Bookings%3A_Error_Saving\">Bookings: Error Saving Bookings from Back Office – “Item cannot be found in the collection corresponding to the requested name or ordinal”</a>&nbsp; &nbsp;</p><p><a href=\"#_Booking%3A_Taking_Booking\">Booking: Taking Booking Deposits from the POS Till</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p><a href=\"#_Bookings%3A_Deposit_added\">Bookings: Deposit added to wrong Booking</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p><a href=\"#_Bookings%3A_Booking_Confirmation\">Bookings: Booking Confirmation Letters not opening</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p><a href=\"#_Bookings%3A_Online_Booking\">Bookings: Online Booking Payment Issue - Payment Setup Correctly in Back Office but not at the Till</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p><a href=\"#_Bookings%3A_Booking_Confirmation_1\">Bookings: Booking Confirmation Letter Empty following Internet Booking Detail Change</a> &nbsp;</p><p><a href=\"#_Bookings%3A_Block_Bookings\">Bookings: Block Bookings not showing in the Diary</a></p><h2><a href=\"#_Bookings%3A_Price_Different\">Bookings: Price Different when recalling a Booking to the POS Till&nbsp;</a></h2><p><strong>Sessions &nbsp;</strong></p><p><a href=\"#_Sessions%3A_Sessions_and\">Sessions: Sessions and Bookings – Unable to Delete Session/Tours</a>&nbsp; &nbsp; &nbsp;</p><p><a href=\"#_Sessions%3A_Seat_Number\">Sessions: Seat Number Not Visible when Creating Sessionable Bookings</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p><a href=\"#_Sessions%3A_Session_Type\">Sessions: Session Type not displaying correct Availability</a></p><p><a href=\"#_Moving_a_Session\">Moving a Session from one time slot to another from Back Office error &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</a></p><p><strong>Footfall &nbsp;&nbsp;</strong></p><p><a href=\"#_Footfall%3A_Recorded_on\">Footfall: Recorded on the wrong Date for a given Till</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p><strong>Promotions</strong>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p><a href=\"#_Promotions%3A_Promotion_Save\">Promotions: Save error – SavePromItems:’Violation of PRIMARY KEY constraint'</a></p><p><strong>Printing &nbsp;&nbsp;</strong></p><p><a href=\"#_Printing%3A_Ticket_printer\">Printing: Ticket printer fails to print</a>&nbsp; &nbsp; &nbsp; &nbsp;</p><p><a href=\"#_Printing%3A_BOCA_Ticket\">Printing: BOCA Ticket Printer printing blank tickets</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p><a href=\"#_Printing%3A_Barcode_Labels\">Printing: Barcode Labels not printing</a>&nbsp; &nbsp; &nbsp;</p><p><a href=\"#_Printing%3A_Barcodes_Printing\">Printing: Barcodes Printing Issue - Epson TM-L90 appending a ‘0’ to the beginning of an EAN13 barcode</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p><a href=\"#_Printing%3A_Unable_to\">Printing: Unable to print to a Network Printer</a>&nbsp; &nbsp; &nbsp;&nbsp;</p><p><a href=\"#_Printing%3A_Unable_to_1\">Printing: Unable to print Receipts from Tills screen in Back Office. ‘Invalid use of NULL’ error</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p><a href=\"#_Printing%3A_Failed_to\">Printing: Failed to claim OPOS Receipt Printer</a>&nbsp; &nbsp; &nbsp; &nbsp;</p><p><a href=\"#_Printing%3A_Permissions_error\">Printing: Permissions error when trying to print a Purchase Order</a>&nbsp; &nbsp; &nbsp;&nbsp;</p><p><strong>Accounts/Customers &amp; Memberships &nbsp;</strong></p><p><a href=\"#_Memberships%3A_Unable_to\">Accounts|Customers|Memberships: Unable to Void New Member entered through Till</a> &nbsp;</p><p><a href=\"#_Memberships%3A_GiftAid_Signature\">Accounts|Customers|Memberships: GiftAid Signature outside of MinMax Date Range</a></p><h2><a href=\"#_Accounts%7CCustomers%7CMemberships%3A_Una\">Accounts|Customers|Memberships: Unable to add new Contacts to a Customer Account</a></h2><p><strong>Reports</strong></p><p><a href=\"#_Reports%3A_Error_%E2%80%93\">Reports: Error – Failed to retrieve data from the database</a> &nbsp;</p><p><a href=\"#_Reports%3A_Error_%E2%80%93_1\">Reports: Error – ‘FRepParams / ExportData error’</a>&nbsp;</p><p><a href=\"#_Reports%3A_Error_%E2%80%93_2\">Reports: Error – ‘One or more fields could not be found in the result set. Use verify database to update the report’</a>&nbsp; &nbsp; &nbsp; &nbsp;</p><p><a href=\"#_Reports%3A_Update_Reports\">Reports: Update Reports</a></p><p><a href=\"#_Reports%3A_Crystal_Reports\">Reports: Crystal Reports .rpt File Not Found error</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p><a href=\"#_Reports%3A_Export_Error\">Reports: Export Error - ODBC driver does not support the requested properties</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p><a href=\"#_Reports%3A_Unable_to\">Reports: Unable to run any Reports - Returning SQL error – FRepParams/InvokeRepParams</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p><a href=\"#_Reports%3A_Reports_taking\">Reports: Reports taking a long time to load and display</a>&nbsp; &nbsp; &nbsp; &nbsp;</p><p><a href=\"#_Reports%3A_Very_slow\">Reports: Very slow when running any Reports</a>&nbsp; &nbsp; &nbsp;&nbsp;</p><p><a href=\"#_Reports%3A_Back_Office\">Reports: Back Office crash following running a report for version 3.14</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p><a href=\"#_Reports%3A_Data_Extract\">Reports: Data Extract error or Report error – Subscript out of range</a>&nbsp; &nbsp;</p><p><a href=\"#_Reports%3A_Seating_Plan\">Reports: Seating Plan Report returning an error</a></p><p><a href=\"#_Reports%3A_Determining_Discrepancy\">Reports: Determining Discrepancy with FootFall Analysis Report and Actual Footfall</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p><a href=\"#_Reports%3A_Promotions_report\">Reports: Promotions report – duplicate Promotion Descriptive Names</a></p><p><a href=\"#_Report%3A_Export_button\">Reports: Export button greyed out on the Parameters window</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p><strong>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</strong><a href=\"#_Reports%3A_Report_not\">Reports: Report not importing correctly</a></p><p><strong>Data Extracts &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</strong></p><p><a href=\"#_Data_Extract%3A_Mailing\">Data Extract: Mailing Extract Error – The object invoked has disconnected from its client</a></p><p><strong>GiftAid &nbsp; &nbsp;</strong></p><p><a href=\"#_GiftAid%3A_Claim_Submission\">GiftAid: Claim Submission Failing</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p><a href=\"#_GiftAid_Claim_Submissions\">GiftAid Claim Submissions Error - Unable to submit GiftAid Claims</a>&nbsp; &nbsp; &nbsp;</p><p><a href=\"#_GiftAid_Write_Submission\">GiftAid Write Submission Error</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p><a href=\"#_GiftAid%3A__Declarations\">GiftAid: &nbsp; Declarations Report hanging</a>&nbsp; &nbsp;&nbsp;</p><p><a href=\"#_GiftAid%3A_%E2%80%98Divisible_by\">GiftAid: ‘Divisible by zero’ SQL Statement function error</a>&nbsp; &nbsp; &nbsp;&nbsp;</p><p><a href=\"#_GiftAid%3A_PLU_View/Add\">GiftAid: PLU View/Add Price showing GiftAidable Claimable Amount not equal to 10% as System Options defines</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p><a href=\"#_GiftAid%3A_Fix_Taxing\">GiftAid: Fix Taxing on GiftAidable items</a>&nbsp;</p><p><a href=\"#_GiftAid_%E2%80%93_GiftAid\">GiftAid – GiftAid Conversion report not matching entries in the GiftAid Claim Submissions list</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p><strong>Back Office &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</strong></p><p><a href=\"#_Back_Office%3A_Unable\">Back Office: Unable to run ‘Recreate Till Data’ - receive error: Unable to connect to MeracUpdater service</a>&nbsp; &nbsp;&nbsp;</p><p><a href=\"#_Back_Office%3A_Merac\">Back Office: Merac Back Office Installation Troubleshooting</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p><a href=\"#_Back_Office%3A_Login\">Back Office: Login Update Notification Message</a>&nbsp; &nbsp;</p><p><a href=\"#_Back_Office%3A_Merac_1\">Back Office: Merac Back Office software Out-Of-Date Error</a>&nbsp;</p><p><a href=\"#_Back_Office%3A_Computer\">Back Office: Computer not able to communicate with the Merac Server</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p><a href=\"#_Back_Office%3A_Trying\">Back Office: Trying to adjust a PLU sell value returns message to specify a Price Matrix</a>&nbsp; &nbsp; &nbsp;</p><p><a href=\"#_Back_Office%3A_Selling\">Back Office: Selling of Session Tickets not displaying correct Num QTY in Back Office</a>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p><a href=\"#_Back_Office%3A_Files\">Back Office: Files not Updating when MeracUpdater runs</a>&nbsp; &nbsp;&nbsp;</p><p><a href=\"#_Back_Office%3A_Creating\">Back Office: Creating a new Lookup Item “Violation of PRIMARY KEY constraint” Error</a>&nbsp; &nbsp; &nbsp;&nbsp;</p><p><a href=\"#_Back_Office%3A_Stock\">Back Office: Stock Entry Duplicate Primary Key error</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p><a href=\"#_Back_Office%3A_Unable_1\">Back Office: Unable to Move Stock from ‘Unknown Stock Location’ to known Stock Location</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p><a href=\"#_Moving_Stock_from\">Back Office: Moving Stock from deleted Stock Location to known undeleted Stock Location</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p><a href=\"#_Back_Office%3A_Forecasts\">Back Office: Forecasts Information not updated correctly for Footfall</a>&nbsp;</p><p><a href=\"#_Back_Office%3A_Mailing\">Back Office: Mailing Export/MailMerge to MS Excel/Word error</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p><a href=\"#_Back_Office%3A_Error\">Back Office: Error when attempting to Clone an existing Receipt or Ticket Design</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p><strong>Debit/Credit Cards&nbsp;</strong></p><p><a href=\"#_Credit_Cards%3A_Card\">Credit Cards: Card Machines Down</a>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p><a href=\"#_Credit_Card%3A_Unable\">Credit Card: Unable to take Card Payments – Till Offline</a>&nbsp; &nbsp; &nbsp;&nbsp;</p><p><a href=\"#_Credit_Card%3A_YesPay\">Credit Card: YesPay Error – “Transaction Failed: Declined offline. Please take alternative payment”</a>&nbsp;</p><p><a href=\"#_Credit_Card%3A_Unable_1\">Credit Card: Unable to read Debit/Credit cards when swiped through the Till PDQ Card Reader</a>&nbsp; &nbsp; &nbsp; &nbsp;</p><p><a href=\"#_Credit_Card%3A_ChipnPIN\">Credit Card: Chip&amp;PIN not working</a>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p><a href=\"#_Credit_Card%3A_YesPay/WorldPay\">Credit Card: YesPay/WorldPay – CashBacks not working</a>&nbsp; &nbsp; &nbsp;&nbsp;</p><p><a href=\"#_Credit_Card%3A_YesPay_1\">Credit Card: YesPay - Card Refunds using EasyVTerminal version 3445</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p><a href=\"#_Credit_Card%3A_YesPay_2\">Credit Card: YesPay - Card Payment failure as a result of Till going Offline</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p><a href=\"#_Credit_Card%3A_Polling\">Credit Card: Polling Query following moving from ACK to YesPay</a>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p><a href=\"#_Credit_Cards%3A_Ocius\">Credit Cards: Ocius Sentinel – ‘Check for Pinpad’ message from Ocius Sentinel window</a>&nbsp; &nbsp;&nbsp;</p><p><a href=\"#_Credit_Cards%3A_Ocius_1\">Credit Cards: Ocius Sentinel not detecting Device on COM Port</a></p><p><a href=\"#_Credit_Card%3A_Verifone\">Credit Card: Verifone Ocius Setup – Cardholder Copy Receipts not printing correctly</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p><a href=\"#_Credit_Cards%3A_YesPay\">Credit Cards: YesPay – EasyVTerminal Startup Issues</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p><a href=\"#_Credit_Cards%3A_YesPay_1\">Credit Cards: YesPay error ‘Invalid Key Index’</a>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p><a href=\"#_Credit_Card%3A_ACK\">Credit Card: ACK – Problems Processing Card Payments from Till</a>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p><a href=\"#_Credit_Card%3A_ACK_1\">Credit Card: ACK PDQ Credit Card Payments Failing – No ACK Receipt Printing</a>&nbsp; &nbsp;</p><p><a href=\"#_Credit_Card%3A_ACK_2\">Credit Card: ACK CashBack not working</a>&nbsp;</p><p><a href=\"#_Credit_Card%3A_Processing\">Credit Card: Processing Card Payments from the Till – Card Payment Screen fails to load</a> &nbsp;</p><p><a href=\"#_Credit_Card%3A_YesPay_3\">Credit Card: YesPay – YesEFT Configuration tampered</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p><a href=\"#_Credit_Card%3A_YesPay_4\">Credit Card: YesPay – YesEFTInterface error: Unable to load EFT Datasets</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p><a href=\"#_Credit_Card_%3A\">Credit Card : YesPay – YesEFTInterface or StartPOSServer: Port currently owned by sts.xxxx.STSEMVTerminal.x</a></p><h2><a href=\"#_Credit_Cards%3A_Yespay_2\">Credit Cards: Yespay error ‘STSSerialPortException: javax.comm.NoSuchPortException.1’</a></h2><p><a href=\"#_Credit_Card%3A_YesPay_5\">Credit Card: YesPay – Payment Authorization failure message</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p><a href=\"#_Credit_Card%3A_Credit\">Credit Card: Credit Card Machine CHIP&amp;PIN Working but not Swipe function</a>&nbsp; &nbsp; &nbsp;</p><p><a href=\"#_Credit_Cards%3A_Integrated\">Credit Cards: Integrated Card Machines Payment Cancel Issue</a></p><p><a href=\"#_Credit_Cards%3A_Corrupted\">Credit Cards: Corrupted Log Files causing issues taking card payments</a></p><p>&nbsp;</p><p>&nbsp;</p><h1>POS Till &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h1><h2>&nbsp;</h2><h2>POS Till: Error when launching POS Till program from shortcut on Desktop for Training Till 999 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</h2><p>If you try and launch a training Till (i.e. 999) from a Merac Back Office computer or POS Till and receive the below error message…</p><p>&nbsp;</p><p>&nbsp;<img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031237548/original/5l5L1vV2pQXwFi5Tlr5Pxr2UxWrouxSaZw.png?1687276621\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031237548\"></p><p>&nbsp;</p><p><strong>Solution</strong></p><p>You can only launch the training Till from Back Office by clicking on <strong>POS</strong></p><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>\\\\&lt;ServerName\\&lt;MeracData_ShareName&gt;\\Formats</strong></p></td></tr></tbody></table><p>&nbsp; icon in the top toolbar.</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031237551/original/1TnR6yN8s1G4hm4NziN3iZC-cSaDUqZTew.png?1687276621\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031237551\"></p><p>&nbsp;</p><h2>POS Till: Till Data Load Error – ‘Critical Error : Failed to load till data’ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><h2>Problem</h2><p>When attempting to load Till 999, the screen prompt to change the resolution is displayed and when you click <strong>OK</strong> the window disappears and the Till fails to load.&nbsp;</p><p>When you attempt to load any other Till on the network following making Back Office changes, you receive the following error and the Tills fail to load…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031237546/original/62zISPp3qYCK76WIlvAiO-M95bT_rMVfMA.png?1687276621\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031237546\"></p><p>&nbsp;</p><p>Check the contents of the MeracDat.txt file on any Till reporting the error (e.g. check for any inconsistency in LKU records within the file by matching them with contents of Lookups table in SQL etc.) and then check all LKU records to see if there is an inconsistency in the data.</p><p>If you find an LKU line entry that contains an error, FIX IT.</p><p>Recreate Till Data and Update all Tills.</p><p>This should fix the issues experienced loading Till Data.</p><p>&nbsp;</p><p>OR</p><p>&nbsp;</p><p><strong>Problem</strong></p><p>When loading the POS Till program, if you receive the below error, this could mean that the MeracDat.txt file could be corrupted or the Till does not exist in Back Office&gt;&gt;Till Configuration…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031237547/original/za99KdkgyyJXNZYDoWE94kd9bMLhCLxOLQ.png?1687276621\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031237547\">&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p><strong>&nbsp;</strong></p><p><strong>Fix</strong></p><p>Rename the original MeracDat.txt file stored locally and then re-run the POS Till program. This process with pull down a fresh copy of the MeracDat.txt file from the server.</p><p>OR</p><p>Check that the actual Till exists that you are attempting to open from Till Configuration.</p><p>&nbsp;</p><h2>POS Till: Till taking a long time to load – Stuck on ‘Loading Till Data’ message &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031237554/original/vH70x8JSjkQofCaTAzLGtDXfWhLw0GPhSA.png?1687276621\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031237554\"></p><p><strong>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</strong></p><p>If the computer/Till is part of a WORKGROUP environment and the server is part of a domain environment, this is likely the reason for the Till program not loading. The problem is aimed specifically at a domain authentication issue. You will find that browsing to the \\\\&lt;ServerName&gt;\\MeracData share does not work as credentials are required to connect to the share.</p><p><strong>Solution</strong></p><p>Open the command prompt and navigate to C:\\Program Files (x86)\\Merac or C:\\Program Files\\Merac and run the following command:-</p><p><strong><em>mstoreupdater –password</em></strong>&nbsp;</p><p>Enter the MeracData network share UNC path, Username and Password and then click <strong>Update to MStore.ini</strong> button</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031237545/original/SOjem3LzVo6O30Xj16AvWNIJeXYdBrDNTg.png?1687276621\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031237545\"></p><p>&nbsp;</p><p>This process will append an encrypted HASHKEY to the end of the ini file used to authenticate when the client attempts to connect to the server which is part of a domain. This is required when the Till is part of a Workgroup and the Merac server is part of a domain.</p><p>When you launch the POS Till and the Till detects the server online, it tries to query the server MeracData share to verify contents of the MeracData/Formats folder files using these credentials saved as an encrypted key. If the Till fails to receive a response, this results in the Till program failing to load.</p><p>&nbsp;</p><p>Note!</p><p>Any changes to the Merac Back Office system through <strong>Edit Config</strong> will cause this encrypted password appended to the end of the MStore.ini file to be removed.</p><p>&nbsp;</p><p><strong>Solution</strong></p><p>First check that the Till has enough memory</p><p>Then check that the MeracDat.txt file has an ‘End-Of-File’ marker appended to the end of the file to make sure it is not corrupt.</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031237556/original/FGsm56OjK4oGCUh8S2NpcGYT8PjLI3IYtQ.png?1687276621\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031237556\"></p><p>&nbsp;</p><p>Make sure you can browse to the MeracData share using the UNC path \\\\&lt;MeracServer&gt;\\MeracData\\</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If you cannot, then re-create the encrypted key in the ini file.</p><p>Run MstoreUpdater.exe to rebuild the MeracDat.txt file and then try re-launch the POS Till.</p><p>&nbsp;</p><p>Note!</p><p>The usual issue causing this would be the fact that the customer has a lot of Stock items that the POS Till is loading from the meracdat.txt file which is why it is taking a lot of time to load. Would advise the customer to delete out old Stock Items no longer in use.</p><p>&nbsp;</p><h2>POS Till: Unable to Recreate Till Data &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>Problem</strong></p><p>Receive SQL ‘RecreateTillData’ statement error when attempting to Recreate Till Data from a Merac Back Office computer or POS Till.&nbsp;</p><p>When you make changes on a Merac Back Office computer or POS Till and then attempt to Recreate Till Data from that device, the system attempt to write the changes immediately to its local MeracDat.txt file which is why you do not need to run Update to allow that device to pick up any changes made. For this to work correctly, ‘Full Access permission’ is required to the local Merac installation folder. It then copies the changes to the server MeracData share MeracDat.txt file which will allow all other Tills to pick up any changes made following running an Update. For the changes to be copied to the server copy MeracDat.txt file, full access to the server is required. If an authentication prompt is received when trying to browse to the server MeracData share, this is the reason why Recreate Till Data is returning an error.</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031237550/original/R5vc3Re1N_e4e7kyoCkEy8_NAoxeU3b1mQ.png?1687276621\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031237550\"></p><p>&nbsp;</p><p><strong>Solution</strong></p><p>Check permissions to local Merac installation folder.</p><p>If the Till is part of a Workgroup and the server a domain, it is likely that if you browse to the server MeracData share using the UNC path, you will be prompted to enter in a <em>Username</em> and <em>Password</em> to authenticate.&nbsp;</p><p>&nbsp;</p><ol><li>For BO 3.14, if the Till is added to a WORKGROUP, navigate to C:\\Program Files (x86)\\Merac or C:\\Program Files\\Merac and open command prompt as admin and run <strong>mstoreupdater.exe /password</strong>. Then<strong>&nbsp;</strong>enter the domain credentials to authenticate and connect to the server as seen below and then click <strong>Update to MStore.ini</strong> button…</li></ol><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031237544/original/E_pNrxlfmdEbhWI9K8n3Z40lVdXwHMt-2g.png?1687276621\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031237544\"></p><p>&nbsp;</p><p>OR</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031237553/original/I15v5a6EdxxLZ0ZRXyD4esMW8moPW8AzWg.png?1687276621\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031237553\"></p><p>&nbsp;</p><p>This process will append an encrypted hash key to the end of the ini file used to authenticate when the client attempts to connect to the server which is part of a domain. This is required when the Till is part of a Workgroup and the Merac server is part of a domain.</p><p>&nbsp;Copy PMStore.exe, PMBOS.exe and MStoreUpdater.exe from the server to the local Merac installation directory and run MStoreUpdater.exe.</p><p>&nbsp;</p><ol><li>If BO 3.14 or 3.15 and Till is added to the domain, browse to the server using the UNC path and if asked to enter authentication details, insert these and ensure you tick the box the remember credentials.&nbsp;</li></ol><p>&nbsp;</p><p>Now try Recreate Till Data again and it should work.</p><p>&nbsp;</p><h2>POS Till: Old Data File Notification Message received when a Till is turned on &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p>When we started up a Till, if the Till operator receives a pop up saying “The data file is over ‘x’ days old, you may still use it but please inform a supervisor”, this is normal. &nbsp;</p><p>The Till purposely notifies you if the age of the Till’s data file (MeracDat.txt) is older than x days. &nbsp;Specifically it does this as an alert in case the Till isn’t updating from the network correctly.&nbsp;</p><p>To get rid of this notification message, simply get the customer to Recreate Till Data and then from the ‘Three-Button/Four-Button’ program, press the <strong>Update</strong> button so that the next time the POS Till is opened, the message will no longer be displayed.</p><p>&nbsp;</p><p>This notification refers to its local copy MeracDat.txt file version. It is likely that the server copy is also out-of-date, so to fix the issue, from Back Office&gt;&gt;Recreate Till Data to over-write the server copy MeracDat.txt file (for version 3.14) with its local copy which will allocate the clients local copy timestamp to the server copy. Press the <strong>Update</strong> button on all Tills ensure that all Tills pick up any new changes.</p><p>&nbsp;</p><h2>POS Till: Till Transactions stuck in Holding Table &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>Troubleshooting</strong></p><p>Log onto the Merac server and check that PDBUpdater service is running. If it is and there are no errors in the Holding Table, then examine the “<em>Connection String</em>” in the below file and ensure the details are correct…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031237549/original/xa7T76H7Mu1y-jj91m5XRpakYhEu5IjkSg.png?1687276621\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031237549\"></p><p>&nbsp;</p><h2>POS Till: Till Transactions – Holding Error: TXH-Cash Drawer &nbsp;X on Till Y is not opened &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</h2><p><strong>Problem&nbsp;</strong></p><p>Transactions stuck in the Holding Table. PDBUpdater error message – Cash Draw ‘X’ on Till ‘Y’ is not opened.</p><p>e.g. error - PDBupdater-2,999,16,TristemLtd,Failed&lt;BR&gt;&lt;BR&gt;Cash Drawer &nbsp;999 on Till 2 is not opened</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031237570/original/X7pm2eMLtXPTWgVC6waQVY50dsXYkA6uTA.png?1687276621\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031237570\"></p><p>&nbsp;</p><p>‘<strong>ttnStatus</strong>’ displays details on whether an error occurred or not with any transactions posted to the server to be processed. Any error reported would prevent all other transactions from being processed and uploaded to SQL. Ideally if all is ok, the Holding Table should be empty provided no other transactions are being sent by Tills to the Merac server. ‘<strong>ttnErrorMessage</strong>’ displays details about the error.</p><p>&nbsp;</p><p><strong>Cause</strong></p><p>The error is caused when the Till is closed for that Cash Draw from Back Office and the Till has not been Zread (i.e. the CashDraw has either been F2ed OR &nbsp;</p><p>In this situation the Cash Draw has not been closed locally using ZRead and so if the Till operator logs back into the Till, he/she will still be able to take transactions from the Till with the given Draw number.&nbsp;</p><p>&nbsp;</p><p>To get around this you could create an opening record in the Holding Table, clear out all Holding Table error messages and once all transactions have been successfully uploaded to the server, ‘F2’ the Till and then archive the local transaction files without ZReading the Till.</p><p>&nbsp;</p><p>Because the Till has been closed from the Back Office side, the CashDraw table marks the Till/CashDraw as closed and so transactions will get stuck in the Holding Table and are unable to flow through to be processed.</p><p>(closing the Till from the Back Office sets the Till and CashDraw in the CashDraw table with a status of ‘C’ which means any pending transactions sitting in the Holding Table will <u>not</u> be processed).</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031237567/original/eyaVkk6hsrgFb8yk89IJxLZWV53p0ty1bg.png?1687276621\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031237567\"></p><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>Press ‘F2’</strong></p></td></tr></tbody></table><p>&nbsp;&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031237552/original/Rd10xxGMII_5G0UtFLR2ySyVScemZgI0QA.png?1687276621\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031237552\"></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031237560/original/MBrClPgOBRQMYeQiVFx5L6_fHWfRxhRhhw.png?1687276621\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031237560\"></p><p>&nbsp;</p><p><strong>Solution</strong></p><p>To fix this, search for the server opening transaction number from Back Office\\Tills and then locate the opening transaction number within the CashDraw table and then set the csdStatus value = ‘O’ (MUST BE A CAPITAL ‘O’ ELSE THIS BREAKS IT!), csdClosed At = ‘ ’ and csdClosedBy ‘ ’ for the given server transaction.</p><p>The status of the Till and CashDraw will reappear as open</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031237561/original/fL0UMPLtdGRR13KPFFIdJEiW9X2dwVEwsQ.png?1687276621\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031237561\"></p><p>&nbsp;</p><p>Then clear the ttnErrorMesssage and ttnStatus within TillTXNs table and commit changes.</p><p>&nbsp;</p><p>Open SQL Server Management Studio and enter the following sequence of commands:-</p><p>&nbsp;</p><p>select * from TillTXNS</p><p>select * from CashDraw</p><p>&nbsp;</p><p>begin transaction</p><p>update CashDraw set csdStatus = 'O' , csdClosedAt ='' , csdClosedBy ='' where csdOpenTXNNo = 58</p><p>commit</p><p>&nbsp;</p><p>begin transaction</p><p>update TillTXNs set ttnErrorMessage ='' , ttnStatus =''</p><p>commit</p><p>&nbsp;</p><p>Now the transactions that were stuck in the holding table will be processed.</p><p>Finally log back into the Till and ZRead it. Then perform a CashUp if necessary BUT the ZRead must be done!</p><p>&nbsp;</p><p>Note!</p><p>When you set the Cash Draw as open in the CashDraw table, the ‘<strong>csdClosedAt</strong>’ value for the give Till/CashDraw record will have a status of ‘1900-01-01 00:00 00:000’. This means the Till has been opened so there is no valid timestamp entry as seen in the below example…</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031237569/original/BfjsQTN7f7kk_n3AWbQRdY9n33iS8CCrGg.png?1687276621\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031237569\"></p><p>&nbsp;</p><h2>POS Till: Unable to Open Till/CashDraw &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p>Log onto the Till and check that there is no transaction files for this Till and Cash Draw sitting in C:\\Programs. Files\\Merac\\TXNFiles. If there are, move them into the <strong>History</strong> folder. Once they have been moved to the History folder, they are archived and you can then open the Till/CashDraw and start trading.</p><p>&nbsp;</p><h2>POS Till: Unable to ZRead a Till &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p>The issue could be 1)security permission related or the 2)Formats folder may have not updated on the Till correctly to allow the Till operator to login with authorized credentials to ZRead the Till or 3)the Till<strong>&nbsp;Last TX No</strong> does not equal the <strong>Last Updated TX No</strong>.</p><p>&nbsp;</p><p>1)</p><p><strong>&nbsp;</strong></p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031237565/original/ZCu1FzdupIUQjNZOKVzqxc51DhNyzZeucw.png?1687276621\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031237565\"></p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031237568/original/5uqNZedhHOUmbotbofE6W3QoXDcaLdehKA.png?1687276621\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031237568\"></p><p>&nbsp;</p><p>If the below appears, the Till operator does not have the required permission to ZRead the Till…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031237563/original/q7IZBFuYAA_A_ZHmObDMmt4oyf54Kpv5Nw.png?1687276621\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031237563\"></p><p>&nbsp;</p><p>2)</p><p>&nbsp;</p><p>If the above panel display a grey box with a button if the form highlighted below has not been copied to the Till located in C:\\Program Files (x86)\\Merac\\Formats\\MSTORESTD\\</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031237564/original/1gDikf_T1me5rW9mJt2R-HERrj42w3PmQg.png?1687276621\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031237564\"></p><p>&nbsp;</p><p>3)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p>Summary:-</p><p>Open the Till in question and check the <strong><em>Last TX No</em></strong> against the <strong><em>Last Updated TX No</em></strong></p><p>Verify whether the transactions have been uploaded to the server from SQL.</p><p>Check TXN file content</p><p>Amend NEWTXNS and UPDTXNS</p><p>Re-open Till and check that the server receives the transactions</p><p>&nbsp;</p><p><strong>Cause</strong></p><p>This usually happens if the <strong><em>Last TX No</em></strong> processed locally on the Till is lower or higher than the <strong><em>Last Update TX No</em></strong> (which is the last transaction number that has been successfully sent to the SQL server. Transactions are marked locally as being backed up by the files being moved to the History folder. The Till then knows that all transactions have been posted).&nbsp;</p><p>&nbsp;</p><p>If <em>Last TX No</em> is lower than <em>Last Update TX No</em>, this would possibly happen if the Till’s NEWTXNS file has become corrupted or unreadable by the Till program and so the Till cannot read the file to determine the last transaction number it processed so randomly chooses a transaction number. Logically the Till would reset to transaction count to a ‘0’ value which means the next transaction number to be processed by the Till would be ear tagged as Last TX No = 1.</p><p>&nbsp;</p><p>Note!</p><p>A ZRead or the Till drawer won’t open or close unless <em>Last TX No</em> = <em>Last Update TX No</em>.</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031237555/original/5toZ1RImoSMdxqCupBAQvdBQSu97nhndlw.png?1687276621\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031237555\"></p><p>&nbsp;</p><p>From the below exhibit, you can see that UPDTXNS has a Type value of ‘001 Archive’ which means it is whichever Till you are on and Cash Drawer 1. As soon as you add items to the basket and then press <strong>SubTotal</strong> button and process a payment (whether by Cash or Credit/Debit Card), the Last TX No and Last Updated TX No should increment by one automatically.</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031237559/original/rt0_t5R3kmHBUwjcDbka6YlRQnETDmv8Pw.png?1687276621\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031237559\"></p><p>&nbsp;</p><p>Opening UPDTXNS (time stamped 29/08/2014 @ 12:25), you can see that the last transaction number sent to the server is 13743 which ties up with the Till.</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031237557/original/T4CyQQ0JmqyVR_u8n0eVKlqEYJlJJYlSjQ.png?1687276621\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031237557\"></p><p>&nbsp;</p><p>Opening NEWTXNS (time stamped 29/08/2014 @ 12:25), you can see the last Till transaction processed by the Till. This again ties up with the Last Updated TX No. This is good because we now know that all transactions processed on the Till have been successfully posted to the SQL Server. To verify that the transactions have been uploaded to the database, open the Tills screen from Back Office and view the transactions – preferably the 2<sup>nd</sup> and last transaction number.</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031237558/original/EiXj6J4lcli2cb60sWrtijaNMmx-6T5I3g.png?1687276621\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031237558\"></p><p>&nbsp;</p><p><u>Scenario1</u></p><p>If Last TX No is higher than Last Update TX No, this usually happens when the Till is perhaps offline or the server is offline or inaccessible so the Till is unable to send it’s transactions to the server to be processed.</p><p>In both situations, this would prevent a ZRead or for the Till drawer from opening or closing.</p><p><strong>&nbsp;</strong></p><p><strong>Solution</strong></p><p>Make sure the Till and SQL Server are both online and then try add random items or No Sale items to the basket and VOID ALL and the Till should then reconnect to the database server. Once the Till Last TX No = Last Update TX No, a ZRead can then be carried out or the Cash Draw can then be opened or closed.</p><p>&nbsp;</p><p><u>Scenario2</u></p><p>Now if the Last TX No on the Till is lower than the Last Updated TX No (A&gt;B), the server is likely to have a later copy of transactions sent from the Till which will prevent the Till Drawer from opening or closing. This normally occurs when the Till attempts to read its NEWTXNS file to determine the last transaction number processed by the Till so it knows where to start from which would be &lt;Last_TX_Number + 1&gt;. If the Till program/software is behaving strangely or perhaps the Till was shut down without carrying out a ZRead at the end of a previous trading day, the Till may therefore not be able to read the contents of NEWTXNS, so will randomly generate a new transaction number starting from ‘1’.</p><p><strong>&nbsp;</strong></p><p><strong>Solution</strong></p><p>Open SQL Management Studio and connect to the database and run the below SQL query to determine the last transaction number uploaded onto the server:</p><p>&nbsp;</p><p>select * from txnheader where txhTillno=1 and txhtype not in (’O’,’C’)</p><p>--[O = Open, C = Closed]</p><p>order by txhTilltxnno desc</p><p>&nbsp;</p><p>Copy the Till’s local transaction log file (e.g. TNX001 seen in above example) to the Merac Support computer and run <strong>TXNFileParser</strong> app to re-edit the local transaction log file contents so that it starts from the transaction number following the last transaction number uploaded onto the server.</p><p>Save the new transaction log file, rename the old transaction log file on the Till in case we need to revert back to it for some reason and then copy over the new transaction log file onto the Till.&nbsp;</p><p>Amend the Tills UPDTXNS file to include the value of the first transaction number in the list (from the new transaction log file) -1. [this value should match the last transaction number processed/uploaded onto the server as we determined earlier]</p><p>Amend the Tills NEWTXNS file to include the value of the last transaction number in the list (from the new transaction log file). &nbsp;</p><p>Log back into the POS Till program and provided the Till has a network connection, all remaining transactions that have not yet been processed by the server sitting in the new transaction log file will then be processed and once&nbsp;</p><p><strong>Last TX No = Last Update TX No</strong>, a ZRead can then be carried out or the Cash Draw can then be opened or closed.</p><p>&nbsp;</p><p>Note!</p><p>VOID transactions and NO SALE transactions are also regarded as transactions.</p><p><br></p><h2>POS Till: Unable to Clear Data on Till following Merac Server going offline &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p>Normally caused by server being changed or going offline.</p><p><strong>Problem</strong></p><p>When carrying out a ZRead to close a Till, you will receive the following error message if the Merac server momentarily went offline…</p><p>&nbsp;</p><p>&nbsp;<img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239962/original/G-7Qj8BbKKRS2MoXuOCVo4T_5o0o2OtwPQ.png?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239962\"></p><p>&nbsp;</p><p>If you log back into the Till program you will notice that <strong><em>Last TX No</em></strong> ! = <strong><em>Last Updated TX No</em></strong>.</p><p>&nbsp;</p><p><strong>Solution</strong></p><p>Connect to the Till and then connect to the Merac Server and run ipconfig to get the Merac server IP Address.</p><p>Check that the Till C:\\Program Files\\Merac\\MStore.ini and ensure that the Server Path is correctly set to ServerPath=\\\\&lt;ServerName&gt;\\MeracData\\</p><p>Update the etc\\hosts file to point to the correct Merac server IP Address if there is no DNS server on the subnet from where the Till is installed for name resolution.</p><p>Log back into the POS Till program and process a VOID ALL transaction which should kick start the Till and force it to re-establish a connection to the Merac server and transaction data should automatically start updating again.</p><p>Carry out a ZRead on all other Tills.</p><p>&nbsp;</p><p>Note!</p><p>When a Till goes offline, a message will be displayed at the bottom in Red/White saying ‘Server Offline at xx:xx’. It will then create a file called ‘netstatus.txt’ (a text file) in <strong>C:\\Program Files\\Merac</strong> directory on the Till. To get the Till back online, delete this file to fix the issue or add items to the basket and the ‘VOID ALL’ to force a reconnection to the server. You could also click on the ‘Offline’ message at the bottom of the Till screen and select ‘Re-try again’ to force re-connectivity.</p><p>If you attempt to ZRead the Till and receive a ZRead failure message stating that ‘Not all transactions have been uploaded to the server’, check that PServerUpdater is running in the background for ver 3.14 and disable UAC. If running ver 3.15, restart MeracUpdater service.</p><p>&nbsp;</p><h2>POS Till: ExecuteNonQuery: Error converting data type float to decimal &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p>Below SQL Holding Table Transaction error received…</p><p><strong>&nbsp;</strong></p><p><strong>ErrorMessage:</strong></p><p><strong>TXD-//i:ExecuteNonQuery:Failed to save transaction detail record for TXNNo 89425 on Till 220 (Error converting data type float to decimal.) &nbsp;TXD line = TXD,1,220,220,89425,1774,1,All in One Child,All in One Day Child,S,1,-53222197.74,-53222197.74,222222220,53222221.69,0,0,0,0,0,0,0,0,23.95,V,0,0,0,1,S,-8870366.28,0,,0,0,,0,17,0,0,1796,0,,,,,0,0,0,,0,0,,,0,,0,,,,,,,0,25 Oct 2015 15:24,0000,0,0,,0,0,0,0,0,0,0,0,0,9</strong></p><p>&nbsp;</p><p>TXNLine in Holding Table:</p><p>TXD,1,220,220,89425,1774,1,All in One Child,All in One Day Child,S,1,-53222197.74,-53222197.74,222222220,53222221.69,0,0,0,0,0,0,0,0,23.95,V,0,0,0,1,S,-8870366.28,0,,0,0,,0,17,0,0,1796,0,,,,,0,0,0,,0,0,,,0,,0,,,,,,,0,25 Oct 2015 15:24,0000,0,0,,0,0,0,0,0,0,0,0,0,9</p><p>&nbsp;</p><p><strong>Cause and Fix</strong></p><p>This issue is normally caused by scanning a barcode for example at the POS Till into the ‘Price’ field accidentally and then SQL fails to convert the data being scanned to the correct numeric format. You can see that the above transaction line was VOIDED so you could just delete the line from the Holding Table to fix the issue.</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><h2>POS Till: Two of the same Till Numbers are open using the same Draw Number Fix &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p>If two of the same Till Number are opened using the same Draw Number, run the following commands to determine the Till’s open transaction number (i.e. Server allocated Transaction Number) which is greatest. This would be the one that was opened most recently (2nd of the two).</p><p>&nbsp;</p><p>select * from CashDraw where csdTillNo &nbsp;= X and csdDrawNo = Y and csdStatus = 'O'</p><p>&nbsp;</p><p>OR</p><p>&nbsp;</p><p>Open Tills from Back Office and determine if there are more than one instance of a particular Till and Cash Draw open and if so, view the most recently opened Till/Draw instance transactions to determine its opening server transaction number. Then use this info. to delete it’s records from the following tables – txnHeader,txnDetail,Payments,TXNTax,CashDraw and CashUp and then if there are any errors in the Holding Table, clear these.&nbsp;</p><p>This will allow all pending transactions to then be processed.</p><p>&nbsp;</p><p>Note!</p><p>The above solution would only stand if the 2nd instance Till/Draw opened has not processed any transactions else they will get stuck in the Holding Table.</p><p>&nbsp;</p><h2>POS Till: Till X, Cash Draw Y appending multiple Open entries in TXNS file &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>Cause</strong></p><p>When the Till is ZRead, the operator turns off the Till during the process, the Till would not get a chance to archive the TXNS file into the History folder but the CashDraw is successfully closed hence why the Till when opened again, appends another Open entry to the file.</p><p><strong>Fix</strong></p><p>Archive all transaction files UPDTXNS, NEWTXNS and TXNS files to History folder and get the operator to log back onto the Till.</p><p>The Till will say failed to get Last Transaction Number. Would you like to obtain the Last Transaction Number from Server.&nbsp;</p><p>Click Yes.</p><p>The Tills first transaction number will now be the Servers Last Transaction Number.</p><p>&nbsp;</p><h2>POS Till: ‘Insert Header Till_Draw Subquery returned more than 1 value’ error &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p>TXH-Insert Header Error. Till = 2Draw = 2Till TXN = 17352 (Subquery returned more than 1 value. This is not permitted when the subquery follows =, !=, &lt;, &lt;= , &gt;, &gt;= or when the subquery is used as an expression).</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239990/original/xYYsqwkgIx1XZY3Vas-zFexo5xLTEnEvSA.png?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239990\"></p><p>&nbsp;</p><p><strong>Reason</strong></p><p>There is more than one of the same Cash Draw open for the same Till.&nbsp;</p><p><strong>Cause</strong></p><p>Usually caused by either a ZRead of the Till not successfully completing - most often caused by a 1)<strong><em>poor network connection</em></strong>, 2)<strong><em>turning off the Till in the process of completing a ZRead</em></strong>, 3)<strong><em>unplugging a mobile Till UFD from a computer whilst Merac System is in the process of completing a ZRead</em></strong> or 4)<strong><em>PDBUpdater (3.14) or MeracPDB (3.15) failing to mark the Till and Cash Draw as closed following a ZRead (less likely to happen!)&nbsp;</em></strong>and then the next trading day, the Till operator being unaware that the Till/CashDraw has been closed off successfully, opens the same Till/CashDraw and processes transactions from the Till. The transaction then gets stuck in the Holding Table.</p><p>&nbsp;</p><p>How to replicate the scenario:-</p><ul><li>Stop PDBUpdater or MeracPDB service on the server</li><li>ZRead the Till – the local transaction files will in affect be archived.</li><li>Locate the currently open Till/CashDraw in TillTXNs and delete the CLO (Closing record) for the given Till</li><li>Re-Start PDBUpdater or MeracPDB service on the server</li><li>Re-open the the same CashDrawNo. on the same Till</li></ul><p>(Now two open records will appear in Back Office for same Till/CashDraw)</p><p>&nbsp;</p><p>As soon as you start sending transactions to the server, PDBUpdater will not like this and send PDBUpdate Notification error messages to the server and stop processing any transaction sitting in the table until the error is cleared.</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239965/original/CXGGuBTn5FhNv31A5CdDwSzaaoJTurv-AQ.png?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239965\"></p><p>&nbsp;</p><p><strong>Solution</strong></p><p>Close the most recently opened duplicate Till/CashDraw from Back Office and clear error messages displayed in <strong><em>ttnStatus</em></strong> and <strong><em>ttnErrorMessage</em></strong> within the Holding Table to allow any transactions from the previous Till/CashDraw to flow through the Holding Table and into the database.&nbsp;</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239964/original/W4wZ0I-ZJbMeUNxWPP-kQgjrhb-WFyKu9w.png?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239964\"></p><p>&nbsp;</p><p>begin transaction&nbsp;</p><p>update TillTXNs set ttnStatus = '' , ttnErrorMessage &nbsp; &nbsp; = ''&nbsp;</p><p>where ttnStatus = 'Failed'&nbsp;</p><p>commit</p><p>&nbsp;</p><p>Key highlighted factors to consider before closing the most recent Till/CashDraw that was opened…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239983/original/uLDwqyRiaSSOmu3e7kKbx9Pb3sLiuiHJfw.png?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239983\"></p><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>1</strong></p></td></tr></tbody></table><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>2</strong></p></td></tr></tbody></table><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>3</strong></p></td></tr></tbody></table><p>&nbsp;&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>1)In the above, the timestamp must be dated other than todays date. This would indicate that the transactions stuck in the Holding Table are still pending to be processed from the originally opened Till/CashDraw.</p><p>2)In the above, the last transaction without an error against it must have a timestamp other than todays date.</p><p>3)In the above, a closing record at the end of the list of transactions for the originally opened Till/CashDraw would mean that once the 2<sup>nd</sup> mentioned of the two Till/CashDraw is F2’ed, transactions will flow through following clearing error messages and will close.&nbsp;</p><p>&nbsp;</p><p>To confirm this, check Back Office Tills screen or open the CashDraw table and ensure the Till/CashDraw is closed – it should be, given that there is a closing record tag at the end of the first open Till’s transaction file (i.e. there is a closing record sitting in the Holding Table), else the Till will remain open and should be marked as open in the CashDraw table if busy trading.</p><p>If it is determined that the Till/CashDraw is not trading, you may need to close the Till and Cash Draw manually.</p><p>&nbsp;</p><p>You can check if the Till/CashDraw number is marked as closed in the database by searching CashDraw table based on csdOpenTXNNumber which in this case would be ‘20231’…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239949/original/feUE_MKktJK3TfUEzQ0Vu01NyZXU1RPFcg.png?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239949\"></p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239960/original/xaA11f5SXUZIPOPxTUnNKbTLQBkEogcvMg.png?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239960\"></p><p>&nbsp;</p><p>If there are transactions pending to be processed for the 2<sup>nd</sup> mentioned Till/CashDraw sitting in the Holding Table, you will need to re-open the Till/CashDraw from the CashDraw table by searching its opening record line.</p><p>&nbsp;</p><h2>POS Till: Open Cash Draw not appearing from POS Till &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p>In a situation that a Till has been trading for the day and then there is for example a power cut and the Till shuts down unexpectedly, when the Till restarts and you attempt to login to the Till, there is no Cash Draw visible to allow the till operator to login to the Till. The reason for this is because either NEWTXNS or UPDTXNS file contents are incorrect or blank. When Windows experiences an unexpected shutdown and is readying from a file, the file or its contents may get corrupted.</p><p><strong>Fix</strong></p><p>Rebuild the NewTXNS file date stamped for the day which should appear blank (i.e. Windows would blank the contents as a result of the unexpected shutdown – copy my own NEWTXNS or UPDTXNS contents as a template).</p><p>Open the local transactions file and get the last transaction processed by the Till.</p><p>Copy an existing NewTXNS file and past it into the NewTXNS file date stamped for the day and edit the contents to include the last transaction number noted earlier and the Draw/TillNumber and save. If there was an issue with the UPDTXNS file, insert a transaction number prior to the first transaction number executed by the Till and save.</p><p>&nbsp;</p><p>Note!</p><p>In later versions of Merac software (3.15 or higher), MeracPDB is a service that runs on the server only which moves transactions sitting in the Holding Table to the database and is clever enough to know that even if you set UPDTXNS transaction number to a number already sent to the server, will not re-upload the same transaction number to the database causing duplicate transactions but instead will only send/upload those that have not yet been processed.</p><p>Like PServerUpdater used by 3.14 to send transactions to the server from the Till, MeracUpdater service does the same for 3.15.</p><p>&nbsp;</p><p>Try re-opening up the Till and CashDraw and log back into the POS Till and everything should be OK. Confirm this by adding random items to the basket and Void All or restart MeracUpdater service on the Till to allow the Last Update TX No to catch up with the Last TX No.</p><p>Done!</p><p>&nbsp;</p><h2>POS Till: Startup Error – ‘Error Accessing Line Display’ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p>System displaying OPOS error when starting up Till: “Failed to claim OPOS Line Display\".</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239959/original/HahIr9tKWXxZQ22k2SWb4tJNTcXoiwrjww.png?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239959\"></p><p>&nbsp;</p><p>The Customer Line Display (CLD) unit only shows the ‘CompanyName’ and nothing else.</p><p>CLD is USB attached but uses a built-in USB-to-COM port converter, which is a piece of software used to convert the USB attached CLD to be detected by Device Manager as a COM port.</p><p>&nbsp;</p><p><strong>Troubleshooting</strong></p><p>Checked in OPOS utility that the hardware settings for the CLD is set to COM7</p><p>HandShake should be set to ‘None’.</p><p>Try plugging the CLD into another USB port and scan for hardware changes and reboot the Till and test.</p><p>Swapped CLDs with a known working one – If it starts working then the device is damaged.</p><p>&nbsp;</p><h2>POS Till: Customer Line Display (CLD) not working &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p>First few things to check:</p><ol><li>Open Devices Manager and make sure the COM7 is enabled.</li><li>Reinstall the Front Line Display Software.</li></ol><p>&nbsp;</p><p><strong><u>Installing Aures Sango Customer Line Display &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</u></strong></p><p><u>&nbsp;</u></p><p>If there are issues with the USB-to-COM port drivers, try reinstall these – run the driver installer first and then the Configuration utility to detect the device on the COM port…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239970/original/wSxtSe7OVQu93kMAfpqzEr8nVFjVZYbO-A.png?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239970\"></p><p>&nbsp;</p><p>Once the driver is installed, run the setup from the D:\\Sango_C95Drivers\\Graphic Cust Disp\\Configuration v1.1.9\\</p><p>Click <strong>Scan Device</strong> button</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239950/original/okGW_uZ8gcUxIrL2sTE8Ka3Jz7yhmEuyEg.jpeg?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239950\"></p><p>&nbsp;</p><p>Click <strong>Auto Scan</strong> button</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239953/original/yX_1iP33vAwf3rUM7Cwl9OZT5dDkMHBaPA.jpeg?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239953\"></p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239951/original/sfAY_fR9gDTKxVup4Tcjsamft9Xbc7-XWA.jpeg?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239951\"></p><p>&nbsp;</p><p>The correct COM port will be detected for the Front Line Display which is COM7…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239952/original/d7A1NSMwfMpJSy71YCC4X3IveQ-oOtrjog.jpeg?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239952\"></p><p>&nbsp;</p><p>Click <strong>Change Settings</strong></p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239954/original/o3kMWK4XDNmvJxsHbCyAlxviS9g8f4aqpg.jpeg?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239954\"></p><p>&nbsp;</p><p>Change the Command Type to <strong>1-ESC/POS</strong> and then click the <strong>Set to Device</strong> button…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239955/original/jLR2coRoXpcywju4ilJLmrHF7Bky2dzCaA.jpeg?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239955\"></p><p>&nbsp;</p><p>Complete!</p><p>&nbsp;</p><ol><li>Make sure the Handshake is set to ‘DISABLED’.</li></ol><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239966/original/VgDgR6n6j6Ejg4Pj-kl_YjbEjoegVR5JTQ.png?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239966\"></p><p>&nbsp;</p><p>If not then you will have to amend this manually by navigating to the following location C:\\Program Files\\OPOS\\Epson2\\ and open the following file for editing - LdDMD101</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239958/original/j4RcXJTNbaJkCZef9up4yNkQI1VTsQJRRA.png?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239958\"></p><p>&nbsp;</p><p>Run an ‘Interactive Health Check’ from Epson <strong>SetupPOS Ver2.00</strong> utility for the Line Display and then check that the Line Display is showing text on the LCD screen. If the Front Line Display is showing any dollar symbols then the device is incorrectly configured.</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239957/original/4P0iWzUkS8E6AMRIVF6Mf6IlSWGX9uBh0Q.jpeg?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239957\"></p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239956/original/j98g0pyJvQ5XDtYnCHvbEUCs3lICe5O-hA.jpeg?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239956\"></p><p>&nbsp;</p><h2>POS Till: Description Incorrect for Items Sold at the Till &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>Problem</strong></p><p>Scanned Item Description Name on Till incorrect for a Sell Item</p><p><strong>Solution</strong></p><p>Found that the PLU associated to the barcode (e.g. 5029306666104) when searching the PLU based on the Code “5029306666104” had the wrong Description of \"DW Fluffy Owl\" whereas the Stock Item with that same Code had a Description of \"DW Cone Snow\".</p><p>Have advised that a correction would need to be made to the PLU to match the correct Description Name. A recreate Till data would also be required to update the changes to all Tills.</p><p>&nbsp;</p><h2>POS Till: Wrong Payment made for a Booking &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p>Amending Payments made to a Booking through SQL can be done but ultimately it is encouraged for the customer to carry out the amendment through the Till by recalling the booking and carrying out a refund. In some circumstances, even though the correct payment shows in the <strong>Payment History</strong> window in Back Office and also reflected in BKGHeader and BKGDetail for the particular booking number, you may still be required to reverse the payment through SQL.&nbsp;</p><p>&nbsp;</p><p>Note!</p><p>‘txnNo’ column in <strong>Payment History</strong> would be the server transaction number.</p><p>&nbsp;</p><p><strong>Solution</strong></p><p>Open SQL Server Management Studio and enter the following sequence of commands:-</p><p>&nbsp;</p><p>select * from TXNHeader where txhNo = &lt;ServerTXNNo&gt;</p><p>select * from TXNDetail where txnNo = &lt;ServerTXNNo&gt;</p><p>/* Note! txnOrderNo is the actual Booking Ref. No*/</p><p>select * from Payments where payTxnNo = &lt;ServerTXNNo&gt;</p><p>select * from TXNTax where txtNo = &lt;ServerTXNNo&gt;</p><p>&nbsp;</p><p>begin transaction</p><p>delete from TXNHeader where txhNo = &lt;ServerTXNNo&gt;</p><p>delete from TXNDetail where txnNo = &lt;ServerTXNNo&gt;</p><p>delete from Payments where payTxnNo = &lt;ServerTXNNo&gt;</p><p>delete from TXNTax where txtNo = &lt;ServerTXNNo&gt;</p><p>commit</p><p>&nbsp;</p><h2>POS Till: Over Payment Showing in Booking when using Payment Method Voucher &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p>When a customer has over-paid for a booking i.e. in the below booking you can see that a £50 voucher was used to pay for a booking with a Total Amount Due of £45 in the Merac BO System…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239982/original/gxswj2WzSjhMMQoSlcodFd-JXHKdZBEtSw.png?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239982\"></p><p>&nbsp;</p><p>As a result, when you run Transactional Analysis by Nominal Code report, you will notice that the very top gives you details of the amount paid in (which includes Vouchers, Cash or Card). The customer presented the cashier with a £50 voucher which was entered into the POS system as Paid So Far amount of £50 instead of £45 which is the actual amount due. This is an actual payment of £5 over.</p><p>That is why when you look at the report, you see £118.50 which is the total amount paid.</p><p>Based upon the actual PLU Sell Price of each item purchased using a combination of payment method Credit Card and Voucher, the actual true transaction total amount should be £113.50. The item sold using the Voucher was worth £45 as seen encircled in red. That leaves an over payment of £5 which you can see clearly at the very bottom of the report encircled in blue…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239977/original/rnS6lhrRDEtH6NJrCgxCTQv2KTulkecHlQ.png?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239977\"></p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239969/original/3LvRmBzrxve1s-IAnMzf7nF304VNLHwORQ.png?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239969\"></p><p>&nbsp;</p><h2>POS Till: Error ‘SellCurrentItem - Object variable or With block variable not set’ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>Problem</strong></p><p>If you attempt to scan an item or enter the item code into the Code field on the POS Till, an error ‘SellCurrentItem - Object variable or With block variable not set’ is returned as seen below…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239963/original/YYWO9E3Zj52Q-WpMnFnhed_ikFZjKP9F7g.png?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239963\"></p><p>&nbsp;</p><p><strong>Discontinued</strong> - Stock items that you still want to sell but no longer want to re-order</p><p><strong>Deleted</strong> - Stock items you no longer want to sell</p><p>A Discontinued or Deleted PLU item means you cannot sell the item.</p><p>&nbsp;</p><p>If a Stock item has been deleted and discontinued, search for the item by selecting the Deleted and Discontinued checkbox</p><p>(it’s will be displayed as a 'strikethrough entry' (i.e. meaning the Stock item is Deleted) and highlighted in Pink (i.e. meaning the Stock item is Discontinued).</p><p>If a Stock item has been discontinued, it can still be sold until all remaining Stock has been depleted but the system will not be reordered through Supplier. To search for the item, select the ‘Discontinued’ checkbox</p><p>(highlighted in Pink (i.e. Discontinued))</p><p>If a Stock item has been deleted, it can no longer be sold. To search for the item, select the Deleted checkbox</p><p>('strikethrough entry' (i.e. Deleted))</p><p>&nbsp;</p><p>Note!</p><p>To find a Stock item that has been both Deleted and Discontinued you will have to select both Deleted and Discontinued checkboxes.</p><p>If a PLU (Non-Stocked item) has been discontinued, you will no longer be able to sell that item. You will receive the following series of error messages because when an item is sold, the routine would first check the contents of the MeracDat.txt file to determine if the item exists and if it does the status of the PLU being sold (i.e. Active, Discontinued or Deleted) and then whether or not the PLU is linked to a promotion. Because the item exists in the MeracDat file but has been discontinued, the below error messages will be displayed…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239975/original/D1WLpGs2LyWbdrfydLzMcuUDQXUbiOj1lA.png?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239975\"><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239972/original/Bux1RDJAQdLszvP0SdjBLP8iBmJCO9rMMA.png?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239972\"></p><p>&nbsp;</p><h2>POS Till: MStore Program Error- CApp ‘Object variable or With Block variable not set’ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>Problem</strong></p><p>When clicking on the <strong>Bookings</strong> button to recall bookings from the Till, receive MStore Program Error “Object variable or With Block variable not set”.</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239967/original/2BEuKg87ozgPirkNErJUHdVBIQiSxbISwg.png?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239967\"></p><p>&nbsp;</p><p><strong>Troubleshooting</strong></p><p>If the customer connects to multiple databases (e.g. Longleat or NMRN or Paignton Zoo [Paignton Zoo have two site databases i.e. <em>Paignton Zoo</em> and <em>Living Coast</em>]).&nbsp;</p><p>&nbsp;</p><p>If this is the case, the first thing to check would be the MeracDat.txt file. It is likely that someone may have logged into Back Office Living Coast database from the Paignton Zoo network and carried out some changes followed by a <strong>Recreate Till Data</strong> which would have overwritten the Paignton Zoo server MeracDat.txt file with the Living Coast version so when other Tills from Paignton turn on and run an update, their local MeracDat.txt file contents will be incorrect and you may receive the above ‘Object variable or With block variable not set’ error either when the POS Till program starts up or if the till operator attempts to recall a booking or sell an item.&nbsp;</p><p>&nbsp;</p><p>Example:-</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239974/original/spEF31kz6wQVkUPFUjzb1JbiEHSaoYHOnw.png?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239974\"></p><p>&nbsp;</p><p>The MStore.ini file is pointing to the actual Paignton Zoo site Merac Server DataPath as seen encircled above hence if a user attempts to log onto a different remote site database (i.e. Living Coast) from Back Office and runs Recreate Till Data. The process will over-write its centrally stored MeracDat.txt file in the MeracData share and an update run on each Till will pick up the wrong configuration settings.</p><p>&nbsp;</p><p><strong>Fix</strong></p><p>Advise the customer at Paignton Zoo to Recreate Till Data by connecting to the Paignton Zoo database from Back Office and for all Till operators to update their Tills.</p><p>&nbsp;</p><h2>POS Till: PLU Sell Item error - “Object variable or with block variable not set” &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239976/original/ZCj_brPmxRxeczAj9HlfDcNXGPOu96WBcQ.png?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239976\"></p><p>&nbsp;</p><p><strong>Problem</strong></p><p>When trying to sell a PLU from the Till, receive error “Object variable or with block variable not set”.&nbsp;</p><p><strong>Fix</strong></p><p>Try run Till Update</p><p>Try process a transaction selling a particular item and then check if that item price is in the MeracDat.txt file on the Till –</p><p>Search for the PLU item to determine the PLUID and then search “PRI,” and search for the price entry for the given PLUID.</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239973/original/yMP8lDxiE9Rd7F_GHD8SpKl0xCbk_l_DiQ.png?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239973\"></p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239968/original/z22edjIRoubJPoVp8xuz99uVINbUvKZK3g.png?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239968\"></p><p>&nbsp;</p><p>If it is there, then most likely the PLU has either been marked for deletion or has been discontinued.</p><p>If it is not there then most likely the SQL database is Locked (i.e. the Prices table or an associated table may be locked)</p><p>Log onto the server and then restart both Merac PDBUpdater and SQL Service.</p><p>Get the Till operator to run an Update on all Tills and this should fix the issue.</p><p>If you now examine the MeracDat.txt file, there should be a PLUID and PRI item in the file that matches that which is in the database or in Back Office.</p><p>&nbsp;</p><p>Note!</p><p>SQL could also be locked by running a “begin transaction” query and not committing changes.</p><p>&nbsp;</p><h2>POS Till: CDraw/XRead program error - “Object variable or with block variable not set” &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p>When doing anything on the till i.e. pressing a button or logging out or logging on to the POS Till.&nbsp;</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239980/original/MZYBMbFEhAgUCBYq0d_vzeRpaj9ynBT-jg.png?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239980\"></p><p>&nbsp;</p><p><strong>Fix</strong></p><p>ZRead the Till and then archive the contents of the TXNFiles folder.</p><p>&nbsp;</p><h2>POS Till: Physical Cash Draw not Opening &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</h2><p>When making a payment from the POS Till, the Cash Draw is not opening. Receive the following error message:</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239995/original/_ovRlEhZTTSfRyurqm25MxH9X78fg9Oykg.png?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239995\"></p><p>&nbsp;</p><p>Physical Cash Draw is plugged into the Receipt Printer and Back Office Till Configuration Receipt/Slip Printer and Cash Drawer 1 are defined identical (e.g. TSP643D).</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239994/original/u-rN7vfe6xaV3FiUoweuJL7R-2fdXMN6Ww.png?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239994\"></p><p>&nbsp;</p><p>If Epson OPOS shows the OPOS Printer and Cash Drawer as greyed out, this means that their settings are defined somewhere else. In this case, they are defined within another piece of software (e.g. StarMicronics)…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239971/original/iqZh9NsiUSmKu27W6BiV9L73pPOA7aOUTg.png?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239971\"></p><p>&nbsp;</p><p><strong>Troubleshooting</strong></p><p>Check that the PCI Express COM Ports installed are visible in Device Manager under Ports (COM &amp; LPT). You can manually change the port number but these would also need to be changed from within the OPOS software to match.</p><p>Print a Configuration slip from the Receipt Printer and make sure you set the Baud Rate within the OPOS software to match.</p><p>If there are still issues with the Physical Cash Draw or Receipt Printer not being detected following running A Health Check, the Receipt Printer could be faulty or if the Receipt Printer is working but not the Physical Cash Drawer not, the Cash Draw could be faulty.</p><p>&nbsp;</p><h2>POS Till: Customer Search (‘Find Member’ command button from Till) not returning results on Till &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p>When searching for a Customer to Invoice from a Till and the search feature does not find any information, check that the “Source” field has a value in it…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239987/original/lKiswRDi6SI3k7ir_FndpcH0903FWRZfvw.png?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239987\"></p><p>&nbsp;</p><h2>POS Till: Till ‘Reprint Receipt/Reprint Journal/Till Roll’ showing blank receipt details &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239978/original/VM37OT597dCH-I8AuNjrypGzjDU9nYQuyg.png?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239978\"></p><p><strong>&nbsp;</strong></p><p><strong>Solution</strong></p><p>Close the POS Till and then from Back Office&gt;&gt;open <strong>Till Configuration</strong> and then click <strong>Alter Default Till Document</strong> button and then ensure that a Receipt design is selected (checkbox checked) and click <strong>Apply</strong>.</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239988/original/6jFf4RWF86HW1nYsuz9-Pa9BjmKCzhiLoQ.png?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239988\"></p><p>&nbsp;</p><p>Now open the till again and then try and view transactions processed through the till through the Reprint Receipt|Reprint Journal or Till Roll and process the refund again.</p><p>&nbsp;</p><h2>POS Till: Receipt Blank on Till &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p>First ensure that any printer is set as default from Devices and Printers. Then ensure that for the particular Till in question, a receipt printer is defined (e.g. WINRECEIPT for Windows printing) in Back Office&gt;&gt;<strong>Till Configuration</strong>. You may need to also click Alt <strong>Default Till Documents</strong> button and dirty the records checked and save the changes then go back in and revert them back to how they were&gt;&gt;Recreate Till Data and Update Tills and then instruct the till operator to try re-printing the receipt.</p><p>&nbsp;</p><h2>POS Till: Till Transactions Missing in DTA &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>Problem</strong></p><p>If the Merac database server goes down and a Till as a result is missing certain transactions when running DTA, do the following…</p><p><strong>Solution</strong></p><p>Remote onto the Till and open explorer and navigate to ‘C:\\Program Files (x86)\\Merac\\TxnFiles\\History’ or ‘C:\\Program Files \\Merac\\TxnFiles\\History’ or ‘C:\\ProgramData\\Merac\\TxnFiles\\History’.</p><p>Copy the transaction file to the Merac Server.</p><p>Remote onto the Merac Server and make sure the server has the an updated version of PDBUpdater.</p><p>Open Merac Back Office and then click <strong>Setup</strong> and click <strong>Edit</strong> menu to manually upload contents of the transaction file to the Merac Server.</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239979/original/9K-XcA0cXglDa9hCYxhM9zFrhZSVIG15yw.png?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239979\"></p><p>&nbsp;</p><p>Now browse to the saved transaction file, select it and then click <strong>Upload</strong> button</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239984/original/9AnnDYeR62A8XCnlgdxlqQ22Urjx_wyYcQ.png?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239984\"></p><p>&nbsp;</p><p>Click <strong>Yes</strong> at the next window followed by <strong>OK</strong>.</p><p>&nbsp;</p><p>Note!</p><p>For both 3.14 and 3.15, PDBUpdater is clever enough to know that any transactions that exist in the transaction file that have already been uploaded to the server would be ignored so that no duplicates would be present.</p><p>&nbsp;</p><p>Done!</p><p>&nbsp;</p><h2>POS Till: Printing and Barcode Scanning – Error occurred in calling the CheckHealth method &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a>&nbsp; &nbsp; &nbsp; &nbsp;</h2><p>When testing Printers and Scanners (connected via serial COM port) and carrying out Health Checks through the OPOS system, only one application can claim the device at a time. Therefore, best practice is to close the POS Till software and then run a Health Check else an error message will be returned.</p><p>&nbsp;</p><p>HEALTHCHECK ERROR:</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239981/original/MDalDnDOMUoVZfyNBNSD-UzvQDA5I1uHAA.png?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239981\"></p><p>&nbsp;</p><p>General Hardware Problems that may result in this error also being produced:</p><p>Mis-configuration</p><p>Faulty Cable</p><p>Faulty COM Port</p><p>Faulty Device&nbsp;</p><p>&nbsp;</p><h2>POS Till: Barcode Scanner not scanning a barcode &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p>Download iPhone App (Code Read R) and then insert the barcode having the problem scanning and it will return the symbology of the barcode.</p><p>Configure the device using that symbology and then print the scansheet to re-program the scanner and then if you then attempt to scan the barcode, it should work.</p><p>&nbsp;</p><p>OR</p><p>&nbsp;</p><p>If the symbology is enabled on the barcode scanner and the device is attached via USB, open Back Office&gt;&gt;<strong>Till Configuration</strong> and then set the Barcode Reader setting to ‘None’ (since it is attached via USB).</p><p>&nbsp;</p><p>The device will appear in Devices and Printers as seen in below exhibit…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239985/original/P-idrad-pAxMMz-5CIGAmS1i0y8353UaMQ.png?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239985\"></p><p>&nbsp;</p><p>If the scanner outputs a barcode following a scan with no space at the beginning, then the barcode scanner is not programmed correctly. Send the customer the barcode scanner scan sheet to re-programme the device and then try scan again.</p><p>This should fix the issue!</p><p>If you scan an item and the barcode appears in the Code field on the Till and then disappears with no Merac ‘Item not Found’ notification message being displayed, this means that <strong>System Options</strong>&gt;&gt;<strong>Stock</strong> tab&gt;&gt;<strong><em>PLU to use for 'Item Not Found'</em></strong> option is not defined - hence why the Item Not Found window is not appearing allowing the Till operator to add the PLU manually.</p><p>&nbsp;</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239996/original/Se-c8q9CETpmIR4J1NfS_Z81eXAWTrbRbQ.png?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239996\"></p><p>&nbsp;</p><h2>POS Till: Scanning Barcodes – ‘Item not found’ error &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>Problem</strong></p><p>POS Till returning “Item not Found” error when an item barcode is scanned using the barcode scanner. &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp;</p><p>Note!</p><p>This problem only occurs when scanning certain Stock items. The fact that a response is being returned means that there is nothing wrong with the barcode. It there was, then when you scan a barcode, nothing will happen!</p><p>&nbsp;</p><p>If there is no response when scanning the barcode, get the customer to send us a photo of the Stock item barcode and we can try and test scan the barcode from here. If the item is scanning correctly, the issue is with the scanner.</p><p>&nbsp;</p><p>Check Stock Item Print Barcode Configuration if no response from POS Till when scanning barcodes. The symbology could be setup incorrectly when the barcode labels are printed or the barcode used could be incompatible with any symbology that would render the barcode scanable by the barcode scanning device.&nbsp;</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239986/original/lWC0qP-c7Zz-WpwjHxM0u4dXsMYn0EFjhA.png?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239986\"></p><p>&nbsp;</p><p><strong>Troubleshooting</strong></p><p>Check configuration of Barcode Scanner and Barcode Printer:</p><p>1)Configure and test the barcode scanner. If the device is attached using serial COM port, ensure that it is configured correctly in OPOS. You could also re-program the scanner from here as well.</p><p>2)Check Merac MStore BO System&gt;&gt;Till Configuration&gt;&gt;if a serial COM port attached barcode scanner, set the “BarCode Reader” field to the name Make/Model of device (e.g. Eclipse/Voyager/Orbit) ensuring that the name showing in OPOS is identical to the name in the Merac MStore BO System.&nbsp;</p><p>&nbsp;</p><p>Note!</p><p>If a USB barcode scanner, no need to specify any config. Settings in Merac MStore BO System as the scanner will be picked up automatically and will be available immediately through PnP.</p><p>&nbsp;</p><p>3)Get the customer to print a Scan Sheet for the appropriate device (if attached via USB i.e. not configured through OPOS Metrologic Administrator) and get them to scan every barcode and PQ code in order from top to bottom to re-calibrate the scanner.</p><p>4)Test that the item StockCode is picked up from the Till by entering the code into the “Code” field</p><p>&nbsp;</p><p>Format: &lt;Space&gt;&lt;StockCode&gt;&lt;Enter&gt;</p><p>&nbsp;</p><p>Note!&nbsp;</p><p>Any items with codes that do not start with a &lt;Space&gt; character are recognised by the Till as <u>Sell Items</u> and any items that start with a &lt;Space&gt; character are recognised by the Till as barcodes).</p><p>&nbsp;</p><p>When a barcode is scanned and the Till responds to the item being scanned (i.e. even if an error is returned such as “Item Not Found”) means that the barcode is a valid barcode. With the correct item being added to the basket once the item is scanned would provide confirmation that the barcode is linked correctly to the item being sold.</p><p>&nbsp;</p><h2>POS Till: Casio Barcode Handheld Scanner error – ‘Item not found’ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>Problem</strong></p><p>When trying to scan barcodes (11 digit barcodes), receive error that item not found but scanning the item from the Till works fine.</p><p><strong>Fix</strong></p><p>Enable \"Output Check Digit\" which is the last digit of an UPC-A symbology barcode. This will perform a checksum on the 11-digit barcode to verify that the barcode is correct.</p><p>&nbsp;</p><p>The ‘Output Check Digit’ for any barcode is first digit to the far right. For EAN13, this would be the 13<sup>th</sup> digit. For UPC-A, this would be the 12<sup>th</sup> digit.</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239989/original/fQJa8SsY0gG9Q5cife7koNqnZFxS1MHtkA.png?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239989\"></p><p>&nbsp;</p><p><strong>How to Enable “Output Check Digit”</strong></p><p>Run Image Scanner Read utility from Programs menu…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239991/original/QF4RC9ed_t4a6owbNxfg0ZhNpvQtEhfapQ.png?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239991\"></p><p>&nbsp;</p><p>Click on ‘Image Scan Read’ utility from taskbar and then click <strong>Settings</strong>…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239993/original/dwuOzg4awggf_B-Ru-os8i5OC3qO5wakOA.png?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239993\"></p><p>&nbsp;</p><p>Click <strong>Options</strong> tab and then change UPCA to include “Output Check Digit”…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031239992/original/TIAapLM9vto8mvuVjiyDpymx5_5D5CKvhA.png?1687277328\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031239992\"></p><p>&nbsp;</p><p>Close the ‘IMGSet’ window and then click on the Image Scan Read icon in taskbar again and click <strong>Close</strong></p><p>&nbsp;</p><h2>POS Till: Honeywell PDA Handheld stuck on ‘Setting up device. Please wait…’ whilst not connected to the dock &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p>What should follow is a screen that asks you to update the date/time&nbsp;</p><p>&nbsp;</p><p><u>Troubleshooting Steps</u>:-</p><p>Plug the device into the USB dock and then browse the device to check that the correct private IP/Port number details are entered into the Mobileini.txt file. Also check that the MobileDat.txt file has data in it. If not, then delete the MobileDat.txt file and then unplug the device from the dock and reboot the device.&nbsp;</p><p>If it still does not get past the point of setting up the device, plug the device into the dock and cold boot the device to eliminate WiFi and see if this resolves the issue.</p><p>If the device can initialize whilst connected to the dock using the initial settings wizard but not when unplugged from the dock, then the WiFi network could be flaky.</p><p>&nbsp;</p><p>(see ‘Stock Take using PDA Handheld.doc’ for more details)&nbsp;</p><p>&nbsp;</p><h2>POS Till: Logitech USB Camera Freezing Intermittently &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>Problem</strong></p><p>Camera freezing intermittently.</p><p><strong>Cause and Troubleshooting</strong></p><p>If there are any 3rd-party software programs or Microsoft processes claiming the device, the camera may tend to freeze up. The camera is plugged in via USB and uses either standard Windows Plug and Play drivers or device-specific drivers (e.g. Logitech).</p><p>Check that there is sufficient hard disk space and that they do not use Memberships through Back Office at the same time for example, because if trying to access the camera from the Till as well, there would be more than one program trying to claim the device and the camera image will either not be displayed or would freeze up.&nbsp;</p><p>If this is not the case, run an on-demand virus scan and shut down the computer on a daily basis to free up resources and try swap USB ports to eliminate such problems from happening in the future. This issue is not caused by the Merac software at all and there are no user/administrator-defined settings in Back Office that are used to allow integration with the camera.</p><p>&nbsp;</p><h2>POS Till: Cash Draw opening when cancelling a Transaction &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p>Aures POSligne devices (i.e. ODP100/200/333) are connected via serial and configured through their dedicated POS software and print faster than devices that may be attached via USB (i.e. this is because Windows attached receipt printers print more quality receipts in comparison to being serially attached).</p><p><strong>&nbsp;</strong></p><p>If an Cash Draw is plugged into a Aures POSligne printer connected via serial COM port and configured through their dedicated OPOS software. Both Printer and Cash Draw need to be defined in the software. When setup this way, the receipt printer will print receipts as and when needed and the Cash Draw will only open as and when needed.</p><p><strong>Reason</strong></p><p>If the Aures POSLigne printer is connected via USB, it can be setup through EpsonOPOS but needs to use TM-T88III drivers else it will not work. If the Cash Draw is plugged into the printer setup in this way, each and every time a transaction occurs even when the transaction is cancelled, the system will attempt to print a void receipt and the Cash Draw will open.</p><p><strong>&nbsp;</strong></p><p>Note!</p><p>Aures POSligne printers can only be setup as serial and USB printers within Aures OPOS software whereas Epson products can be setup as USB and serial through Epson OPOS software.</p><p>&nbsp;</p><p>Note!</p><p>For Windows attached receipt printers (e.g. Aures POSligne) which requires you to install the specific Windows print drivers from the vendors website, you can configure receipt printer as either a serial or USB printer (to be named as 'WINRECEIPT') and by so doing, the Cash Draw - if plugged into the receipt printer - will open each and every time a receipt is printed (i.e. whether a void/no sale or sale receipt is printed). Any paper that passes the printer will open the Cash Draw!</p><p><strong>Fix</strong></p><p>Plug the Cash Draw into the dedicated Cash Draw port at the back of the Till and configure the Till to use FTCD via Back Office/Till Configuration. Then Recreate Till Data and test.</p><p><br></p><h2>POS Till: Till not prompting to take a Photo of Existing Member when Membership Card Swiped &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>Solution</strong></p><p>Make Sure that the Membership Type in Back Office is setup with a mandatory option for ‘Photo’.</p><p>&nbsp;</p><p>&nbsp;<img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240263/original/L2YhTHp93geHXi9kj-jEvI2yuWuD_w6HTg.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240263\"></p><p>&nbsp;</p><p>Note that you cannot test swiping a Membership Card from training Till 999 to record membership entry. In other words, when swiping a membership card that does not have a photo setup, even though the above ‘Photo’ option is selected, the training Till will not prompt to take a photo if the photo is missing. As you can see from the Till Configuration window below in Back Office, this functionality only works for live Tills…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240262/original/XdXVRKIuXbs2uVnfy8eN3BXynuIsh-JTwQ.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240262\"></p><p>&nbsp;</p><h2>POS Till: MStoreUpdater or MeracUpdater not updating Merac system files &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p>In some circumstances, MStoreUpdater or MeracUpdater fails to update Merac system files (e.g. Formats folder missing on the local machine).</p><p><strong>Fix</strong></p><p>Log onto the Merac computer with the problem and then navigate to C:\\Program Files (x86)\\Merac\\updatenewver\\auth OR C:\\Program Files\\Merac\\updatenewver\\auth and delete <strong>PErrTrap.dll</strong>.</p><p>Then re-run MStoreUpdater or re-start MeracUpdater.</p><p>&nbsp;</p><h2>POS Till: Till receiving error that unable to access Photo folder for Memberships &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>Fix</strong></p><p>Close POS Till program</p><p>Inserted file://&lt;MeracServerName&gt; into <strong><em>Trusted sites</em></strong> in Internet Explorer and restarted POS Till program and log back in and tested&nbsp;</p><p>Should work now!</p><p>&nbsp;</p><h2>POS Till: More than one Voucher not Printing at Till &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p>If a customer has “Group Ticket Toggle” option enabled in System Options, if the till operator attempts to purchase more than one of the same Admissions voucher, the till will only print out one voucher as opposed to two or more depending on how much were purchased.</p><p><strong>Fix</strong></p><p>Find the PLU and then update the ticket design to include “unique ticket barcode” (PrintLayoutLine table pllMergeField value = ‘txnUniqueBarcode’) and then save the changes. Also make sure that Unique Tickets checkbox is selected for the PLU and Number per Ticket value set to ‘1’ and then Recreate Till Data and Update the tills.</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240266/original/CTjiehi2rlKWU7ECrOVdUDNO7MY0C90OmQ.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240266\"></p><p>&nbsp;</p><h1>Bookings &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h1><p>&nbsp;</p><h2>Bookings: Booking Error – Invalid use of NULL error &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p>When attempting to open a booking, receive a PMBOS “Invalid use of Null” error.</p><p>This is normally caused by either a booking created whereby afterwards, the PLU is deleted or the Bookable Resource Date and Time availability has not been defined correctly…</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240276/original/4EzOG9bgdJTB73w1lI7vAcQg-waDiW9zBQ.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240276\"></p><p><strong>Fix</strong></p><p>To identify if this is the case, from the ‘BKGDetail’ table, search for the booking RefNo. and if both ‘bkdResource’ and ‘bkdBCDId’ is set to ‘0’, delete this record from the database.</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240264/original/3wfOOU-OJSXbeB-0tgFLK-nIscS-jAb9lg.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240264\"></p><p>&nbsp;</p><p>If you then try to recall the booking from Back Office, you should be able to open the booking. The customer would need to review any Bookable Resources or PLUs added to the booking to determine their validity to prevent this error from re-occurring.</p><p>&nbsp;</p><p>Similarly, if you try to re-call a booking from the Till and receive the following error message – “PMStore Object variable or with Block variable not set: SellCurrentItem”…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240261/original/p4K6eg3ASi1B-6jiqabhqwHoiou4l-bfAQ.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240261\"></p><p>&nbsp;</p><p><strong>Fix</strong></p><p>Make sure that all Bookable Resources tied to the booking you are trying to re-call have PLU items that are not discontinued. If so, re-enable them and then Recreate Till Data and run an Update on all Tills.</p><p>&nbsp;</p><p>Other SQL Error Messages:-</p><p><strong>Index Out of Bound</strong></p><p>This usually occurs if no drop-down selection was chosen for the given window when setting up a booking.</p><p><strong>Invalid use of NULL</strong></p><p>An invalid use of NULL value being inserted into the booking</p><p>&nbsp;</p><h2>Bookings: Error Re-Calling Bookings from Till – “Item cannot be found in the collection corresponding to the requested name or ordinal” &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</h2><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240260/original/ghVMNO_MtI-1gBKQoLxtVSoNbBLX2aOGMQ.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240260\"></p><p>&nbsp;</p><p><strong>Troubleshooting</strong></p><p>If this is happening for all bookings – test by opening up training Till 999 from server and try search any random bookings.</p><p>Also check if you can open up the associated booking returning an error on the Till from Back Office.</p><p>&nbsp;</p><p>Note!&nbsp;</p><p>Below fix only applies to BO 3.14. If BO 3.15, the forms are held in the database so speak with Dave!</p><p>&nbsp;</p><p><strong>Fix</strong></p><p>If this is happening for all Bookings and opening up the booking from Back Office, everything is fine, then replace the <strong>Formats\\ FinfoForm.frm</strong> and <strong>FinfoForm.frx</strong> files with known working versions (i.e. perhaps from another customer whereby the Bookings window from the Till screen is similar – “Check with Dave on the appropriate customer to copy from!”)</p><p>Copy the two files to the Tills local C:\\Program Files (x86)\\Merac\\Formats\\STDXVGA folder renaming the old files and re-launch the Till and test.</p><p>If it works, then copy the two files to the servers MeracData share within Formats\\STDXVGA and then add any text to MeracData\\Formats\\Updates.txt file so that when you click on Update on the Tills, they will detect a change/modification made to the text file and re-copy all contents of the server version Formats folder to their local Formats folder…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240271/original/yhAZOeXBRKoQ6HHbpWQtmHal2sBexQoM9g.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240271\"></p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240280/original/C9LhVE9uZ4ULuPYXpV4NBjDu3NUM5bRamw.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240280\"></p><p>&nbsp;</p><h2>Bookings: Error Saving Bookings from Back Office – “Item cannot be found in the collection corresponding to the requested name or ordinal” &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p>Check that linked PLUs are not deleted and the date validity information is correct.</p><p>Turn on SQL database tracing (get Nik to do this) and then carry out the activity again to obtain trace related information&nbsp;</p><p>Run <strong>select * from dbo.trace</strong> on SQL Server to determine what data is being passed back to the <strong>MC_SaveBooking</strong> Stored Procedure.</p><p>&nbsp;</p><p>If the data being passed back to the stored procedure does not include certain field items that the Back Office Stored Procedure (MC_SaveBooking accessed in right-hand pane in Microsoft Visual Basic) is looking for, then the error would be presented.</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240265/original/XIPStyqWtNraeprSwurPm_hVh5P422a1qQ.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240265\"></p><p>&nbsp;</p><h2>Booking: Taking Booking Deposits from The POS Till &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>Problem</strong></p><p>‘Paid so Far’ amount in Bookings window showing differently to payment information in the Payment History window.</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240275/original/NvJPxU0WUNtbsin9U45c2-UpHEhG4xFzwA.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240275\"></p><p>&nbsp;</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240269/original/zmfw77DahbviX819J9cO569se-XhaFs8JQ.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240269\"></p><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>Detail that is sourced from the Payments table</strong></p></td></tr></tbody></table><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240272/original/d3KJxnMifvkW5yHO_ee4njYSFtlw7VY3Bw.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240272\"></p><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>Detail is sourced from txnDetail table</strong></p></td></tr></tbody></table><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>Detail is sourced from Payments table</strong></p></td></tr></tbody></table><p>&nbsp;&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>Confirmation of the amount charged against the Credit Card (Note! You would need to confirm what the Till receipt says and not take the above Payments table section details as gospel)…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240267/original/JtijhMJ5cO4b-DAPdXeJD4IzQkNjzxWpZQ.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240267\"></p><p>&nbsp;</p><p><strong>Details of TXN File:</strong></p><p>PAY,1,2,1,40354,3,20,0,,,************8437,,01 Mar 2018,,0,20,0,False,003153,62659413,16,,YESPAY,465946,,0,0,GBP,20,1</p><p>TAX,1,40354,1,E,40,0,0</p><p>&nbsp;</p><p><strong>Explanation</strong></p><p>In future when taking a Deposit for Booking, do not adjust the quantity from its default value of ‘1’ to another value other than this (in this case you changed it to ‘2’) because the POS Till program always expects a quantity of ‘1’ when taking a Deposit so when the payment was taken, it only took £20.00 instead of what you wanted it to charge (2 x £20.00). This is why the Paid so far showed £40.00 which reflects the details you entered into the till at the time of taking the deposit and the Payment History window only charged £20.00.</p><p>&nbsp;</p><h2>Bookings: Deposit added to wrong Booking &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>Requirements</strong></p><p>Change a deposit made for a booking from one booking to another - deposit of £20 needs to be moved from booking ref. 1544 to booking ref. 1558</p><p>&nbsp;</p><p>Before…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240281/original/3DaB9Et6MvEUXxRnPg0M5ZJsaIFpbqT8tQ.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240281\"></p><p>&nbsp;</p><p>Before…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240282/original/eRwOa8RsCBQndQchx_MfwwEvJCS7DtXIcA.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240282\"></p><p>&nbsp;</p><p><strong>Solution</strong></p><p>Because there is only one transaction linked to the original booking, simply rename the booking reference number for the given transaction to the correct booking reference number.</p><p>&nbsp;</p><p>Open SQL Server Management Studio and enter the following sequence of commands:-</p><p>&nbsp;</p><p>--select * from bkgHeader&nbsp;</p><p>--inner join bkgDetail on bkdRef = bkhref</p><p>&nbsp;</p><p>select * from bkgHeader</p><p>inner join TXNDetail on txnOrderNo = bkhRef&nbsp;</p><p>where bkhRef = 1544</p><p>&nbsp;</p><p>select * from TXNHeader</p><p>inner join TXNDetail on txnNo = txhno</p><p>where txnOrderNo = 1544</p><p>&nbsp;</p><p>begin transaction</p><p>update TXNDetail set txnOrderNo = 1558,&nbsp;</p><p>txnShortDesc = 'DEPOSIT Bk 1558',</p><p>txnLongDesc = 'DEPOSIT Bk 1558'</p><p>where txnOrderNo = 1554</p><p>commit</p><p>&nbsp;</p><p>After…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240286/original/8M3gwLF1qdQcdQPG5YdrzFM4EPJ9AG_-KQ.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240286\"></p><p>&nbsp;</p><p>After…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240288/original/NAIOLxHJIwJwYZ5gfY7BHJxCIsTIo2gD9w.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240288\"></p><p>&nbsp;</p><p>If you then click on Payment History for the booking 1558, you can see below that because the transaction was simple moved from booking 1544 to 1558, the attributes for the transaction have been retained (e.g. Date/Time that Credit Card Payment was made, Method of payment, Till No. from where the payment was made etc. which is useful for reporting purposes, etc.)…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240283/original/_RoZZUFNp_NINfsYhNw9DKwkJnmyO53w4w.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240283\"></p><p>&nbsp;</p><h2>Bookings: Booking Confirmation Letters not opening &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p>Example:-</p><p>Company: Bristol Zoo</p><p>‘\\\\10.0.0.159\\Meracdata\\Reports\\Group Bookings’</p><p>&nbsp;</p><p><strong>Solution</strong></p><p>Open MS Word and change security settings:</p><p><strong>Trust Center</strong>&gt;&gt;<strong>Trusted Locations</strong> – Add ‘local\\Program Files (x86)\\Merac’ and ‘\\\\&lt;Merac-Server&gt;\\MeracData’ as trusted sources</p><p>Allow docs on network to be trusted</p><p>Enable Macros</p><p>Disable Data Prevention Mode and Data Execution Prevention</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Uncheck all options circled below…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240273/original/O5w6ajB2RTbR3YZXw1VduBSOapvyyo3O2Q.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240273\"></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>Also when clicking on the <strong>Email Conf</strong> button to open a Booking Confirmation letter, if you receive <strong><em>‘cmdEmail_click’ program error</em></strong> when clicking on this button, as seen below…</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p>&nbsp;</p><p><strong>Troubleshooting</strong></p><p>Problem was identified to be caused by the email application (MS Outlook) not allowing a connections to the Merac Back Office app.</p><p>&nbsp;</p><h2>Bookings: Online Booking Payment Issue - Payment Setup Correctly in Back Office but not at the Till &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>Description</strong></p><p>If full payment was taken (and the Booking is in the future, the status will be changed to ‘Booked’) and then part of it refunded for a particular booking and then later the customer decides to amend the booking back to how it was (e.g. from 2 x 2 table - 1 x 2 table - 2 x 2 table) and despite booking when referenced from Back Office displaying the correct amount due, the Till is still showing that Full payment has already been taken even though was refunded previously to result in an amount still outstanding for payment.&nbsp;</p><p><strong>&nbsp;</strong></p><p><strong>Fix</strong></p><p>Recall booking from Till</p><p>Press on the <strong>Deposits</strong> button</p><p>When asked to take a Deposit select 'Yes' and then when asked would you like to Refund the deposit say 'No'</p><p>The items with the correct amount should display in the basket</p><p>Press the Sessions button if sessions are involved</p><p><strong>SubTotal</strong>&gt;&gt;select <em>Payment Method</em></p><p>&nbsp;</p><p>That should fix the issue.</p><p>&nbsp;</p><h2>Bookings: Booking Confirmation Letter Empty following Internet Booking Detail Change &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>Question</strong></p><p>What does an Internet Booking not have that a normal Booking does have?? The ’BookedBy’ attribute encircled below is &lt;BLANK&gt; because the booking was made by the customer and not the employee…</p><p><strong><br>&nbsp;</strong></p><p><strong>&nbsp;</strong></p><p><strong><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240274/original/Wa5P4wnLUz_tSKiivLnnXjUmLBm80Vux2w.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240274\"></strong></p><p>&nbsp;</p><p>This means that the ‘BookedBy’ field will be blank in the Employee table in SQL. When you attempt to make changes to the Booking from Back Office and try re-sent the letter from the <strong>Diary</strong>, you may find the email attached pdf Booking Confirmation letter contents is blank.</p><p>&nbsp;</p><p><strong>Fix</strong></p><p>Modify the Stored Procedure dbo.MC_BKCONF as seen below to prevent it INNER JOINING BKGHeader and Employee table on ‘BookedBy’ record data. Modify the procedure to LEFT JOIN Employee table to BKGHeader table in which case <u>all records</u> in left table (BKGHeader) will be returned even though there is no match on the right table (Employee). In this case, the procedure will still run and return results importing the data into the letter…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240278/original/BRxEHeeBNqcDaa6Nu0zDWLI_m5QKQqPevA.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240278\"></p><p>&nbsp;</p><p>&nbsp;</p><h2>Bookings: Block Bookings not showing in the Diary &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p>If Block Bookings (i.e. classed as Internet Bookings) is enabled as seen below, then ‘bkhIsInternet’ records will be set to NULL for each booking in ‘BKGHeader’ table which means that if you try and search for a booking in the Diary you will not find anything if you check either the ‘Bookings’ or ‘Show Internet Bookings’ radio button…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240277/original/biRMmjr4cUekJkkw4CGzyGQnmo_yXuduFg.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240277\"></p><p>&nbsp;</p><p>To fix this issue you will have to set all ‘bkhIsInternet’ records linked to an Internet Booking from NULL to ‘1’.</p><p>&nbsp;</p><p>Permissions for Block Booking…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240279/original/K-1CjDZhE6cbTboLwDEKoBnBr5stLsz4hQ.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240279\"></p><p>&nbsp;</p><h2>Bookings: Price Different when recalling a Booking to the POS Till &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a>&nbsp;</h2><p>If a booking has been created in Back Office and then you recall the booking to the POS Till, if the price is different, it is likely either an Everyone promotion is causing the price change or an Account Promotion or Membership Promotion or the admission that was purchased (e.g. at the beginning of the year), price is different to the price now due to the fact the admission ticket is seasonal (i.e. the price changes from season-to-season).&nbsp;</p><p><strong>Fix</strong></p><p>Simply log into Merac Back Office and open System Settings – uncheck the box “Recalculate Internet Price” from the Accounting tab.</p><p>Recreated Till Data and Update all tills.</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><h1>Sessions &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</h1><h2>Sessions: Sessions and Bookings – Unable to Delete Session/Tours &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>Problem</strong></p><p>If you open up Add/Edit Sessions/Tours within Back Office and attempt to delete session/tours assigned to a particular SessionType and receive the below error of “Please remove the individuals before cancelling”…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240284/original/iKvd8hTSaRTeDr1HOUIBEmh5Alrp9iGMHQ.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240284\"></p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240290/original/HWj5eYqdcY2jwRmbji8sbx6Y5J1mEnAbjg.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240290\"></p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240292/original/BGfKo5AxuW21pgQ6fujkBjOifIbDWvhiMg.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240292\"></p><p>&nbsp;</p><p><strong>Fix</strong></p><p>Open SQL and run the below series of commands to find the session related information and delete the offending entries. Then recreate the Sessions/Tours from Back Office Add/Edit Sessions/Tours…&nbsp;</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240285/original/w6vxytUOf40t6Zfdnw1Ol-5fWCTynJBGXw.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240285\"></p><p>&nbsp;</p><h2>Sessions: Seat Number Not Visible when Creating Sessionable Bookings &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p>If a Session has been defined to implement a Seating Plan, when creating a booking from Back Office, the Choose Seats button will only be visible after creating – saving and re-opening the booking.</p><p>&nbsp;</p><p><u>Steps</u>:-</p><p>Creating a Sessionable Booking from Back Office.</p><p>Select a valid date that the session/tour is available from the Diary and then click <strong>New</strong> button.</p><p>Select the appropriate <strong>Booking Type</strong> from drop-down.</p><p>Select the appropriate <strong>Source</strong> from drop-down.</p><p>Click ‘Tour/Sess’ radio button and then select the appropriate Session Type and Session/Tour Time Slot. Then double-click on the Session/Tour Time Slot to view the sessional PLUs associated to the Session Type and then highlight the PLU from the bottom PLU section and click <strong>Add</strong>…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240302/original/bJqNwNBbgUiaF6GPvockuQQR7WdjPJej6g.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240302\"></p><p>&nbsp;</p><p>Click <strong>Find Customer</strong> or <strong>New Customer</strong> button to add a customer to the booking and then click <strong>Save Bkg</strong> button…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240298/original/5aSdv-Q2dYv5RNaGSKYbT8GyN3-WKXPVdw.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240298\"></p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240294/original/3SWbWIREgrQvI1h7Pnadg5VPM81zPlpLVw.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240294\"></p><p>&nbsp;</p><p>Exit the booking and then go back into the booking.</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240295/original/8dNfb8ugoJpMItYehGc1fhQ6KZMbX68CvA.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240295\"></p><p>&nbsp;</p><p>The <strong>Choose Seats</strong> button is now available to allocate seats to the booking…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240305/original/MI7vCdbaoPf-9fSw2EXz_ltlpUQMCfYqCA.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240305\"></p><p>&nbsp;</p><h2>Sessions: Session Type not displaying correct Availability &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p>If items are sold on the internet and the Booking Template does not have the Style set to 'Session/Tours', then even though you&nbsp;</p><p>allow selling of sessions over the internet they will not record availability correctly.</p><p>&nbsp;</p><p>To check what items have been manually booked - open <strong>Add/Edit Session Tours</strong> and then open the calendar date for which the&nbsp;</p><p>Session Type has been defined and click Make Booking button. A list of all manually entered books will be displayed.</p><p>&nbsp;</p><p>If Internet Bookings are not showing up in the Session Detail report, make sure that the Booking Template to allow selling sessions on the internet has the Style set to 'Session/Tours'.</p><p>&nbsp;</p><h2>Moving a Session from one time slot to another from Back Office error &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</h2><p>When changing the time for an existing Session for a Booking, returns error below after saving changes:</p><p>&nbsp;</p><p>---------------------------------------------------- ADO Error ----------------------------------------------------</p><p>SQL Error Number: 23000: [Microsoft][ODBC SQL Server Driver][SQL Server]Cannot insert the value NULL into column 'sesSeq', table 'MStore.dbo.SessionBkgs'; column does not allow nulls. UPDATE fails.</p><p>Provider-specific Error Code: 515</p><p>---------------------------------------------------- ADO Error ----------------------------------------------------</p><p>SQL Error Number: 01000: [Microsoft][ODBC SQL Server Driver][SQL Server]The statement has been terminated.</p><p>Provider-specific Error Code: 3621</p><p>SQL Statement: exec MC_SaveBooking 'U', 31, 1, 14354, 2, 'Rock', '', 0, 1, 11, 0, '30 Nov 2014 16:15:00', '30 Nov 2014 16:30:00', &nbsp;'', '', '', 0, 'Mrs', 'Katherine', 'RH10 3PH', 'kapmert22@aol.com', 1, 1, 'B', 1, 31721, 'Roc31721 &nbsp; ', 'Rock', 1, '3 Oriel Close', '', '', '', 'Crawley', '', '07824530989', 'SAGEPAY-OK', '30 Dec 1899 10:30', '', '01 Jan 1900', 0, 0, 106, 41, '18 Nov 2014',8042,2,11494,1,0,'','',0,0,0,11</p><p>************</p><p>&nbsp;</p><p><strong>Solution</strong></p><p>Have manually added the required Sessions and then deleted the old ones and saved and this worked fine.&nbsp;</p><p>&nbsp;</p><h1>Footfall &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</h1><h2>Footfall: Recorded on the wrong Date for a given Till &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p>Moving Footfall figures from one date to another for a given transaction &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p>&nbsp;</p><p><strong>Scenario</strong></p><p>Till 2 opened at 14:48pm on Sunday the 14<sup>th</sup> recording 159 Children and 230 Adults and closed at 00:05am on Monday 15<sup>th</sup>.&nbsp;</p><p>(this Footfall was supposed to be recorded for Sunday the 14<sup>th</sup> figures - Receipt No. 2/149471)</p><p>&nbsp;</p><p><strong>Problem</strong></p><p>Till 2 had mistakenly recorded the above transaction on Monday instead of Sunday. Now Footfall on Sunday and Monday are showing incorrectly.&nbsp;</p><p>&nbsp;</p><p><strong>Requirements</strong></p><p>Move the Footfall for this given transaction from Monday to Sunday processed by the given Till.</p><p><strong>&nbsp;</strong></p><p><strong>Solution</strong></p><p>Log onto the Merac MStore BO System and then open the Tills screen and filter back to the respective dates for each Till in question. Then verify that these transactions actually occurred by double-clicking each Till and then select <strong>File</strong>&gt;&gt;<strong>View</strong> <strong>Transactions</strong>&gt;&gt;click <strong>Next</strong> button to step through each of the transactions. Easier method would be to run the Transaction Audit report to determine if the transaction was actually recorded.</p><p>&nbsp;</p><p>Open SQL Server Management Studio and enter the following sequence of commands:-</p><p>&nbsp;</p><p>select * from TXNHeader where txhTillNo = 2 and txhCompleted between '15 Sep 2014 00:00' and '15 Sep 2014 23:59'</p><p>--the above date of the 15 Sep 2014 would be Monday’s date</p><p>--two server transactions will be returned – Items added (‘X’ Children and ‘Y’ Adults) to basket and Till CashUp</p><p>--the items added to the basket has recorded a server transaction number of 534125</p><p>&nbsp;</p><p>/*below query is used to verify the footfall amount recorded against the server transaction number 534125 used to sell both the ‘Children’ and ‘Adults’ admission tickets which are set to record footfall*/</p><p>select * from Footfall where ftfTXNNo in (534125)</p><p>--below query is used just to verify the open transaction number within the CashDraw table</p><p>select * from CashDraw where csdOpenTXNNo = 534124</p><p>&nbsp;</p><p>begin transaction</p><p>update TXNHeader set txhStarted = DATEADD(d,-1,txhstarted), txhCompleted = DATEADD (d,-1,txhcompleted)</p><p>where txhTillNo = 2 and txhCompleted between '15 Sep 2014' and '15 Sep 2014 23:59'</p><p>commit</p><p>&nbsp;</p><p>begin transaction</p><p>update Footfall set ftfDateTime = DATEADD(d,-1,ftfdatetime)</p><p>where ftfTXNNo = 534125</p><p>commit</p><p>&nbsp;</p><p>Note!</p><p>Only PLU’s with Footfall set (i.e. pluFootfall = ‘1’ in the ‘PriceLookups’ table) will be recorded in the ‘Footfall’ table.</p><p>&nbsp;</p><p>--find the Open Transaction Number for the given Till from Tills screen in Back Office</p><p>begin transaction&nbsp;</p><p>update CashDraw set csdClosedAt = DATEADD(d,-1,csdClosedAt) where csdOpenTXNNo = &lt;OpenTXNno&gt;</p><p>commit</p><h3>&nbsp;</h3><h1>Promotions &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h1><p>&nbsp;</p><h2>Promotions: Promotion Save error – SavePromItems:’Violation of PRIMARY KEY constraint' &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p>Error details: SavePromItems:’Violation of PRIMARY KEY constraint 'PK_PromDetail'. Cannot insert duplicate key in object 'dbo.PromDetail'’.</p><p>&nbsp;</p><p>Promotions are applied on either an <u>Analysis Code Level</u> or on a <u>PLU Record Number Level</u> (PLURecNo). If you attempt to setup a promotion against an item that has already been setup from the sub AnalysisCode level, and then try and apply the promotion at the top-level AnalysisCode, SQL will attempt to save the promotion on a PLURecNo level as well which will result in the below SQL Statement error…</p><p>&nbsp;</p><p>===================================================================</p><p>Date and Time: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 30 Jun 2015 12:06:34</p><p>Operator: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;MJS</p><p>Error Source: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;PMBOS</p><p>Form/Object: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;FPromDetails</p><p>Sub/Function: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SavePromItems</p><p>===================================================================</p><p>&nbsp;</p><p>----------------------------------------------------- Error -2147217900 -----------------------------------------------</p><p>&nbsp;</p><p>Violation of PRIMARY KEY constraint 'PK_PromDetail'. Cannot insert duplicate key in object 'dbo.PromDetail'.</p><p>&nbsp;</p><p>===================================================================</p><p>SQL Statement: INSERT INTO PromDetail (proBranch, proRecNo, proAnzCode, proPLURecNo, proPercentage, proReduceBy, proNettPrice, proMBDeal, proBuynn, proGetnn) values (1, 4, '', 2699, 25, 0, 0, 0, 0, 0)</p><p>&nbsp;</p><p><strong>Solution</strong></p><p>Search for PLURecNo linked to the promotion record number (proRecNo) and delete it from the table.</p><p>&nbsp;</p><p>select * from PromDetail where proRecNo=4 and proPLURecNo=2699</p><p>delete from PromDetail where proRecNo=4 and proPLURecNo=2699</p><p>&nbsp;</p><p>&nbsp;</p><h1>Printing &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h1><h2>&nbsp;</h2><h2>Printing: Ticket printer fails to print &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>Problem</strong></p><p>Ticket printer not responding when trying to print tickets when Admission Tickets are sold from the Till. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p><strong>Solution</strong></p><p>First few things to check:</p><ol><li>Ticket printer is powered on.</li><li>Cables are attached securely on both ends and the data cable is plugged into the correct port/socket at the back of the Till.</li><li>The ticket roll is inserted into the printer correctly.</li></ol><p>&nbsp;</p><p>If not, the print queue name may be named differently to the name set in the Merac BO System configuration.&nbsp;</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <strong>BOCA Ticket Printers</strong></p><p>Usually for a BOCA Ticket printer, the name configured in the Merac BO system is BOCA, so renaming the print queue to ‘BOCA’ would fix the issue.</p><p>BOCA Ticket printers are USB attached so install themselves through Windows PnP.</p><p>Once installed, rename the printer correctly through Devices and Printers and set the size of the Tickets being printed. (Each customer has a predefined form that defines these dimensions!)</p><p>&nbsp;</p><h2>Printing: BOCA Ticket Printer printing blank tickets &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>Solution</strong></p><p>Size settings have not been configured correctly in Printer Properties.</p><p>Open Printer Properties and click <strong>General</strong> tab&gt;&gt;<strong>Preferences</strong>&gt;&gt;<strong>Advanced</strong> and ensure that the correct Paper/Output Paper Size settings are defined. If a form has been defined, select the appropriate form from the dropdown menu.</p><p>From Printer Properties, click <strong>Advanced</strong>&gt;&gt;<strong>Printing Defaults</strong>&gt;&gt;<strong>Advanced</strong> and ensure that the correct Paper/Output Paper Size settings are defined. If a form has been defined, select the appropriate form from the dropdown menu.</p><p>(this would propagate changes to Printer Properties&gt;&gt;General tab&gt;&gt;Preferences&gt;&gt;Advanced)</p><p><strong>&nbsp;</strong></p><p>Example:-</p><p>Size Settings have been saved as “Alnwick ticket” named form in the below example…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240287/original/b7FIrCuegLZooUuKqXvM07UxW7vtn_ByXw.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240287\"></p><p>&nbsp;</p><p>Note!</p><p>The older model BOCA uses a different PLU Ticket Design to the newer model BOCA. It is thus essential to define two different Ticket Designs each with different BOCA ‘Paper Size Profiles – Forms’.</p><p>&nbsp;</p><h2>Printing: Barcode Labels not printing &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p>If a label printer is printing a barcode incorrectly and the Stock item barcode has a ‘0’ to the front of the barcode, try changing the symbology to correct this.</p><p>&nbsp;</p><h2>Printing: Barcodes Printing Issue - Epson TM-L90 appending a ‘0’ to the beginning of an EAN13 barcode &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>Fix</strong></p><p>On the Merac computer in question, search for the Stock item in Back Office and click <strong>Print Barcode</strong> and then uncheck the box to ‘Manually choose barcode symbology’ (this adds a ‘0’ to the beginning of the barcode) and then close the window and then click <strong>Print</strong> button.</p><p>&nbsp;</p><h2>Printing: Unable to print to a Network Printer &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p>When configuring network attached printers whereby the printer is installed on a print server, if the printing device is removed, the POS Till may return the following example error message when attempting to print…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240306/original/O-0jlcbrgzQFFWm2g_j2E3-P-4hqLl6XHQ.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240306\"></p><p>&nbsp;</p><p>(It’s a kitchen receipt printer so it is possibly an EPSON TMU220 or TMU230)</p><p>&nbsp;</p><p><strong>Troubleshooting</strong></p><p>If the replacement printer has been plugged in using an Ethernet cable, get the user to print a configuration page on the printer to obtain the IP Address of the new printer.</p><p>&nbsp;</p><p>A utility installed on the server called <strong>Epson TMNet WinConfig</strong> is used for network device discovery by MAC Address for attached or previously attached Epson printers.&nbsp;</p><p>&nbsp;</p><p><strong><em>Start</em></strong>&gt;&gt;<strong><em>All Programs</em></strong>&gt;&gt;<strong><em>EpsonNet</em></strong>&gt;&gt;<strong><em>TMNet WinConfig</em></strong>&gt;&gt;launch ‘TMNet WinConfig Ver.3’&nbsp;</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240291/original/ok1k7NFCbKXN1scbhzAJG3SFu1wKKBVIbA.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240291\"></p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240289/original/3mYiKygghu1axGJR2SXoZL1ACAaZcuQJCw.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240289\"></p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240300/original/9H7hIDP4Q7RXaNryFooBwVfD6T-zZ2jacA.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240300\"></p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240297/original/1FBVGq_NLf_r95KDD9SV1ntAstrrItNBqQ.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240297\"></p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240303/original/xger4EjRnnIs8khIgWtLNhQTCiIHtn_-5g.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240303\"></p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240296/original/kCN2vVf4diMUBM5biE96aOylhm15brWbOg.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240296\"></p><p>&nbsp;</p><p>If Epson TMNET WinConfig is installed on the server, from TMNet WinConfig, click on <strong>Ethernet</strong> in the left-hand pane and then ping each IP Address to determine which is not pingable. This will more than likely be the old device that has been removed. Highlight the old printer IP Address and click the <strong>Configuration</strong> button and then <strong>TCP/IP</strong> tab and change the IP Address to match the new IP Address. This will force TMNet WinConfig to assign the correct IP Address to the network attached printer.&nbsp;</p><p>Now on the Till, delete and re-add the shared printer or re-edit the old printer setup through ‘Devices and Printers’ and change the IP Address to the new IP Address.</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240313/original/jiufC4hzZ-yKCEG12ld1y0EXZkuiYaArNA.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240313\"></p><p>&nbsp;</p><p>Now use this information to determine which shared printer the IP Address is associated on the server within ‘Devices and Printers’ because you will need this later to re-add the shared printer back onto the Till.&nbsp;</p><p>A utility installed on the server called <strong>Epson TMNet WinConfig</strong> is used for network device discovery by MAC Address for attached or previously attached Espon printers.&nbsp;</p><p><strong><em>Start</em></strong>&gt;&gt;<strong><em>All Programs</em></strong>&gt;&gt;<strong><em>EpsonNet</em></strong>&gt;&gt;<strong><em>TMNet WinConfig</em></strong>&gt;&gt;launch ‘TMNet WinConfig Ver.3’&nbsp;</p><p>&nbsp;</p><p>If Epson TMNET WinConfig is installed on the server, from TMNet WinConfig, click on <strong>Ethernet</strong> in the left-hand pane and then highlight the old printer IP Address and click the <strong>Configuration</strong> button and then <strong>TCP/IP</strong> tab and change the IP Address to match the new IP Address. This will force TMNet WinConfig to assign the correct IP Address to the network attached printer.&nbsp;</p><p>Now on the Till, delete and re-add the shared printer or re-edit the old printer setup through ‘Devices and Printers’ and change the IP Address to the new IP Address.</p><p>The kitchen receipt printer should now be able to print.</p><p>The problem printing should now be resolved!</p><p>&nbsp;</p><h2>Printing: Unable to print Receipts from Tills screen in Back Office. ‘Invalid use of NULL’ error &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p>Error details below:-</p><p><strong>=</strong></p><p><strong>Date and Time: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 31 Jul 2015 09:44:43</strong></p><p><strong>Operator: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;MEL</strong></p><p><strong>Error Source: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PMBOS</strong></p><p><strong>Form/Object: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;FViewTXN</strong></p><p><strong>Sub/Function: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ShowTXN</strong></p><p><strong>=</strong></p><p><strong>&nbsp;</strong></p><p><strong>- Error 94&nbsp;</strong></p><p><strong>&nbsp;</strong></p><p><strong>Invalid use of Null</strong></p><p><strong>&nbsp;</strong></p><p><strong>=</strong></p><p>&nbsp;</p><p>You can print receipts for other Tills. For the offending Till in Till Configuration, you will notice no Receipt Design defined in ‘Alt Default Till Documents’. If there is no receipt printer setup you cannot set a Receipt design from Till Configuration so to get around this, do the following…</p><p>&nbsp;</p><p><strong>Solution</strong></p><p>select * from Tills</p><p>&nbsp;</p><p>begin transaction</p><p>update TillS set tilReceiptDoc = 1</p><p>where tilReceiptDoc is null</p><p>commit</p><p>&nbsp;</p><h2>Printing: Failed to claim OPOS Receipt Printer &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p>If still not able to print and you get the following error messages when opening up the POS Till program…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240307/original/tudrIPzKaK3oHdr0IO9eCtz7zox5PnVLdg.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240307\"></p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240299/original/Xlq8MGBYDT2oTRUteesaRXJyrR99p4lxlQ.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240299\"></p><p>&nbsp;</p><p>First try close down both Merac Back Office system and POS Till program and then open OPOS and try run a health check. If this fails, the print device could very possibly be plugged into another COM port not configured to the device defined in OPOS or it could be attached to a USB port in which case device would be regarded as defunct in OPOS and not considered at all when getting the printer to work.</p><p>To check if the printer is attached to a USB port, open <strong>Devices and Printers</strong> and you may find a printer in the list with a random device Make/Model name which has been installed automatically by Windows which you will then have to rename to WINRECEIPT. Then open the Merac Back Office system&gt;&gt;<strong>Till Configuration</strong>&gt;&gt;<strong>Receipt/Slip Printer</strong> and set to WINRECEIPT. Recreate Till Data and test printing.</p><p>Now when opening up the OPOS Till software, no error message will be displayed and you should be able to print.</p><p>&nbsp;</p><h2>Printing: Permissions error when trying to print a Purchase Order &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>Sales/Purchase Orders –</strong>These are online purchases of Stock.</p><p>&nbsp;</p><p>If you try and print the below Sales/Purchase Order Picking List and receive a permissions error as seen below…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240311/original/tF7Ngdpn7C7IH8KriQnZbYcOWWCOJm9-3A.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240311\"></p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240293/original/HBNXKOSFmczC9SpNJCmdT5xR4Jx3OYb3zQ.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240293\"></p><p>&nbsp;</p><p><strong>Fix</strong></p><p>Check that the report is in the Reports folder (PickingList.rpt) and if not, import it from Back Office which should fix the issue.</p><p>&nbsp;</p><h1>Accounts/Customers &amp; Memberships &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h1><p>&nbsp;</p><h2>Accounts|Customers|Memberships: Unable to Void New Member entered through Till &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p>If you open a Till and click Memberships\\New Member button to open the MStore Membership Wizard and add a new membership, a membership card and welcome letter will be printed after which you will then need to swipe the membership card and enter in the Joining Fee and Entry items to basket and then make payment.</p><p>Note!</p><p>You cannot void the transaction once the new member has been entered into the Till without completing the transaction. If you do you will receive the following “lock error”…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240301/original/MAgXa5xu9Fv7Gfc2CIYhN-A7nfQWZc9RTw.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240301\"></p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240304/original/k4zH9tRquCn44S7GyIBiEgZ2bp8qTLulvw.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240304\"></p><p>&nbsp;</p><p><strong>Fix</strong></p><p>To get around this, the Till operator would need to complete the transaction and then carry out a Refund of the receipt to balance the Till and then open Back Office and find the member by searching the associated membership number and either set the Expiry to yesterday’s date or simply delete the membership from Back Office.</p><p>&nbsp;</p><p>When adding a member from the Till, the Till expects payment at the end of each transaction so if this is not required, best is to add the member from Back Office.</p><p>&nbsp;</p><h2>Accounts|Customers|Memberships: GiftAid Signature outside of MinMax Date Range &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>Problem</strong></p><p>When attempting to open a member from Back Office, the system returns the following error message…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240317/original/SA6AqKHJbz_QLGFRbcU51CH20-j-OO3yog.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240317\"></p><p>&nbsp;</p><p><strong>Error Details-</strong></p><p><strong>===================================================================</strong></p><p><strong>Date and Time: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 23 Sep 2015 12:55:10</strong></p><p><strong>Operator: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PR</strong></p><p><strong>Error Source: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;PMBOS</strong></p><p><strong>Form/Object: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FCustIndex</strong></p><p><strong>Sub/Function: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;OpenMember</strong></p><p><strong>===================================================================</strong></p><p><strong>&nbsp;</strong></p><p><strong>----------------------------------------------------- Error 35773 -----------------------------------------------------</strong></p><p><strong>&nbsp;</strong></p><p><strong>A date was specified that does not fall within the MinDate and MaxDate properties.</strong></p><p><strong>&nbsp;</strong></p><p><strong>===================================================================</strong></p><p><strong>SQL Statement:&nbsp;</strong></p><p><strong>select isnull(pvtAdoptBCDID, 0) as pvtAdoptBCDID from PrivilegeSchemes where pvtBranch = 1 and pvtCode = (select prvCode from AccPrivilege where prvBranch=1 and prvAccRecNo=5744 and prvCusSeq=1)</strong></p><p><strong>===================================================================</strong></p><p>&nbsp;</p><p><strong>Fix</strong></p><p>select * from Account where accGiftAid = 1 and accGiftAidSigned = '1899-12-30 00:00:00.000'</p><p>&nbsp;</p><p>begin transaction</p><p>update Account set accGiftAidSigned = GETDATE() where &nbsp;accGiftAid = 1 and accGiftAidSigned = '1899-12-30 00:00:00.000'</p><p>rollback</p><p>--commit</p><p>&nbsp;</p><h2>Accounts|Customers|Memberships: Unable to add new Contacts to a Customer Account &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p>When Customers are imported into Merac, the system returns error “<strong><em>This key is already associated with an element of this collection</em></strong>” when trying to add a Contact,</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240308/original/S_0IsfFVPyY8HHx1U7b1SsH9PC9RU4DBOQ.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240308\"></p><p>&nbsp;</p><p><strong>Troubleshooting</strong></p><p>Check to see whether the import has failed to set the Account.accLastCustSeq field to match the highest cusSeq on that account.&nbsp;So it assumed the next customer on the account would be cusSeq=1 which exists of course so it goes bang.</p><p>&nbsp;</p><h1>Reports &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h1><p><strong>&nbsp;</strong></p><h2>Reports: Error – Failed to retrieve data from the database &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>Problem</strong></p><p>Receive the following error message when trying to run a report…</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p><strong>Solution</strong></p><p>One of the SQL data entries extracted from the database had a character length which was a bit too long for the report so had extended these fields.</p><p><strong>&nbsp;</strong></p><h2>Reports: Error – ‘FRepParams / ExportData error’ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>Problem</strong></p><p>When trying to run a Transaction Analysis Report, the Back Office computer returns the following error message ‘FRepParams/ ExportData’ error.</p><p><strong>Troubleshooting &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</strong></p><p>First log onto the Merac server and open <strong><em>SQL Management Studio</em></strong> and try and run the SQL statement given in the error message to determine what the cause of the error is. In the below example you can see that REP_TXNANALYSISNOMINALCODES expects an additional parameter called ‘OUTLET’ which is not available or is missing in the report.</p><p>&nbsp;</p><p>Example:-</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240316/original/0npovQdLij5GV0vnj0lLnNEX1jC7TYPpyQ.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240316\"></p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240318/original/1nXG5iBZVrf-C6AoBr72L93a3tyLcKqDcw.png?1687277421\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240318\"></p><p>&nbsp;</p><p>Try run the report from the server from Back Office and if it works then the local report (.rpt) file on the Back Office computer is out-of-date.</p><p>To verify if the report is out of date, from the SQL Server, expand <strong>Programmability</strong> container within the SQL database tree and navigate to ‘TXNAnalysisNOM dbo procedure’ (i.e. dbo.REP_TXNANALYSISNOMINLACODES) under <strong>Stored Procedures</strong>. Take out the code and create a new query and press F5 to execute and see whether the report is displayed correctly without errors on the server. If it is, then the report must be out-of-date on the Back Office computer that was used to run the report.</p><p>&nbsp;</p><p>Note!</p><p>If you do not find anything obvious causing of the error when running the SQL statement on the SQL server, check the Application Event Log from where the statement was run for more details as it could be an issue with the installation of Crystal Reports locally.</p><p>&nbsp;</p><p><strong>Solution</strong></p><p>1)On the Till in question, open Merac MStore BO System&gt;&gt;Reports&gt;&gt;Transaction Reports&gt;&gt;Update (Note! The update process may take a while to complete with no clear indication that anything is happening until you see the “<em>All reports updated successfully</em>” message) and then try re-run the report.</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240314/original/5OBnOE7gxCNojysG4FGD1X7Re0nYarMkRQ.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240314\"></p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240315/original/513cxObsN_gvsuHlZ7FrtIfU2T1RN0c02w.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240315\"></p><p>&nbsp;</p><p>OR</p><p>&nbsp;</p><p>2)Delete C:\\Program Files\\Merac\\Reports\\TXNAnalysisNOM.rpt or C:\\Program Files (x86)\\Merac\\Reports\\TXNAnalysisNOM.rpt and then try re-run the report.</p><p>&nbsp;</p><p>Note!</p><p>If there is still an issue, it could be a local permissions issue.</p><p>&nbsp;</p><h2>Reports: Error – ‘One or more fields could not be found in the result set. Use verify database to update the report’ &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p><u>Steps</u>:-</p><p>Log onto the Merac Server and navigate to Meracdata\\Reports directory and verify the offending report file version (i.e. .rpt file modified version date) and compare it to the local copy. If heavily out-of-date, copy ours or a known working version over to customer’s server within Meracdata\\Reports.</p><p>Open <strong>SQL Management Studio</strong> localhost&gt;&gt;navigate to by expanding the following containers - <strong>Databases</strong> - database name (e.g. MStore) - <strong>Programmability</strong> - <strong>Stored Procedures</strong>.</p><p>(search for the appropriate dbo.xxxx Stored Procedure for the report and right-click and choose <strong>Modify</strong> to view the code)</p><p>Check the <em>Change History</em> comments field at the top of SQL code to compare date with another customer’s Stored Procedure and if out-of-date, overwrite the broken version by doing the following – copy and paste all the code onto the server from where the problem is reported, remove the header lines in the code, highlight all the code copied and click the <strong>Execute</strong> button and make sure the command executes successfully…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240310/original/xiowufL6mF_GfrJ_sJwI4uZI7XA4Ewge_g.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240310\"></p><p>&nbsp;</p><p>Try re-run the Report again from the BO System.</p><p>&nbsp;</p><h2>Reports: Update Reports &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p>(for 3.14 and 3.15 alike)</p><p>Copy over a known good version report file to the Desktop on the server.</p><p>Run good version Stored Procedure.</p><p>Delete the existing report from Merac Back Office to remove the record from SQL Reports table.</p><p>Import the .rpt file saved on the Desktop. This process will insert a new record into the SQL Reports table and copy the report into Meracdata\\Reports.</p><p>Click <strong>Update</strong> to copy the new report file to the local Merac\\Reports folder.</p><p>Repeat the Update procedure on each and every client to update their report version locally. This process will copy down the latest version from Meracdata\\Reports.</p><h2>&nbsp;</h2><h2>Reports: Crystal Reports .rpt File Not Found error &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>Solution</strong></p><p>From SQL, use the select statement to view all contents of the Reports table and then verify the name of the report and then delete the entry and then from any client (i.e. Back Office computer), re-import the report file back into Back Office/Reports which should then update SQL Reports table with a new entry of the report.</p><p>&nbsp;</p><p>Example:-</p><p>select * from Reports where repTitle = 'Member Visits'</p><p>&nbsp;</p><p>begin transaction</p><p>delete from Reports where repTitle = 'Member Visits'</p><p>commit</p><p>&nbsp;</p><p>Check that the ini file DataPath is setup correctly.</p><p>Check that the Reports folder location is setup correctly from Back Office&gt;&gt;System Options&gt;&gt;General tab</p><p>From the client (Merac Back Office computer), navigate to the local Reports directory and rename the existing report file (.rpt) and then navigate to Back Office/Reports and then click <strong>Update</strong> button to update all reports stored in the Merac Server Reports folder. This will automatically update the Reports table in SQL with the report entry recently deleted from the table and should also copy across an up-to-date version of the report file from server to the client.&nbsp;</p><p>If the Report is not visible in Back Office/Reports, click <strong>Import</strong> button to import the report into Merac Back Office system, which it would be, since we deleted it from the reports table in SQL.</p><p>Done!</p><p>&nbsp;</p><h2>Reports: Export Error - ODBC driver does not support the requested properties &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p>Example:-</p><p>The above error is referring to running the Footfall report.</p><p><strong>&nbsp;</strong></p><p><strong>Troubleshooting</strong></p><p>SQL Statement:</p><p>exec REP_FOOTFALL 0, 0, 0, 0, 0, '01 Oct 2014 00:00:00', '30 Oct 2014 23:59:59'</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240312/original/sCLSdwJ_nkA9Eg9kLe7W9VTuPlf61LDBRA.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240312\"></p><p>&nbsp;</p><p>By examining the code of the report in Crystal Reports, in the above example, &nbsp;the Stored Procedure is passing 8 parameters but the actual Crystal Reports file (.rpt) is expecting only 7 parameters passed to it by the Stored Procedure.</p><p>&nbsp;</p><p><strong>Solution</strong></p><p>In the above you can see that the Stored Procedure @DATERANGE parameter has been commented out and then you just declare a value to the variable as seen in the second part of the exhibit encircled above since the crystal report file is not passing this parameter to the Stored Procedure so the Stored Procedure does not know what to do with this additionally defined parameter. Then Execute the Stored Procedure to recompile it and then this should fix the issue.</p><p>&nbsp;</p><h2>Reports: Unable to run any Reports - Returning SQL error – FRepParams/InvokeRepParams &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240309/original/WuFLYDyUEGcHM1y5s2N9466N3udp6p2qIg.png?1687277420\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240309\"></p><p>&nbsp;</p><p><strong>Solution</strong></p><p>Have fixed this by updating the local MStore.ini path to point to the correct location of the local Merac installation folder.</p><p>&nbsp;</p><p>If the exact same error is returned as seen above except that the error also mentions a Permissions Error, ensure that the <em>Everyone</em> group is granted Full Permissions to C:\\Program Files (x86)\\Merac (for Back Office 3.14 or below) or C:\\ProgramData\\Merac (for Back Office 3.15).</p><p><br></p><h2>Reports: Reports taking a long time to load and display &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>Troubleshooting</strong></p><p>First try delete the local reports file and then re-run the report.</p><p>Secondly, try run the report from the server and if there are issues, copy and run a known working store procedure for the given report (e.g. txnanalysis.rpt) from another known working customer server and run the SQL Code for the procedure on the SQL server to update its procedure with a known working version.&nbsp;</p><p>Re-run the report and it should work.</p><p>&nbsp;</p><h2>Reports: Very slow when running any Reports &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>Problem</strong></p><p>Merac Back Office system crashes or takes a very long time to complete (e.g. 10 mins as opposed to 25 secs to run a report).</p><p><strong>Troubleshooting</strong></p><p>Tried running this from the server and the same problem occurs. Hour glass appears and Back Office system hangs.</p><p>Checked resources and CPU is fine and working/dynamic memory availability is fine…</p><p>&nbsp;</p><p>&nbsp;<img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240582/original/5TDAJLs05ZQNz8sL2YQilya6cQ-OV3BcBg.png?1687277509\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240582\"></p><p>&nbsp;</p><p><strong>Solution</strong></p><p>This matter has been solved by increasing the amount of SQL Server memory allocation and configuring the SQL Server to use dynamic memory for Indexing.</p><p><u>Steps</u>:-&nbsp;</p><p>Open ‘SQL Server Management Studio’ and right-click the top level and select <strong>Properties</strong>&gt;&gt;<strong>Memory</strong> and make the below adjustments…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240576/original/39Zij7zY8JiVC8yALRZdNuVIpQGxXoC02Q.png?1687277509\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240576\"></p><p>&nbsp;</p><p>Now restarted the SQL Server service – open ‘SQL Server Configuration Manager’ and then click on <strong>SQL Server Services</strong> and restart SQL Server (MSSQLSERVER)</p><p>&nbsp;</p><p>Note!</p><p>Best practice to stop and then restart the SQL Server service.</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240573/original/Ft9SRqsWHh3AkBNqeoeVUGAytqbOTc41Wg.png?1687277509\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240573\"></p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240575/original/RBQ4Nc6NfcP6dKt4nqg71xTZuaOeOMPRpg.png?1687277509\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240575\"></p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240584/original/AKNqyFC6QQRuw-2szRhoMEMOgrNUoHZaOQ.png?1687277509\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240584\"></p><p>&nbsp;</p><p>Now reconnect back to the database by clicking <strong>Connect</strong>&gt;&gt;<strong>Database Engine</strong> and log back on…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240580/original/_39hAGRSiFtGABTm4HKrI4eHQvGiap0eEg.png?1687277509\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240580\"></p><p>&nbsp;</p><p>Try re-run the report through a new query and see if there is any improvement on the response time</p><p>(e.g. REP_BOOKINGS 1, '24 Sep 2014', '30 Sep 2014', 0, '')</p><p>&nbsp;</p><p>Other Important Information regarding SQL Server Management Studio encircled below…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240578/original/kI17G1wHnjzP7kFxP1Of4VdryBm1gs_81A.png?1687277509\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240578\"></p><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>In the highlighted Management folder within Microsoft SQL Server Management Studio tree structure, normally there is an additional Indexing Tool that allows you to defrag database Indexing.</strong></p></td></tr></tbody></table><p>&nbsp;&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>SQL command:</p><p>sp_who</p><p>--command outputs who is logged onto the SQL Server database</p><p>&nbsp;</p><p>Note!</p><p>As more and more reports are run on the SQL Server, so the temp Reports table grows larger and larger in size and hence may hinder the performance on running reports. To fix this issue, either restart <strong>SQL Server service</strong> and the <strong>SQL Agent service</strong> (used for monitoring and maintenance purposes) or last resort, restart the SQL Server, which should return the size back to its default size (file name is temp.db).</p><p>&nbsp;</p><h2>Reports: Back Office crash following running a report for version 3.14 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>Problem</strong></p><p>Client or Server Back Office installation crashes following clicking ‘Screen’ button to run and view the contents of the report and then closing it.&nbsp;</p><p><strong>Solution</strong></p><p>Try run a repair of Merac Back Office which should fix the issue. If however, you receive the following ‘Business Objects Enterprise secldap.dll’ error during the repair, copy over the offending dll from a known working computer (located in either C:\\Windows\\System32\\ and/or C:\\Windows\\System32\\SysWOW64 folder) and place it in the path location specified by the error seen below…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240579/original/VU31cO4J8enus_EME2ZIxPEUUUzvVQk-Cw.png?1687277509\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240579\"></p><p>&nbsp;</p><p>Re-run the repair again. If it still complains that the dll has not been registered, ignore the error and once the installation is complete, open Back Office and login and then see if you can run a report. If you can, all is OK and working as it should.</p><p>&nbsp;</p><p>Rename the DLL USP10.DLL to _USP10.DLL.Old. This DLL is located in the following places:</p><p>&nbsp;</p><p>32 Bit Operating System</p><p>C:\\Program Files\\Common Files\\Business Objects\\3.0\\bin</p><p>C:\\Program Files\\Common Files\\Microsoft Shared\\OfficeXX</p><p>&nbsp;</p><p>64 Bit Operating System</p><p>C:\\Program Files (x86)\\Common Files\\Business Objects\\3.0\\bin</p><p>C:\\Program Files (x86)\\Common Files\\Microsoft Shared\\OfficeXX</p><p>&nbsp;</p><p>Done!</p><p>&nbsp;</p><h2>Reports: Data Extract error or Report error – Subscript out of range &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p>&nbsp;</p><p>&nbsp;</p><p><strong>Solution</strong></p><p>Open Excel and change “Include this many sheets” dropdown from 1 to 3 as seen below and then try and run the Data Extract again…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240596/original/Cd-aDeDaVGiJYChQbshQ50ZLNwYB96sE3Q.png?1687277509\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240596\"></p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240595/original/zYymSYoahbH_b9boy8-5w-Wi-R5mP21dyQ.png?1687277509\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240595\"></p><p>&nbsp;</p><h2>Reports: Seating Plan Report returning an error &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>Troubleshooting</strong></p><p>Review the Stored Procedure code and to determine what is causing the issue.</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240589/original/Byb-1WNCBQHzjU8TPb-jb70uujiMzkgyDQ.png?1687277509\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240589\"></p><p>&nbsp;</p><p>Looking at the two temp tables setup in the Stored Procedure…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240581/original/3FDLr4szUpztd-W0YHif0R54_XDtSHFJhA.png?1687277509\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240581\"></p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240587/original/upSii76KmE4OFDtS6l7bwKD3mhQCuRgkNQ.png?1687277509\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240587\"></p><p>&nbsp;</p><p>…all columns/fields are set to ‘NOT NULL’ which means the value “NULL” cannot be returned into the table.&nbsp;</p><p>&nbsp;</p><p>When you run the insert subqueries for both #tblJourneyDetails and #tblBookingDetails, you can see a NULL value is returned for both jdSeatingPlanDesc and bdBkhRef…</p><p>&nbsp;</p><p>--select * from LookupGroups</p><p>--where lkgDescription like 'Booking Types%'</p><p>--select * from Lookups</p><p>--select lkudescription from Lookups&nbsp;</p><p>--where lkuGroupCode = 8</p><p>&nbsp;</p><p>--insert into #tblJourneyDetails&nbsp;</p><p>select&nbsp;slcJourneyLine, left(lkuDescription, 30), shdRecNo, shdDescription, substring(convert(varchar(20), shdDateTime, 113), 13,5), slcDescr, sphDescr from SessionHdr</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inner join SessionLocations on shdBranch = slcBranch and shdSesLocId = slcSesLocId</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inner join Lookups on slcJourneyLine = lkuRecNo</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; left join SeatingPlanHeader on shdBranch = sphBranch and shdSeatingPlan = sphPlanId</p><p>-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; where shdDateTime &gt;= @FDatetime and shdDateTime &lt; @TDatetime</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; where shdDateTime &gt;= '7 Dec 2014 00:00' and shdDateTime &lt; '8 dec 2014 00:00'</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240583/original/4bcpUhYCiilgpNLmdSnKCrYFpWlut5kRsg.png?1687277509\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240583\"></p><p>&nbsp;</p><p><strong>Solution</strong> = removed NOT NULL from jdSeatingPlanDesc where temp table #tblJourneyDetails is created.</p><p>&nbsp;</p><p>--insert into #tblBookingDetails&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; select distinct shdRecNo, bkdRef, accName, '', '', convert(varchar(255), bkhNotes) from SessionBkgs</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inner join BKGDetail on sesBranch = bkdBranch and sesbkhRef = bkdRef and sesBkdSeq = bkdSeq</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inner join BKGHeader on bkhBranch = bkdBranch and bkhRef = bkdRef</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inner join Account on sesBranch = accBranch and sesAccRecNo = AccRecNo</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inner join BarCodes on bkdBCDId = bcdId</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inner join PriceLookups on pluBranchNo = sesBranch and pluRecNo = bcdPLURecNo</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inner join SessionHdr on sesBranch = shdBranch and sesshdRecNo = shdRecNo</p><p>-- &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; where shdDateTime &gt;= @FDatetime and shdDateTime &lt; @TDatetime and pluPriceBand = 1</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; where shdDateTime &gt;= '7 Dec 2014 00:00' and shdDateTime &lt; '8 dec 2014 00:00' and pluPriceBand = 1</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240586/original/JjSECbuVO_HNM0DU06N5f6_NmZ38KmiG6Q.png?1687277509\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240586\"></p><p>&nbsp;</p><p><strong>Solution</strong> = removed NOT NULL from ‘bdBkhRef’ where temp table #tblBookingDetails is created.</p><p>&nbsp;</p><h2>Reports: Determining Discrepancy with FootFall Analysis Report and Actual Footfall &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p>In the FootFall Analysis report, the FootFall column is the actual sum of ‘ftfQty’ and ‘ftfFootfall’ from the Footfall table between the given dates…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240593/original/tHyPiJ2P-fTRXt6T4sA3N3HtGU-yQzyDQQ.png?1687277509\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240593\"></p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240599/original/zG2eN8r08osWd8zKaQqiVG6_zuZlfzjZQg.png?1687277509\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240599\"></p><p>&nbsp;</p><h2>Reports: Promotions report – duplicate Promotion Descriptive Names &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</h2><p>&nbsp;</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240594/original/_X-tQQSsY-6jBGtK3xgOEGYBbniy-cEuWQ.png?1687277509\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240594\"></p><p>&nbsp;</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240608/original/7jfKUxuJETSaiCozVldmKw5B2_mq4iow3g.png?1687277509\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240608\"></p><p>&nbsp;</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240603/original/d4HxUzZ-gQXfbXgrM6e3WzN6_yNE8tCkEg.png?1687277509\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240603\"></p><p>&nbsp;</p><p>In the below SQL extract, you can see that the promotion being used for ‘classic gardens’ validity date (‘prhStartDate’ and ‘prhEndDate’) ‘txnPromDesc’ is would match the Promotion name in Back Office <strong>Short Description</strong> name.</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240600/original/oMCqu_YwIYmRt7R2Xj0p1OhEqinCeSvyTA.png?1687277509\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240600\"></p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240590/original/wGJ2y3PCX3jo1UOn-ybSMOLXSzmklsVbXw.png?1687277509\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240590\"></p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240591/original/kyvGKnVpMQiTy86BRCilJis584MNr0G5EA.png?1687277509\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240591\"></p><p>&nbsp;</p><h2>Reports: Export button greyed out on the Parameters window &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p>The fix is report specific so you would need to repeat the fix for each and every report that this problem occurs.</p><p><strong>Fix</strong></p><p>The Export button on the report parameters screen is only enabled if the repProcName field in the Reports table is set with the actual stored procedure name. &nbsp;</p><p>&nbsp;</p><h2>Reports: Report not importing correctly &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p>When a Stored Procedure for a report is updated as well as the .rpt file upadated, an import of the report fails as a result of the StoreD Procedure not being found.</p><p><strong>Fix</strong></p><p>Delete the report entry in the Reports table and then try re-import and make sure the entry in the table ‘repProcName’ is updated with the correct Stored Procedure name as seen in the below example…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240597/original/Zvyvkb0ZRX30Nx3ZYT9IsYAzVwWix_13Hw.png?1687277509\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240597\"></p><p>&nbsp;</p><h1>Data Extracts &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h1><p>&nbsp;</p><h2>Data Extract: Mailing Extract Error – The object invoked has disconnected from its client &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><h2>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</h2><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240613/original/rGTDnCs_7jE1VW3HzBzssG652GBkubr_tQ.png?1687277509\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240613\"></p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240604/original/T915XzZDjr0jMI-REIk2E1m05tVzKNfbOA.png?1687277509\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240604\"></p><p>&nbsp;</p><p><strong>Solution</strong></p><p>Try close down Merac Back Office and re-open and re-run the report.</p><p>Memberships&gt;&gt;Mailing</p><p><strong>Cause&nbsp;</strong></p><p>May have been caused by network connectivity issues.</p><p>&nbsp;</p><h1>GiftAid &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</h1><h2>GiftAid: Claim Submission Failing &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>GiftAid Claim Submissions Error -&nbsp;</strong><strong>Authentication Failure. The supplied user credentials failed validation for the requested service</strong></p><p>If the Account details are not setup correctly (i.e. the name of the 'Registered Charitable Contact' is incorrect) even if the UserID and Password is correct and the user can&nbsp;</p><p>login to the gateway directly (<a href=\"https://online.hmrc.gov.uk/login\">https://online.hmrc.gov.uk/login</a>), the customer would need to contact the HMRC to get the below details verified...</p><p>&nbsp;</p><p>Example:-</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240602/original/o00ZjJ_JBt8UrZ8a5bzxZRnq3Lu83DQKhA.png?1687277509\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240602\"></p><p>&nbsp;</p><h2>GiftAid Claim Submissions Error - Unable to submit GiftAid Claims &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p>Receive error: ‘Error when Submitting Claim to HMRC: Please see error report’</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240614/original/5bECuddiVccVSV7V9DUE9EILm-vidMSN_g.png?1687277509\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240614\"></p><p>&nbsp;</p><p>The below schema error ‘Your submission contains an unrecognised namespace’…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240609/original/Xx7cEem7HMfjbtTkvD-_OXDVjo74AxYayw.png?1687277509\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240609\"></p><p>&nbsp;</p><p><strong>Fix</strong></p><p>Uninstall GiftAid from Add/Remove Programs and then download the latest version of GiftAid Manager from the Merac download page and this should fix the issue.&nbsp;</p><p>&nbsp;</p><p>Note!</p><p>This will not cause loss of current GiftAid Claims stored locally on the computer. These are stored in a location other than within the installation directory.</p><p>&nbsp;</p><h2>GiftAid Write Submission Error &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p>After installing GiftAid Manager from Merac website, if a Write Submission error is returned, then check that the correct permissions have been applied to the GiftAid folder under C:\\Program Files (x86)\\Merac\\ and if so, uninstall Gift Manager and reinstall.</p><p>&nbsp;</p><p>Note!</p><p>This will not cause loss of current GiftAid Claims stored locally on the computer. These are stored in a location other than within the installation directory.</p><p><strong>&nbsp;</strong></p><h2>GiftAid: &nbsp;Declarations Report hanging &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>Problem</strong></p><p>GiftAid Declarations Report hanging when specifying partial Date search criteria to find Unclaimed Entries. &nbsp;&nbsp;</p><p>Also when doing a full month report for the same month it does output report information.&nbsp;</p><p>The report includes Branch_Number, GiftAid Unclaimed Entries, Till Number and Receipt information.</p><p>&nbsp;</p><p>Example:</p><p>If changing the Date range to: 01 Sep – 30 Sep (this works)</p><p>If changing the Date range to: 22 Sep - 30 Sept (it just hangs)</p><p>&nbsp;</p><p><strong>Solution</strong></p><p>Download the newer version of GiftAid Manager from the Merac website and install it which should fix this issue.</p><p>&nbsp;</p><h2>GiftAid: ‘Divisible by zero’ SQL Statement function error &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</h2><p>Setting the PLU Sell price to £0.00 with the GiftAid option still entered will render a Till “Divisible by zero” SQL Statement function error. Fix this by disabling GiftAid for the item set to £0.00.</p><p>&nbsp;</p><h2>GiftAid: PLU View/Add Price showing GiftAidable Claimable Amount not equal to 10% as System Options defines &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>Reason</strong></p><p>The reason for this is because when the PLU ‘Adult Admission’ ticket was initially setup, the Sell price was set to £100.00 which means the system calculated 10% GiftAid on this item correctly as you can see below. If the Sell price is changed in the future, the GiftAid contribution calculated when the PLU was initially setup would need to be manually adjusted to reflect the newly revised GiftAid contribution.</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240621/original/XrVtlpLY4HrzCgqwhsyW0057I50J5JPdzw.png?1687277509\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240621\"></p><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>‘Adult Admission’ shows GiftAid Claimable Amount of £10.00 which is correct because the initial Sell price for the item had been set to £100.00 which was later changed to £50.00. There is no proof of this price change unfortunately because the item had not been sold at the original price so there is no transaction recorded against it.</strong></p><p>&nbsp;</p></td></tr></tbody></table><p>&nbsp;&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>By default, all customers who donate to a charity (i.e. they are registered as a <strong><em>Charity Organization</em></strong>) will contribute 10% towards GiftAid (i.e. there chosen charity).</p><p><strong>&nbsp;</strong></p><h2>GiftAid: Fix Taxing on GiftAidable items &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p>To prevent taxing on GiftAidable items sold, you can run ‘UTIL_RecalculateGiftAidTable’ Stored Procedure to fix this.</p><p>&nbsp;</p><p>e.g. CustomerName: Painswick Rococo Gardens</p><p>Obviously, Painswick do not want to pay tax on GiftAid so Nik has setup a SQL statement to update the GiftAid Tables to prevent this from happening.</p><p>&nbsp;</p><table border=\"1\" cellpadding=\"0\" cellspacing=\"0\"><tbody><tr><td width=\"19.726858877086496%\"><p>&nbsp;</p></td><td width=\"17.147192716236724%\"><p><strong>Item</strong></p></td><td width=\"12.898330804248863%\"><p><strong>Price</strong></p></td><td width=\"50.22761760242792%\"><p><strong>Claimable Amount&nbsp;</strong></p><p><strong>(normally 10% of the original price or rounded off to the closest price)</strong></p></td></tr><tr><td width=\"19.726858877086496%\"><p><strong>e.g. PLUs incl. GiftAid</strong></p></td><td width=\"17.147192716236724%\"><p>Admission Family</p></td><td width=\"12.898330804248863%\"><p>30.00</p></td><td width=\"50.22761760242792%\"><p>3.00 (<strong>NOT TAXABLE</strong>)</p></td></tr><tr><td width=\"19.726858877086496%\"><p><strong>e.g. PLUs dis-incl. GiftAid</strong></p></td><td width=\"17.147192716236724%\"><p>&nbsp;</p></td><td width=\"12.898330804248863%\"><p>27.00</p></td><td width=\"50.22761760242792%\"><p>(<strong>TAXABLE</strong>)</p></td></tr></tbody></table><p>&nbsp;</p><h2>GiftAid – GiftAid Conversion report not matching entries in the GiftAid Claim Submissions list &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>Problem</strong></p><p>GiftAid Module addin used for GiftAid Claim Submissions was showing indifferently (e.g. a higher amount) to the actual GiftAid Conversions report.</p><p><strong>Solution</strong></p><p>GiftAid BackFix…</p><ol><li>Narrowed it down to locate a specific date in time when the GiftAid Claim Amount is different to the GiftAid Conversion report.</li></ol><p>select gftSurname,gftPostcode, txhCompleted,gftClaimAmount from TXNHeader</p><p>INNER JOIN Giftaid on gftTxnNo = txhNo</p><p>where txhCompleted between '13 Jul 2014 03:00' and '13 Jul 2014 23:59'&nbsp;</p><p>--order by txhCompleted asc</p><p>OR</p><p>select gftClaimAmount from TXNHeader</p><p>--select sum(gftClaimAmount) from TXNHeader</p><p>INNER JOIN Giftaid on gftTxnNo = txhNo</p><p>where txhCompleted between '13 Nov 2014 10:39' and '13 Nov 2014 10:40'&nbsp;</p><p>&nbsp;</p><p>--Example:-</p><p>--GA CLaimAmount = 55.80</p><p>--GA Conversion Report = 27.90</p><p>--Need to check Stored Procedure</p><p>&nbsp;</p><ol><li>Checked to see what transaction/s was/were involved to try establish or determine a pattern or whether the transaction was linked to a Booking or Member.</li></ol><p>&nbsp;</p><p>select * from TXNHeader</p><p>inner join TXNDetail on txnNo = txhNo</p><p>where txhCompleted between '13 Nov 2014 10:39' and '13 Nov 2014 10:40'</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><ol><li>Inspect the transaction file stored local on the Till to find out if the transaction amounts tie up to the data written to the server. The data written to the local transaction file could be different to the actual data written to the database for a given transaction.</li></ol><p>&nbsp;</p><ol><li>Establish from the date the problem was reported and to a wide date range in the future whether or not the same problem is occurring. If not, then the solution would be to back fix the data using ‘UTIL_RecalculateGiftAidTable’ Stored Procedure.</li></ol><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240610/original/qQRspRCb3MsI6pNPbjXHIzM1avXcdo6AHw.png?1687277509\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240610\"></p><p>&nbsp;</p><p>You can verify that the data is corrected once the UTIL_RecalculateGiftAidTable Stored Procedure has been run using the below statement. There will be transactions whereby the <strong><em>sum of txnLineSellValue</em></strong> for a given transaction is greater than the <strong><em>GiftAid gftClaimamount</em></strong>. This is because some transactions may include items that are not GiftAidable…</p><p>&nbsp;</p><p>select <strong>txhCompleted</strong>, <strong>txhno</strong>,<strong>gftclaimamount</strong>,SUM(txnlinesellvalue) as ‘TXNValue’ from TXNHeader</p><p>INNER JOIN Giftaid on gftTxnNo = txhNo</p><p>INNER JOIN TXNDetail on txnNo = txhNo</p><p>where txhCompleted between '01 Nov 2014 00:00' and '30 Nov 2014 23:59'&nbsp;</p><p>and gftclaimamount is not NULL</p><p><strong>group by txhNo,gftClaimAmount, txhCompleted</strong></p><p>order by gftClaimAmount - SUM(txnlinesellvalue) desc</p><p>--in the above 'order by' statement, we know that the SUM(txnlinesellvalue) will either be higher or equal to&nbsp;</p><p>--gftClaimAmount depending on whether all items are GiftAidable for the given transaction (value = ‘0’) or the transaction&nbsp;</p><p>--includes items that are not GiftAidable in which case they will appear in the bottom of the list - not all ‘transaction line sell&nbsp;</p><p>--values’ in a given transaction are GiftAidable!</p><p>--the above 'order by' will arrange entries starting from transactions that result in a value of ‘0’ followed by transactions that&nbsp;</p><p>--result in a value less than ‘0’</p><p>--each transaction may include a number of line sell items/values where each transaction is linked to a GiftAid table&nbsp;</p><p>--gftClaimAmount</p><p>&nbsp;</p><h1>Back Office &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h1><p>&nbsp;</p><h2>Back Office: Unable to run ‘Recreate Till Data’ - receive error: Unable to connect to MeracUpdater service &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p>This is a known issue which occurs with Merac BO v3.15 installed and is not really a problem. The error returned does not prevent any of the Tills from updating. Advise the customer at this point in time to ignore the error message.</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240601/original/DbtQ83rgf7qwMsA9PiJr7I5Pb3J20uJv6A.png?1687277509\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240601\"></p><p>&nbsp;</p><h2>Back Office: Merac Back Office Installation Troubleshooting &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p>If the Merac installation fails to complete as a result of not finding a local path, this is caused by the user account being logged on with a roaming profile with folder redirection.&nbsp;</p><p><strong>Cause</strong></p><p>If the Setup.exe file is run from a redirected folder, the executable will check compatibility on the system before running the MSI. Because the temporary folder location used to store temp installation files during any installation is local (%USERPROFILE%\\AppData\\Local\\Temp) and the executable is searching for the MSI from the temp folder location within the user’s roaming profile on the remote server, it cannot be found and the installation fails.</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240611/original/Zxn7-Tbtj5yodLo-jKXMXRhLeYMkdWWO8w.png?1687277509\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240611\"></p><p>&nbsp;</p><p><strong>Solution</strong></p><p>To get around this, run the executable and when presented with an error do not close the error window. Navigate to %USERPROFILE%\\AppData\\Local\\Temp and the MSI Installation folder should have copied across.&nbsp;</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240605/original/MMS4CYHdQiDF18DSmNky8yXSlsPx6MGKfw.png?1687277509\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240605\"></p><p>&nbsp;</p><p>Copy the downloaded temp installation folder (i.e. in this case named “_is9189” containing the MSI to the local computer Desktop and then close the error windows after which the temp folder and its contents will be deleted. Now re-run the installation.</p><p>&nbsp;</p><h2>Back Office: Login Update Notification Message &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>Problem</strong></p><p>When logging into to Back Office from either a client or the server and you receive a message stating that MeracOS.exe is out of date, the notification window will ask you to &nbsp;click ‘Yes’ or ‘No’ button to run the update or not.&nbsp;</p><p><strong>Cause</strong></p><p>When you Recreate Till Data, any changes made are copied to the SQL database and uses the timestamp when the update was copied across to the database. Because there is a timestamp mis-match between the server file version and files authorized in updatenewver folder on the server, the error is displayed stating that the offending file is out of date.&nbsp;</p><p><strong>Solution</strong></p><p>Obviously because we are experiencing the same error on the server, it is not a local client permissions or ini configuration file issue causing the problem.&nbsp;</p><p>Do the following:-</p><p>&nbsp;</p><p>select * from updateserverfiles</p><p>&nbsp;</p><p>begin transaction</p><p>delete * from updateserverfiles where &nbsp;upsid = X</p><p>commit</p><p>&nbsp;</p><h2>Back Office: Merac Back Office software Out-Of-Date Error &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>Problem</strong></p><p>When launching Back Office, receive a “Program out of date” error as seen below…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240606/original/8kQWmgQh2eJ1l9xpNT1R1bTW7fvnA3xvNQ.png?1687277509\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240606\"></p><p>&nbsp;</p><p><strong>Fix</strong></p><p>This is likely caused by either:</p><p>Not having the the correct write permissions to ‘C:\\Programs Files\\Merac’ or ‘C:\\Programs Files(x86)\\Merac’ folder.</p><p>Not having a connection to the &lt;MeracServer&gt;\\MeracData share therefore preventing the system from running updates.</p><p>UAC settings on Windows 7 or higher preventing the running of MStoreUpdater.exe or MeracUpdater service.</p><p>Check that MStoreUpdater.exe is in the Windows Startup folder or that MeracUpdater service is started.</p><p>Make sure that there are no ‘Compatibility Files’ listed in Windows Explorer pointing the Merac installation to the wrong system files.</p><p>&nbsp;</p><h2>Back Office: Computer not able to communicate with the Merac Server &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>Troubleshooting</strong></p><p>Either add an entry to the hosts file to include an entry for the Merac server</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240612/original/Cl6-pG8ET9rKZ8jG1C78rvrJ1YuoOy8RXg.png?1687277509\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240612\"></p><p>&nbsp;</p><p>OR</p><p>&nbsp;</p><p>Ensure that if the Back Office computer is part of a WORKGROUP and the server a domain, that the network has been defined as a ‘domain network’. If setup any different to this (i.e. public or private network), firewall settings could be blocking access to the server.</p><p>&nbsp;</p><p>OR</p><p>&nbsp;</p><p>Check that the Switch that the computer is connected to is not blocking connections from the host by MAC Address (customer IT department will need to check this).</p><p>&nbsp;</p><h2>Back Office: Trying to adjust a PLU sell value returns message to specify a Price Matrix &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>Workaround</strong></p><p>You can update the sell value of a PLU associated with a Pricing Matrix by clicking on <u>Edit</u>&gt;&gt;<u>Copy</u> and then making changes to the sell value with introduction to a Price Break.</p><p>&nbsp;</p><h2>Back Office: Selling of Session Tickets not displaying correct Num QTY in Back Office &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p><u>Steps:-</u></p><p>Add the sessionable PLUs to basket</p><p>Press <strong>SubTotal</strong> button</p><p>The Till will then prompt the Till operator if they would like to book now (i.e. book meaning reserve the session so no BookingRefNo will be created)</p><p>Press <strong>Yes</strong></p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240623/original/HdRTJVBw4SrzL9b8kuA7EkmK3YXy_WEmqw.png?1687277509\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240623\"></p><p>&nbsp;</p><p>Highlight the session for the chosen date and then insert a name that the session is booked for (i.e. in this case is for ‘Chris’). The name will be inserted into the <strong>sessName</strong> field within the <strong>SessionBkgs&nbsp;</strong>table and then press <strong>OK</strong></p><p><strong>&nbsp;</strong></p><p><strong>&nbsp;</strong></p><p><strong>&nbsp;</strong></p><p><strong>&nbsp;</strong></p><p><strong>&nbsp;</strong></p><p><strong>&nbsp;</strong></p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240617/original/A_Z-F0jBCOforYa4zwfZpQg1rlPqUELKzg.png?1687277509\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240617\"></p><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>sessName</strong></p></td></tr></tbody></table><p>&nbsp;&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>The session reservation will be displayed on the right-hand side as seen below…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240618/original/VH8cJeXptjESDdIJnypYk3KiOvm6vf7PvQ.png?1687277509\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240618\"></p><p>&nbsp;</p><p>Now when you select the session from Add/Edit SessionTours in Back Office and click <strong>Make Booking</strong> button</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240624/original/chBhm7SqxWhIBFKflR16Gte5wBRCTuGW_g.png?1687277510\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240624\"></p><p>&nbsp;</p><p>You can see that the ‘Num’ value encircled below does not match the actual value from the Till. The Till had a value of ‘2’ inserted and Back Office is showing a value of ‘1’…</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240620/original/0BvhzSfaIJKWWh2AQ4INYIslfK1eNiLhfQ.png?1687277509\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240620\"></p><p>&nbsp;</p><p>To verify the data in SQL, do the following:-</p><p>&nbsp;</p><p>select * from SessionHdr</p><p>where shdDateTime = '20 Aug 2015 16:00' and shdDescription like 'Leap of Faith%'</p><p>--shdRecNo = 7958 for ‘Leap of Faith: Session 5’ Session Type. If you reserve the same Session Type as seen above (one at 14:00&nbsp;</p><p>--and one at 16:00) each will have different sessRecNo’s)</p><p>&nbsp;</p><p>select * from SessionBkgs</p><p>&nbsp;</p><p>select * from SessionHdr</p><p>inner join SessionBkgs on shdRecNo = sesshdRecNo&nbsp;</p><p>where shdRecNo = 7958 and&nbsp;</p><p>&nbsp;</p><p><strong>Solution</strong></p><p>Escalate to Dev Team</p><p>&nbsp;</p><h2>Back Office: Files not Updating when MeracUpdater runs &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p>Those errors mean one of 3 things:-</p><p>&nbsp;1) The files mentioned are not currently in the software distribution folder - \\\\&lt;ServerName&gt;\\meracdata\\updatenewver\\cache</p><p>2) The current locally-logged-on user does not have permissions to read the contents of this network shared folder</p><p>3) The current locally-logged-on user does not have permissions to copy those files to the local C:\\Program Files\\Merac (or C:\\Program Files (x86)\\Merac) folder</p><p><strong>Troubleshooting</strong></p><p>You can test 1) by typing the path above into Start &gt; Run on that computer.</p><p>You can test 3) by manually attempting to copy one of those files from the source to the destination folders.</p><p>&nbsp;</p><h2>Back Office: Creating a new Lookup Item “Violation of PRIMARY KEY constraint” Error &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240630/original/TH7iG0PCougGUZbnPXPZa4OHEXflF8CVyw.png?1687277510\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240630\"></p><p>&nbsp;</p><p><strong>Fix</strong></p><p>Determine the Maximum Record Number in the Lookups table and then set the ‘RecNum’ in the ‘RecordIDs’ table to that number. This will ensure that when a new Lookup item is created that, that the next available Record Number in the Lookup table will be assigned.</p><p>&nbsp;</p><p>Example of how adding a Lookup Item affects the respective tables:-</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240628/original/NW8nWBQRcsXs4saPE-wDX7_t9ThmrFaDqQ.png?1687277510\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240628\">&nbsp; </p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240637/original/mu78hB02LK2rKPQkk9ctR6xcZ-Y6stPGyA.png?1687277510\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240637\"></p><p>&nbsp;</p><h2>Back Office: Stock Entry Duplicate Primary Key error &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240636/original/JroR4h0maCxOrE-GYyPtn3S5sn8U9AYHiA.png?1687277510\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240636\"></p><p>&nbsp;</p><p>The above SQL Statement error usually occurs when your table ‘RecordIDs’ are out of sync.</p><p>&nbsp;</p><p>To fix this run the following sequence of SQL commands to update the ‘ridRecNum’ in the ‘RecordIDs’ table to match that of the maximum ‘stkRecNo’ in the Stock table, as seen below. In this way, when a new Stock item is added to the Merac system, a non-duplicate ‘stkRecNo’ will be assigned.&nbsp;</p><p>&nbsp;</p><p>Examples:-</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240639/original/Cmd7B0EhcTeDzD__h5cKDfqzaje0Xhj7Yg.png?1687277510\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240639\"></p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240632/original/cSByholspORC3kGLFXY_uP4UyFw8jE0N4Q.png?1687277510\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240632\"></p><p>&nbsp;</p><h2>Back Office: Unable to Move Stock from ‘Unknown Stock Location’ to known Stock Location &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p>If a stock count quantity has been assigned to a Stock Location and the Stock Location later gets deleted, when you click on the glasses icon within the Stock Maintenance window, you will notice that the Stock Location has a description of ‘<strong><em>Unknown Stock Location</em></strong>'.</p><p>&nbsp;</p><h3>Moving Stock from deleted Stock Location to known undeleted Stock Location</h3><p>When carrying out a Stock Movement from location to location from Back Office, because the Stock Location for which the quantity had been assigned has been deleted, ‘Unknown Stock Location’ is not visible in the From Location in order to move the item to another location.</p><p>&nbsp;</p><p><strong>Solution</strong></p><p>We need to move the Stock Count for the given Stock item from ‘Unknown Stock Location’ to the correct location and then delete the ‘Unknown Stock Location’ so that it no longer appears in the list of Stock Locations as seen below…</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240625/original/Y_hzSPBJCk5ttCnp_5KQhMmtb9Of93Psaw.png?1687277510\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240625\"></p><p>&nbsp;</p><p>Below are the known Stock Locations that exist in the database…</p><p>(<strong>lkuRecNo = stlLoc</strong>)</p><p>As you can see, ‘Unknown Stock Location’ (stlLoc = 97) does not exist in Lookups table where lkuGroupCode = 12.</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240616/original/sIgzONtUKhSA1AYC39taagCnuGMJU_OBtw.png?1687277510\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240616\"></p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240626/original/F6wlIwin33VZrqdLtP5rT2MgZYyCONcviA.png?1687277510\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240626\"></p><p>&nbsp;</p><p><br><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240631/original/rbfdGktxEqoLuHWARmJbnufBL26y9Gmolg.png?1687277510\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240631\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240622/original/Db6n0bf_AEG6XjQbkGM_uFrVYts3j1NOEA.png?1687277510\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240622\"></p><p>&nbsp;</p><p>begin&nbsp;transaction</p><p>--delete from StockLoc where stlLoc = 97</p><p>--update StockLoc set stlQty = 6 where stlRecNo = 2110 and stlLoc = 99</p><p>rollback</p><p>commit</p><p>&nbsp;</p><p>The result will be as follows for the given Stock item…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240634/original/JlNeMckrO3LxKpR5HQ0dTqa9mIqC8XCqug.png?1687277510\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240634\"></p><p>&nbsp;</p><h2>Back Office: Forecasts Information not updated correctly for Footfall &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240640/original/8EdnkKu7gLztaAC4uQxcJMlIzYH3bwtneg.png?1687277510\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240640\"></p><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>Proj – Projection of Footfall forecast from previous years Actual Footfall.</strong></p><p><strong>They must equal normally but not necessarily.</strong></p></td></tr></tbody></table><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>Act – Actual Footfall of previous &nbsp;year.</strong></p></td></tr></tbody></table><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>Staff Rota – can be changed from the Forecasting display window manually by double-clicking the cell and then typing the value ‘Closed’ or ‘R.1’ or ‘R.2’ into the cell. Click Save and then Update Forecast button.</strong></p></td></tr></tbody></table><p>&nbsp;&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p><strong>Troubleshooting</strong></p><p>Look at a given year where Actual Footfall difference appears (e.g. as seen above example encircled in red), there appears to be no forecast data for the 29/06/2014 but there is for 30/06/2014.</p><p>&nbsp;</p><p>Check the below tables:-</p><p>select * from Forecasts &nbsp; &nbsp; &nbsp;</p><p>select * from Depsummary</p><p>&nbsp;</p><p>select * from Forecasts where fordate between '29 Jun 2014 00:00' and '30 Jun 2014 23:59'</p><p>--don’t worry if 'forActFootfall' is a value of '0'. This is not necessarily the Actual Footfall</p><p>select * from DepSummary where dsuDate between '29 Jun 2014 00:00' and '30 Jun 2014 23:59'</p><p>--you will notice that there will possibly be missing data for 29/06/2014. Run the below Stored Procedures below to fix this.</p><p>&nbsp;</p><p>--MC_InsertDepSummary</p><p>--ALTER PROCEDURE [dbo].[MC_InsertDepSummary] '01 Dec 2013','01 feb 2017'</p><p>--@FromDate as datetime = 0,</p><p>--@ToDate as datetime = 0</p><p>&nbsp;</p><p>Note!</p><p>In the MC_InsertDepSummary Stored Procedure, make sure you choose a date range that encompasses a wide range to account for previous years that rely on previous year’s actuals to be included as well in order to tie up days with dates. For example – ‘Thurs, 01 Oct 2014’ may not necessarily be ‘Thurs, 01 Oct 2015’ but actually ‘Sat, 01 Oct 2015’ which could have been a non-trading date so projected footfall would not display correctly.</p><p>&nbsp;</p><p>ALTER PROCEDURE [dbo].[MC_UpdateDepSummary]&nbsp;</p><p>@YearsBack as tinyint = 0 -- 0=up to one month old transactions; 1=up to one year and one month old txns; and so on)</p><p>&nbsp;</p><p>MC_UpdateDepSummary 2</p><p>&nbsp;</p><p>Now if you go back into Merac Back Office Dashboard/Forecasting and then click the <strong>Update Forecast</strong> button, the data missing will now appear. You may need to manually amend any projected Footfall figures that have not updated with the previous years Actual Footfall figures.</p><p>&nbsp;</p><h2>Back Office: Mailing Export/MailMerge to MS Excel/Word error &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>PMBOS: Microsoft Excel/Word returned the following error:- Application-defined or object-defined error</strong></p><p>&nbsp;</p><p>Example:-</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240627/original/lqEh2BTY_-uvQPFD61liLmk-ZQOnsutzYQ.png?1687277510\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240627\"></p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240635/original/EKz5nPiqmg_qqcBXU86SO8ROyKv-9_dvRA.png?1687277510\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240635\"></p><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>2</strong></p></td></tr></tbody></table><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>1</strong></p></td></tr></tbody></table><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>3</strong></p></td></tr></tbody></table><p>&nbsp;&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>1 - Exports queried output displayed in the grey section to MS Excel as a data list. Click the <strong>Export Data To List</strong> button.</p><p>2 - If wanting to export the queried output displayed in the grey section to MS Word for the purpose of Mail Merging the data list. Click the browse button (3 dotted button) to the far right to browse to and choose the appropriate mail merge letter (i.e. in this case is called ‘Renew Ack Letter.docx’).</p><p>3 - Click the <strong>Mail Merge to Word</strong> button.</p><p>&nbsp;</p><p><strong>Problem</strong></p><p>When choosing action sequence ‘1’ or ‘3’, the following error is produced…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240629/original/eACCqT-8MLri4kijlLlj52Ru82vbR-Xqpw.png?1687277510\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240629\"></p><p>&nbsp;</p><p><strong>Solution</strong></p><p>First open MS Excel and open Excel <strong>Options</strong> and ensure that three sheets are defined for all Workbooks</p><p>Open Command Prompt and try and ping the Merac Server Hostname and IP Address or try browse the server URL.</p><p>Open Internet Explorer settings and click <strong>Security</strong> tab and 'Trusted Sites’</p><p>Add both &lt;MeracServerName&gt;\\MeracData and &lt;MeracServerIP_Address&gt;\\MeracData to trusted list and close all browser instances.</p><p>Now try click on the buttons again.</p><p>Once the letter has been merged into MS Word, click <strong>Mailing</strong> tab and then ‘<strong>Finish &amp; Merge</strong>’ in the MailMerge toolbar. Choose ‘all’ and the then the entire exported data list should be inserted into the MailMerge Letter.</p><p>Done!</p><p>&nbsp;</p><h2>Back Office: Error when attempting to Clone an existing Receipt or Ticket Design &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p>Search for the Ticket Design to clone, select it from the drop-down and then click on Display button to view the details of the ticket design to clone…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240638/original/tTxCy8tAJbLmsXfiMQ5EWqCQMAHwRTuoAA.png?1687277510\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240638\"></p><p>&nbsp;</p><p>Click <strong>Clone</strong> button...</p><p>Insert Document Name in highlighted red field below and then click <strong>Save Changes</strong> button…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240633/original/xgi2lgw-4o7mdfxYkX4LrLnXFJjHemoIjg.png?1687277510\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240633\"></p><p>&nbsp;</p><p>If a SQL Statement error is returned, it is likely a ‘PrintLayoutHeader’ table sequencing issue.</p><p>&nbsp;</p><p>Run the following to correct this:</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240641/original/lX6fym2zw6kKoMdvmlwzpfzq3YbDqYwNfQ.png?1687277510\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240641\"></p><p>&nbsp;</p><p>From the above you can see that the last allocated sequence number in the PrintLayoutHeader table is 1104.</p><p>&nbsp;</p><p><strong>Fix</strong></p><p>Now amend the ‘ridRecNum’ value for both ReceiptDefinitions and TicketDefinitions within the ‘RecordIDs’ table to a higher numerical value (e.g. 2000).</p><p><br></p><h1>Debit/Credit Cards &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</h1><h2>Credit Cards: Card Machines Down &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p>***(If using ACK)***</p><p>*****************</p><p>Log onto the customer’s Merac Server</p><p>End Process Tree for <strong>wbtterm3.exe</strong> (old version exe’s are ECPWSS_C.exe and ECPWSSVC.exe – no need to terminate)</p><p>Stop/Start both <strong>ACK EFT Windows Socket Server</strong> and <strong>ACK EFT Node Encryption</strong> services</p><p>Restart Normal Polling (shortcut on Desktop)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [Normal Polling is a scheduled task to poll debit/credit card transactions]</p><p>&nbsp;</p><p>RE – Normal Polling (aka. Scheduled Polling)</p><p>Usually a common error concerning Normal Polling crashed on server would be error message “Batch Transfer in Process” which means the previous scheduled polling has been executed successfully but crashed thereafter. To fix the issue, implement the above fix.</p><p>&nbsp;</p><p>***(If using YesPay)***</p><p>*******************</p><p>Log onto the Till and kill <strong>java.exe</strong> and <strong>javaw.exe</strong>.</p><p>Log off the POS Till program.</p><p>Restart <strong>StartPOSServer.bat</strong>.</p><p>Re-run and log back into POS Till program and test by taking a dummy payment.</p><p>&nbsp;</p><p>***(If using Verifone Ocius Sentinel)***</p><p>*********************************</p><p>&nbsp;</p><p>Note!</p><p>Default Installation Path: ‘C:\\Program Files\\Verifone’ and ‘C:\\Documents and Settings\\All Users\\Application Data\\VeriFone\\PAYware Ocius Sentinel’</p><p>&nbsp;</p><p>Log onto each Till and terminate the POS Till program.</p><p>Right-click in the system tray and Exit Ocius Sentinel program (Quit the Ocius Sentinel Card Machine program).</p><p>Double-click the Ocius Sentinel program shortcut icon in then Startup folder in the <strong>Start</strong> menu (not the Desktop) to restart the program and then the icon should re-appear in the system tray.&nbsp;</p><p>Double-click the Ocius Sentinel icon in the system tray and then log back into Ocius as follows:</p><p>[enter PIN code ‘1234’ and click <strong>Enter</strong> button] twice…</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240947/original/hR7NAw3y4eMKzruEsbJfc7mo-jwqG4iFAg.png?1687277556\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240947\"></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>Once logged in, double-click on the Ocius Sentinel icon again to verify that the card system is online which will be identified as the Ocius Sentinel window looking similar to the following…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240949/original/Px2YBm4Yg3UxXlrVdUxupBwlXO7-O3ijsw.png?1687277556\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240949\"></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>Click on <strong>Hide</strong> button and then re-launch the POS Till Program</p><p>Repeat for all Tills</p><p>&nbsp;</p><p>(ask Dave Radford for registry change fix if needed!)</p><p>Note!</p><p>The normal install sets up an Ocius Sentinel shortcut exe file in C:\\Documents and Settings\\All Users\\Start Menu\\Program Files by default that does not work.</p><p>&nbsp;</p><p><strong>Solution</strong></p><p>Browse to C:\\Program Files\\Verifone folder and recreate a new Ocius Sentinel shortcut</p><p>(for Windows XP)</p><p>Copy the shortcut to ‘C:\\Documents and Settings\\All Users\\Start Menu\\Program Files\\Startup’ or ‘C:\\Documents and Settings\\Till\\Start Menu\\Program Files\\Startup’&nbsp;and then repeat the Ocius Sentinel initialization process above.</p><p>(for Windows 7)</p><p>Copy the shortcut to ‘C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Startup’ and then repeat the Ocius Sentinel initialization process above.</p><p>&nbsp;</p><p>If that does not resolve the issue, get the user to plug the <strong><em>Serial to USB cable/converter</em></strong> into a different USB port and then restarted the Ocius Sentinel program – this should resolve the issue.</p><p>This process has caused the PinPad Ocius Sentinel software to re-claim the device using an alternative USB port.</p><p>&nbsp;</p><h2>Credit Card: Unable to take Card Payments – Till Offline &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p>If customer is unable to carry out PDQ credit card payments and the Till is showing a red box at the bottom right-hand-side saying offline.</p><p><strong>Solution</strong></p><p>Delete/Rename the Tillstatus file in C:\\Program Files\\Merac\\&nbsp;</p><p>&nbsp;</p><p>Note!</p><p>When a Till goes offline, a message will be displayed at the bottom in Red/White saying ‘Offline’. It will then create a file called ‘Tillstatus’ or ‘netstatus’ (a text file) in <strong>C:\\Program Files\\Merac</strong> directory on the Till. To get the Till back online, delete/rename this file to fix the issue or add items to the basket and the ‘VOID ALL’ to force a reconnection to the server. You could also click on the ‘Offline’ message at the bottom of the Till screen and select ‘Re-try again’ to force re-connectivity.</p><p>&nbsp;</p><h2>Credit Card: YesPay Error – “Transaction Failed : Declined offline. Please Take alternative payment” &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</h2><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240950/original/cMMKG-ueS1sIh9K_U84QWc0ktXrYW0wTJg.png?1687277556\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240950\"></p><p>&nbsp;</p><p>Sent log files to YesPay Support.</p><p>&nbsp;</p><h2>Credit Card: Unable to read Debit/Credit cards when swiped through the Till PDQ Card Reader &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>Problem</strong></p><p>Till operator reports that Credit Card Readers are becoming more and more mechanically unreliable, often not recognising perfectly good cards and staff have to ask customers to remove cards and try again.</p><p>If the card readers are failing to read the chips correctly then it would be down to hardware. Odds are that it could be resolved by using a cleaning card. They may have become dirty etc.</p><p><strong>&nbsp;</strong></p><p><strong>Solution</strong></p><p>Get the customer to insert a &nbsp;Smart Card Reader cleaning card into the card machine a few times to rid of stubborn contaminants (i.e. dust and dirt etc.). If needed, we can send the customer a cleaning card in the post at a small fee (discuss with Dave or MikeC but we normally charge £2.00 per card cleaner). This card cleaner is a single use card once opened from the wrapper – unwrap and then clean all machines in a single go and throw the card away as it will dry up and be of no use thereafter. If this does not improve things then <a href=\"mailto:sales@merac.co.uk\">sales@merac.co.uk</a> can advise on how much a replacement PDQ machine will be.</p><p>&nbsp;</p><p>A pinpad Software Update may be required.</p><p>The cashier needs to be at the Till at the time you remotely assist in carrying out a pinpad Software Update!</p><p>The Smart Card Reader for the card machine could be damaged.</p><p>&nbsp;</p><h2>Credit Card: Chip&amp;PIN not working &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p>If you insert a Chip&amp;PIN card into a card reader and the Card Machine returns a message saying “<strong><em>Swipe Card (requires a customer signature</em></strong>)<em>”</em> instead of “<strong><em>Chip Found (does not require a customer signature)</em></strong>” message, then it cannot be a fault with the hardware. It is likely a firmware issue and the needs to be re-flashed or upgraded.&nbsp;</p><p>&nbsp;</p><h2>Credit Card: YesPay/WorldPay – CashBacks not working &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p>Provided WorldPay confirm that CashBacks has been enabled for the respective TID, do the following:-</p><p>&nbsp;</p><ul><li>Go into C:\\YESEFT\\common files\\conf and copy all the files and paste them in C:\\YESEFT\\conf (replacing the existing files).</li><li>Go into C:\\YESEFT\\common files\\properties and copy all the files and paste them in C:\\YESEFT\\properties (replacing the existing files).</li><li>Go into C:\\YESEFT\\conf and delete the three data set files and then initialize the terminal, namely:</li></ul><p><strong>EFTAcquirerDataset.xml</strong></p><p><strong>EFTIssuerDataset.xml</strong></p><p><strong>EFTMerchantDataset.xml</strong></p><p>&nbsp;</p><p>Follow the steps mentioned and then try to perform a Cashback transaction.</p><p>&nbsp;</p><p>If the below “<strong><em>Multiple Terminal Installation</em></strong>” message appears when re-initializing the software, contact YesPay/WorldPay and request a KeyChange…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240948/original/NZczjP8n3vu4g6YacwypTOoxr5WE3Cts6A.png?1687277556\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240948\"></p><p>&nbsp;</p><h2>Credit Card: YesPay - Card Refunds using EasyVTerminal version 3445 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p>Just a heads up. If you receive any calls from customers saying that they are unable to refund against a card with the PDQ card machine returning error ‘Transaction Failed’. To fix this issue, upgrade their version software to 3445 and then when the Till operator enters the card number and expiry, when they are presented with the below box…</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>…advise then to not enter <strong>Start Date</strong> and <strong>Issue No</strong> and simply press OK on this window and it should work fine.</p><p>&nbsp;</p><p>If you enter in the <strong>Start Date</strong> and <strong>Issue No</strong> it crashes Windows and the entire computer/Till system shuts down resulting in them having to press the power button to turn the Till back on.</p><p>Also when entering the Expiry Date on the card machine, the Expiry Date will appear differently from the EasyVTerminal window which is normal (confirmed by YesPay Support).</p><p>&nbsp;</p><h2>Credit Card: YesPay - Card Payment failure &nbsp;as a result of Till going Offline &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>SubTotal</strong>&gt;&gt;<strong>Credit Card</strong></p><p>Card is inserted into the reader.</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>Then Void Receipt is printed.</p><p>&nbsp;</p><p>The above happens only if the customer is running EasyVTerminal 2.2.4.1 which does not support processing of offline transactions. For example if during a transaction, the till operator decides to take a card payment and the Internet goes down, the above error message will be displayed. The outstanding transactions will be written to a file in the local YesEFT folder.</p><p><strong>Workaround</strong></p><p>Zip the folder and send to YesPay to upload the pending transactions.</p><p><strong>Fix</strong></p><p>Uninstall 2.2.4.1. and upgrade to 2.2.4.2 as this version onwards supports offline card payment transactions.</p><p>&nbsp;</p><h2>Credit Card: Polling Query following moving from ACK to YesPay &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p>A customer may ask whether all polled transactions have been closed off following moving over from ACK to YesPay.</p><p>You can verify this by checking for any pending transactions. This is done by running a batch file on the ACK server to check authorized transactions against what the bank has processed (Dave can take a look at that).</p><p>ACK (old system being decommissioned for use) uses dialup modem to connect.</p><p>&nbsp;</p><h2>Credit Cards: Ocius Sentinel – ‘Check for Pinpad’ message from Ocius Sentinel window &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>Problem</strong></p><p>After reinitializing Ocius Sentinel to connect to the pinpad, the console displays the message ‘Check for Pinpad’ as seen below.</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240951/original/lndDQZQiB9vKsZqMcBOuEY3Eylqhnf0kAw.png?1687277556\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240951\"></p><p>&nbsp;</p><p><strong>Solution</strong></p><p>Wait until the software finds the device as the software it looking for the pinpad. If after a 5 mins it does not find anything and is stuck on this message, try restarting the Till.</p><p>&nbsp;</p><h2>Credit Cards: Ocius Sentinel not detecting Device on COM Port &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p>Configuring Ocius Sentinel to manually detect the pinpad plugged into an unknown COM port.</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240952/original/aBK9k7e-AUuNlX0hwAca8up5Kp4_TPEb9A.png?1687277556\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240952\"><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240954/original/GmgJep0jd0EM-jxoaL3d8kUwblz8DS5Z5w.png?1687277556\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240954\"><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240953/original/fQrAA7aLdBZyq6rtMU7B_doki83OH04yXQ.png?1687277556\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240953\"><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240955/original/F2s5BlAPN1-EqbPzAdvKJnFduaeFzKpboA.png?1687277556\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240955\"></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240957/original/Z1r9ZrAjk_w3AbsE0wsmyM-zZ82ZNMCsjQ.png?1687277556\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240957\"></p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240956/original/9H7XeXc0XdEHOn8qxsK9bnnaLnjz5-Lclw.png?1687277556\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240956\"><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240958/original/L9gkYA05OTD1Dv67EuG4ahNlP8sAMFYJeQ.png?1687277556\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240958\"></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240962/original/DIGFSIK4PWsLZt6xHCMU8LeZvSLHhgLzbA.png?1687277556\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240962\"></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240960/original/MiXoheBTSKLuyiz0Ze-eUtU_MAvKUcEVvw.png?1687277556\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240960\"></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240959/original/X_GvFjv6QSP8F2ckdwEXWYie_wLsxu_epQ.png?1687277556\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240959\"></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240963/original/FgSksVI7z6LwcbGiw4XXQXpwOwt5UOnI1w.png?1687277556\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240963\"></p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240961/original/IZR4uuV87Pt_NwWcA3TyfvhdRX_DgpcoVg.png?1687277556\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240961\"><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240966/original/9xsPS1lnyy8jRty7ly4QfDPm8Z7eWIMHBg.png?1687277556\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240966\"><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240964/original/ZL-bezcTDalJoucFmm3k-tYgfJnxQ2c7-A.png?1687277556\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240964\"></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240969/original/Vp1VjrDF9wexkjp2M-BfpDN5hCQ_kyaAyA.png?1687277556\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240969\"><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240965/original/ynkBbgCKVVCRIk82LhjA4jKCWhKeE4mqpg.png?1687277556\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240965\"><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240967/original/saPEobb2DuBH9A2bASXj2ZMfWtOLkbXRbQ.png?1687277556\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240967\"></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><h2>Credit Cards: YesPay – EasyVTerminal Startup Issues &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p>When attempting to restart YesPay using StartPOSServer.bat, you may receive a combination of the following two error messages:-</p><p>&nbsp;</p><p><u>Startup Issue 1</u></p><p>&nbsp;</p><p>Error1: ‘Unable to open EasyVTerminal. Please check COM port…’</p><p>&nbsp;</p><p>AND</p><p>&nbsp;</p><p>Error2: ‘Unable to initialize EasyVTerminal. STSTerminalException: unable to reset reader, response…’</p><p>&nbsp;</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240972/original/IeXMAtFdSAADBiN9sTJqhUmN9OjG1Z4K3g.png?1687277556\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240972\"></p><p>&nbsp;</p><p>Close the POS Till program.</p><p>Get the customer to check which COM port the card machine is plugged into and ensure it matches the configuration panel.&nbsp;</p><p>Stop <strong>java.exe</strong> and <strong>javaw.exe</strong>.</p><p>Power off to the device and then wait 10 secs and then re-connect the power and wait for the device firmware to fully load&nbsp;</p><p>(i.e. there should be a firmware version displayed on the screen when the device is fully loaded)</p><p>Double-click on <strong>YesEFTInterface.bat</strong> or click <strong>StartPOSServer.bat</strong>&nbsp;</p><p>Re-launch and log back into the POS Till and test by trying to take payment.</p><p>&nbsp;</p><p><u>Startup Issue 2</u></p><p>&nbsp;</p><p>YesEFTInterface Error: ‘PortInUseExeption: Port currently owned by STS.x’.</p><p><strong>Cause</strong></p><p>If you receive the following error when clicking on StartPOSServer.bat, this could mean the TID is possibly already registered and running at another Till so to prevent fraudulent activity or abusing the license on more than one terminal at the same time, the YesPay EasyVTerminal software will return the below error and fail to start up YesPay at the Till…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240974/original/TXyOM2q17xNLCng3uRWjfSM88940yO7vpQ.png?1687277556\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240974\"></p><p>&nbsp;</p><p>The above can also be caused by other instances of java running in the background. Terminate these from Task Manager and then relaunch StartPOSServer.bat.</p><p>&nbsp;</p><p>And when clicking on “Starting EasyVTerminal..” splash screen, the below error is displayed…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240971/original/ErzowWPOJ0EGBlgQFg65STM_fWpgz5qn5Q.png?1687277556\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240971\"></p><p>&nbsp;</p><p><strong>Solution</strong></p><p>Contact YesPay and request for a KeyChange and provide them the TID number as seen encircled below...</p><p>&nbsp;</p><p>Note!</p><p>The MID and TID info. is only displayed in YESPay software version 2.2.4.2 upwards (which requires a KeyChange) and <u>not</u> 2.2.4.1 or earlier (which does not require a KeyChange).</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240983/original/Ca3vnykdKR_sTZAxCeuLVydT1cVgTUOKGA.png?1687277556\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240983\"></p><p>&nbsp;</p><p>Once the KeyChange has been performed, re-register the MID and TID.</p><p>Restart YesPay EasyVTerminal whilst the POS Till program is closed by double-clicking StartPOSServer.bat.</p><p>Re-launch and log back into the POS Till program.</p><p>Get the customer to try process another card payment transaction.</p><p>&nbsp;</p><h2>Credit Cards: Yespay error ‘STSSerialPortException: javax.comm.NoSuchPortException.1’ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p>When starting StartPOSServer, receive the above error</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240968/original/MTYahQaEXwndGLsfJUtrMCPtZ2s8J4bQmA.png?1687277556\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240968\"></p><p>&nbsp;</p><p><strong>Fix</strong></p><p>Check if PDQ is attached via USB and if so if it is a Verifone VX810/820, install the USB drivers and then ensure that EasyVTerminal setting have been set to correct COM port in Device Manager.</p><p>&nbsp;</p><h2>Credit Cards: YesPay error ‘Invalid Key Index’ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p>When trying to run EasyVTerminal, receive error ‘Invalid Key Index’ following KeyChange.</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240973/original/vYGqjEtDIhRFXBodw8oILtovCK8Jc48aYw.png?1687277556\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240973\"></p><p>&nbsp;</p><p><strong>Cause</strong></p><p>This is because there is a discrepancy between the key registered for that terminal on the YesPay server and that of which is registered on the POS terminal.</p><p>&nbsp;</p><p><strong>Fix</strong></p><p>Any EVT version following 2.2.4.1 required a KeyChange for new software installs. Following a KeyChange and receiving ‘Invalid Key Index’ error when starting EVT would require you to copy the folder ‘\\\\svrcompany\\ftproot\\JTristem\\Merac\\YesPay\\CommonFiles.zip’ to C:\\YesEFT\\ on the Till and then unzip and overwrite the existing folders with its contents.</p><p>Then restart EVT and provided the Card Machine is powered on and plugged into the correct COM port, should work!</p><p>&nbsp;</p><h2>Credit Card: ACK – Problems Processing Card Payments from Till &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p>Card Payments failing on 1st payment attempt or all payment attempts at all Tills</p><p><strong>Problem</strong></p><p>Error received when first payment attempt is made: “<strong><em>Operation Failed - Card Declined</em></strong>” or “<strong><em>Please contact your bank to Authorize</em></strong>”.</p><p><u>What to determine</u>:</p><p>Is the problem happening with multiple Tills or at multiple card machines? If yes, then it is likely that they have an ACK server setup or they could be experiencing network connectivity issues (i.e. no Internet connection).</p><p>If it is determine that they are using ACK, then there could be a problem with Normal Polling.&nbsp;</p><p>Some customers have a single Merac server and one or more ACK servers to spread the load on card transactions.</p><p>&nbsp;</p><p><strong>Solution1</strong></p><p>Log onto the ACK server and open <strong>Task Manager</strong>&gt;&gt;<strong>Processes</strong> tab&gt;&gt;click ‘Show all processes from all users’ and then locate and end process tree for <strong>wbtterm3.exe.&nbsp;</strong></p><p>Open Services snap-in and stop/start both <strong>ACK EFT Windows Socket Server&nbsp;</strong>and<strong>&nbsp;ACK EFT Node Encryption&nbsp;</strong>services, then restart Normal Polling.</p><p>&nbsp;</p><p>OR</p><p>&nbsp;</p><p>If the Company/Customer has more than one ACK server in their environment, first determine which ACK Server you are connected to:-</p><p>Click <strong>Start</strong>&gt;&gt;<strong>Programs</strong>&gt;&gt;expand <strong>ACK EFT</strong> and then double-click <strong>ACK Maintenance Manager</strong>…</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240976/original/b5wl39itgLoalbjUd-6yFd5r-IyEusAn4g.png?1687277556\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240976\"></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Click <strong>Open</strong> button to view the contents of the xml file… &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240979/original/3OA98g856zmIOjmj8NmbHDvWeTUB4oZqbQ.png?1687277556\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240979\"></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240980/original/QqdVFz7y1usSGqG-oRqXeGC2ynLdbIla0g.png?1687277556\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240980\"></p><p>&nbsp;</p><p>Now click on <strong>Normal Polling</strong> in the taskbar to view the Normal Polling window and click <strong>Cancel</strong> button.</p><p>Re-open the Normal Polling window from the taskbar and click <strong>Close</strong> button (Normal Polling is linked to <strong>wbtterm3.exe</strong>).</p><p><u>Open Task Manager and end process for the following</u>:-</p><p>ECPWSSxxx.exe instances (two of them for ‘ACK EFT Windows Socket Server’ service)</p><p>Nodesvr.exe (for ‘ACK EFT Node Encryption’ service)</p><p>Open Services and restart <strong>ACK EFT Windows Socket Server</strong> and <strong>ACK EFT Node Encryption</strong> services.</p><p>Re-open Normal Polling by double-clicking on the Normal Polling icon on the Desktop.</p><p>&nbsp;</p><p>Open the command prompt on the ACK server and enter the following sequence of commands to test that ACK is configured correctly to make payments online. The ACK software if configured correctly needs to communicating with the ACK Modem in order to dial out onto the telephone line. This dummy payment (using a non-existent card) is used to test a connection to the telephone line via the ACK Modem alone and does not actually connect to a bank…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240977/original/BTlZu34210QoFDXafgydA_7jvwaIdMG6Fw.png?1687277556\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240977\"></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>*******</p><p>&nbsp;</p><p>You can also test that the ACK Modem connected to the server is able to dial out on the telephone line by opening the command prompt and then inserting the following series of commands:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>IMPORTANT: You must be in the Command mode of your communication software to use the AT commands</p><p>&nbsp;</p><p>+++ &lt;enter command mode&gt;</p><p>atdp &lt;telephone_number&gt; (press Enter key)</p><p>(above AT command instructs the Modem to use <u>pulse dial</u> to dial out to the given number)</p><p>&nbsp;atdt &lt;telephone_number&gt; (press Enter key)</p><p>(above AT command instructs the Modem to use <u>tone dial</u> to dial out to the given number provided it is a touch-tone phone line)</p><p>atd 9, &lt;telephone_number&gt;</p><p>(above AT command instructs the Modem to dial ‘9’ before dialling the given number)</p><p>&nbsp;</p><p>Syntax: ATD{dial modifier} 1234567 [Enter]<br><br>; = Resume command mode after dialling. If you need to dial a number that is too long to be contained in the command buffer (45 characters for the D command), use the semicolon (;) modifier to separate the dial string into multiple dial commands. All but the last command must end with the ; modifier.<br><br>, = Pause While Dialling. The comma (,) dial modifier causes the modem to pause while dialling. The modem will pause the number of seconds specified in S-Register S8 and then continue dialling. If a pause time longer than the value in <strong><em>S-Register S8</em></strong> needs to be used, it can be increased by either inserting more than one (,) in the dial command line or changing the value of S-Register S8. In the following example, the command accesses the outside (public) telephone line with the 9 dial modifier. Because the comma (,) dial modifier is present, the modem delays before dialling the telephone number 5551212.</p><p>Example: <strong>ATD 9, 5551212 [Enter]</strong></p><p>&nbsp;</p><p>! = Using the Hook Flash. The exclamation point (!) dial modifier causes the modem to go on-hook (hang up) for one-half second and is equivalent to holding down the switch-hook on your telephone for one-half second. This feature is useful when transferring calls.<br><br>W = Wait for a Subsequent Dial Tone. The W dial modifier causes a modem to wait for an additional dial tone before dialling the numbers that follow the W. The length of time the modem waits depends on the value in <strong>S-Register S7</strong>. The modem can be instructed to dial through Private Branch Exchanges (PBXs) or long-distance calling services that require delays during dialling. This can be done with the W command to wait for a secondary dial tone or with a comma (,) command to pause for a fixed time and then dial.</p><p>Example: <strong>ATDT 9 W 12155551212 [Enter]</strong></p><p><strong>&nbsp;</strong></p><p>A/ = Repeat. This command does not use the AT prefix nor does it require a carriage return to enter. Typing this command causes the modem to repeat the last command line entered, and is most useful for redialling telephone numbers that are busy.<br><br>&amp; Fn = Factory Defaults. This command (in which n=0 or 1) returns all parameters to the selected set of factory defaults if the modem has factory defaults; not all modems do.<br><br>H = Hang Up. This command tells the modem to go \"on-hook,\" or disconnect, the telephone line.<br><br>O = Online. This command returns the modem to the on-line mode and is usually used after the escape sequence (+++) to resume communication.<br><br>&nbsp;Zn = Reset Modem. This command (in which n=0 or 1) resets the modem to the configuration profile stored in non-volatile memory location 0 or 1.</p><p>&nbsp;</p><p>*******</p><p>&nbsp;</p><p>After pressing the <strong>Enter</strong> key, the ACKTGen Agent window opens. Click <strong>Generate</strong> button…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240982/original/PAqHKvhpF4OFG7w5P41aE_udmly3hmc82w.png?1687277556\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240982\"></p><p>&nbsp;</p><p>Enter in a future Expiry Date (any)…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240986/original/KeSV1zcddLO57xMOHK4cKhb6_Wvy_UM8HA.png?1687277557\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240986\"></p><p>&nbsp;</p><p>Enter a dummy card security number (any)…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240984/original/L24nQ0PUa-F-Vhu4VnX19H8Vq7lVpDNEyQ.png?1687277556\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240984\"></p><p>&nbsp;</p><p>Click on the <strong>Enter</strong> button and then click <strong>None</strong> button twice when asked to enter <em>PostCode</em> and <em>House/Flat Number</em> details. You should now see a connection being established with the bank if all is successful as seen below…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240991/original/Yse3HIyeovclV6Db2hGt5BdYGjoq0bdg8Q.png?1687277557\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240991\"><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240987/original/1vEk67nOcbhEarclVsHciN5KVA-ZG_wQ2A.png?1687277557\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240987\"></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>Obviously you get an “Authorization failed…” error because the card does not exist.</p><p>&nbsp;</p><p>Now get the customer to test by taking a card payment at the Till from their end.</p><p><strong>&nbsp;</strong></p><p><strong>Solution2</strong></p><p>If the problem is just with one card machine plugged into a particular Till, it could be a Till configuration issue in Back Office&gt;&gt;Till Configuration. Ensure that the below is selected from ‘Credit Card Sys’ drop down. Then Recreate Till Data and Update the Till…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240993/original/2d4xXZKhF38bMBV7P9K8ZmFlrkAT73sqtA.png?1687277557\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240993\"></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><h2>Credit Card: ACK PDQ Credit Card Payments Failing – No ACK Receipt Printing &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p>When a credit card payment is made, if the system does not print an ACK receipt then nothing was sent to the server and therefore no payment was made.</p><p>&nbsp;</p><p>Customers could have a Merac server and one or more ACK servers.</p><p>&nbsp;</p><p>For customers using ACK, they should have two distinct modems:-</p><p>1)<strong><em>Sportster or USRobotics modem</em></strong> (used for Polling allowing the banks to dial in to poll the server).&nbsp;</p><p>2)<strong><em>Chiron 350 modem</em></strong> (used to seek live authorization).</p><p>If a customer receives a Modem Timeout error when trying to make a payment, get the customer to try restart the Chiron modem or if during manual polling, you receive the following error – ‘Error establishing session. Function not valid right now’…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240989/original/u5JpSappb8sMUAG8YjmoflplYT4CfilTqA.png?1687277557\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240989\"></p><p>&nbsp;</p><p>…try restart the Sportster modem.</p><h2>&nbsp;</h2><h2>Credit Card: ACK CashBack not working &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</h2><p>If Cash Back feature not working or available on Till running ACK, do the following:</p><p>Log onto the Till in question and then run C:\\Program Files\\ACT\\EFT\\ACKTGen</p><p>Click the <strong>Configuration</strong> tab and ensure that 'Cash Back' is enabled</p><p>Open the command prompt and then run the following command:-</p><p>&nbsp;</p><p><strong>xml2bin</strong></p><p>&nbsp;</p><p>Wait a couple minutes and then get the Till operator to try again.</p><p>&nbsp;</p><h2>Credit Card: Processing Card Payments from the Till – Card Payment Screen fails to load &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>Problem</strong></p><p>When trying to process a card payment from the Till and pressing <strong>Sub-Total</strong>&gt;&gt;<strong>Credit Card</strong> button, receive handle error “PROGRAM ERROR in: FEPOS / DoCommand”. Invalid procedure call or argument for ‘Show Credit Card payment screen’”. See below…</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240997/original/jSU75QZWHJ7z_SHN7Y5SxW_c-8UI9BY0ww.png?1687277557\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240997\"></p><p>&nbsp;</p><p><strong>Cause and Solution</strong></p><p>The wizard has not yet detected that there are items in the basket so returns the above FEPOS / DoCommand error. To get around this, wait a few more seconds to allow the wizard to finish what it was doing to allow it to determine what is in the basket and then press the <strong>Credit</strong> button again and it should work.</p><p>&nbsp;</p><h2>Credit Card: YesPay – YesEFT Configuration tampered &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>Problem</strong></p><p>When running StartPOSServer.bat receive the following error message: “YESEFT Configuration tampered, Please re-run YesEFTConfig.bat and press OK”.</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240990/original/4VkrM5OY3tHxU3Mf7MjTRME-TgK3idDOoQ.png?1687277557\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240990\"></p><p>&nbsp;</p><p><strong>Cause</strong></p><p>This normally happens if EasyVTerminal picks up any configuration changes in YesEFTConfig.</p><p>&nbsp;</p><p><strong>Solution</strong></p><p>Open YesEFTConfig and ensure that settings are correct, then click <strong>Apply</strong> followed by <strong>OK</strong> and then close YesEFTConfig and try re-run StartPOSServer.bat.</p><p>&nbsp;</p><p>Note!</p><p>Any single change within YesEFTConfig will over-write all contents of the C:\\YESEFT\\config folder with changes to the configuration.</p><p>&nbsp;</p><p>It should run now without any errors</p><p>&nbsp;</p><h2>Credit Card: YesPay – YesEFTInterface error: Unable to load EFT Datasets &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240994/original/RtRxT0FiOk46L4swe1L7tcHWYQ5L6RB12Q.png?1687277557\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240994\"></p><p>&nbsp;</p><p><strong>Solution</strong></p><p>Contact YesPay and ask them to carry out a KeyChange.</p><p>&nbsp;</p><h2>Credit Card : YesPay – YesEFTInterface or StartPOSServer: Port currently owneed by sts.xxxx.STSEMVTerminal.x &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240992/original/kg-B1F65MOFqJ7cU9ithjj_4mSUtksy5UA.png?1687277557\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240992\"></p><p>&nbsp;</p><p><strong>Solution</strong></p><p>1)First check that the PINPAD is connected securely to the POS Till and reboot the PINPAD.</p><p>2)Contact YesPay and ask them to carry out a KeyChange.</p><p>&nbsp;</p><h2>Credit Card: YesPay – Payment Authorization failure message &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>Problem</strong></p><p>If a YesPay Credit Card machine is not able to process payments (e.g. when attempting to process a payment, receive a message to contact your bank to authorize the payment).</p><p><strong>Troubleshooting</strong></p><p>Check the C:\\YesEFT\\YesEFTConfig.bat setup and Till Configuration.&nbsp;</p><p>Also try terminate the javaw.exe background process and then initialize StartPOSServer.bat and then try process another payment.</p><p>The C:\\YesEFT\\StartPOSServer.bat file should be placed in the Windows Startup folder.</p><p>&nbsp;</p><p>YesEFTConfig needs to be set to use COM3 and credit card device needs to be defined (e.g. VX810 or VX820).</p><p>&nbsp;</p><p>When Credit Card transactions are processed using YesPay, javaw.exe is the process that runs in the background on the Till to facilitate such transactions. If only one Till is effected by processing credit card payments, try connect to the Till and terminate javaw.exe on the Till and restart YesPay (you may need to run YesPay again and terminate it again).</p><p>&nbsp;</p><h2>Credit Card: Credit Card Machine CHIP&amp;PIN Working but not Swipe function &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"#_top\">&lt;TOC&gt;</a></h2><p>First try and clean the Card Reader mechanism by using a fresh Card Machine cleaner (an enwrapped card coated with a special cleaning agent) to clean the swipe mechanism at the Till. If the device swipe mechanism is still not reading a card, &nbsp;swap the Credit Card machine with a known working one.</p><p>– importantly to note whilst carrying out this procedure is that you take note of which ports each Card Machine is plugged into as the devices are fixed to these ports. You will need to restart the Till once the known working Card Machine is plugged into the Till.</p><p>&nbsp;</p><h2>Credit Card: Verifone Ocius Setup – Cardholder Copy Receipts not printing correctly &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p><strong>Problem</strong></p><p>When taking card payments at a terminal with Verifone Ocius software installed, two customer receipts are printed. One that includes the items purchased with hashed out Debit/Credit card details and another with a message stating “Unable to retrieve data”.</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031241005/original/oW8DL5MeSPalbNCSTdTSUT8KCNYPzHcnig.png?1687277557\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031241005\"></p><p>&nbsp;</p><p><strong>Fix</strong></p><p>Basically, during the Verifone installation, the <strong><em>program.settings.ccf</em></strong> file which was configured to be located in the local Merac installation folder. This file was not copied to this location following the installation. Instead the file was located in the root (C:\\) which the user has no access to and the POS Till Program is now looking in the local Merac folder. &nbsp;</p><p>Move this file to C:\\Program Files (x86)\\Merac.</p><p>&nbsp;</p><h2>Credit Cards: Integrated Card Machines Payment Cancel Issue &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p>For Merac ver 3.15, if you attempt to cancel an integrated card payment for a booking from the Till, the transaction will be cancelled from the PDQ but Merac still registers the transaction but Payments table is not updated with detail of the transaction which would indicate that the transaction was paid for successfully – which is what we would expect but the transaction details are still updated within the Booking which makes it look like the Booking was paid for.</p><p>&nbsp;</p><p><strong>Fix</strong></p><p>1)Add button to POS Till - Command – “<strong><em>Disable Integrated CC</em></strong>’</p><p>2)Recall Booking from Till and then refund the booking.</p><p>3)Turn on Integrated Card Payments again by reconfiguring the button using – Command “<strong><em>Enable Integrated CC</em></strong>”.</p><p>4)Advise the customer to attempt to take the <strong>Customer Not Present</strong> payment again.</p><p>&nbsp;</p><p>Problem with the above is that Merac now thinks that no payment was taken for the booking because if you follow steps 2) and 3) at the same amount, they balance each other out which in effect means nothing was paid towards the booking as far as Merac is concerning even though by pressing the command buttons below we know that ther customer has charged the card correctly.&nbsp;To fix this you would need to delete all offending transactions from the database!</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031241000/original/pmoGfotw2g8Y49f5DIE0terC_OU0HSDliQ.png?1687277557\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031241000\"></p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031241001/original/THj84MkyCOEGXL4JFpw4-S4C8rV_6V9Wag.png?1687277557\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031241001\"></p><p>&nbsp;</p><h2>Credit Cards: Corrupted Log Files causing issues taking card payments &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"#_top\">&lt;TOC&gt;</a></h2><p>Corrupt Log files causing issues with taking card payments but this would need to be verified by Yespay/Worldpay.</p><p>&nbsp;</p><p>Steps taken to un-corrupt/refresh Yespay log files:</p><p>&nbsp;</p><p>1. Close Easy V terminal application if running.</p><p>&nbsp;</p><p>2. Go to C:\\YESEFT\\conf</p><p>&nbsp;</p><p>3. Rename YESEFTTransactionLog.xml file as BackupYESEFTTransactionLog.xml.</p><p>&nbsp;</p><p>4. Make a copy of YESEFTTransactionLog-Empty.xml file and rename as &nbsp;YESEFTTransactionLog.xml.</p><p>&nbsp;</p><p>5 &nbsp;Rename YESEFTTransactionLog-tmp.xml file as BackupYESEFTTransactionLog-tmp.xml</p><p>&nbsp;</p><p>6. Make a copy of YESEFTTransactionLog-Empty.xml file and rename &nbsp;as &nbsp;YESEFTTransactionLog-tmp.xml.</p><p>&nbsp;</p><p>7. Initialize Easy V terminal twice then try to perform a transaction and share the result.</p><p>&nbsp;</p><p>8. Send us the backup copy of transaction log so we can check if there is any pending transaction to upload.</p><p>&nbsp;</p><p><strong>HHA Error – There is some missing data for the membership</strong></p><p>When scanning an HHA membership card from the POS Terminal, if the below error appears. Verify that mandatory information is included in the setup in the HHA Member details. In the below example, System Options does not have any mandatory data required per membership setup…</p><p>&nbsp;</p><p><strong>MeracData share drive mapping error using UNC path</strong></p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031240999/original/1DA08twpxUC7n9ASt3VB8GMLlOT0qr_6yQ.png?1687277557\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031240999\"></p><p>&nbsp;</p><p><strong>Membership Card missing data error at POS Till</strong></p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031241006/original/ExnIf1Ed1mG99SuB5W3Rb0hzayuR9k739g.png?1687277557\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031241006\"></p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031241004/original/iTEW2Gm4K4Zey-MCrDhHqSlzXKNdDdbUsw.png?1687277557\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031241004\"></p><p>&nbsp;</p><p><a href=\"#_top\">&lt;Beginning_of_DOC&gt;</a></p><p>&nbsp;</p><p><strong>MeracUpdater customer notification message – MeracUpdater not working on a Merac Client</strong></p><p>&nbsp;</p><p>Sent from BlueMail &lt;http://www.bluemail.me/r?b=9660&gt; &nbsp;</p><p>On 11 May 2017, at 03:20, customer notification &lt;customernotifications@merac.co.uk &lt;mailto:customernotifications@merac.co.uk&gt; &gt; wrote:</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 11 May 2017 03:20:40 2017/05/11 03:20:40 - Error in clsSQLFunctions:GetScalarValue - Desc:A transport-level error has occurred when receiving results from the server. (provider: TCP Provider, error: 0 - The specified network name is no longer available.) SQL:SELECT isnull(upcForceUpdateNextCheck,0) as upcForceUpdateNextCheck FROM updateclient WHERE upcComputerName=@ComputerName&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>Date &nbsp; &nbsp; &nbsp; 11 May 2017 03:20:40 &nbsp; &nbsp;</p><p>Customer Name &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Nottingham Castle &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>Computer Name &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NCM-NOTTS-P2 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p>IP Address &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 192.168.1.231 &nbsp; &nbsp;&nbsp;</p><p>AppName &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;MeracUpdater &nbsp;</p><p>AppMeracConnStrName &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Server=81.174.163.111,14339;database=MStore;uid=applogin;pwd=VB6 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp;</p><p><strong>Fix</strong></p><p>Select * from updateclient to workout what till it is.</p><p>Remotely connect and clear Event Viewer logs from Windows and then replace Meracupdater.</p><p>&nbsp;</p><p><img src=\"https://s3-eu-central-1.amazonaws.com/euc-cdn.freshdesk.com/data/helpdesk/attachments/production/103031241002/original/ZzJkp38htBcZ48iyYrNFRNEFCl7-RJrA7Q.png?1687277557\" class=\"fr-fic fr-dii\" data-attachment=\"[object Object]\" data-id=\"103031241002\"></p><p>&nbsp;</p><p>&nbsp;</p><p><strong>Till: Unable to launch the POS Till program</strong></p><p>When trying to run the till program, receive PMStore TXRead error.</p><p>&nbsp;</p><p>===================================================================</p><p>Date and Time: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;24 May 2017 14:37:34</p><p>Operator: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p>Error Source: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;PMStore</p><p>Form/Object: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;CDrawer</p><p>Sub/Function: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TillXRead</p><p>===================================================================</p><p>&nbsp;</p><p>----------------------------------------------------- Error 91 --------------------------------------------------------</p><p>&nbsp;</p><p>Object variable or With block variable not set</p><p>&nbsp;</p><p>===================================================================</p><p>&nbsp;</p><p><strong>Troubleshooting</strong></p><p>Open up a new cashdraw and ZRead.</p><p>Compare the three files created on the new cashdraw with the cashdraw transaction files experiencing the issue to identify what the cause of the issue is. It would normally be something in the opening record that is causing the issue. May want to check if the userid used to open the cashdraw which appears in the opening record of the transaction file exists in the tills local MeracDat.txt file EMP line.</p><p><strong>Workaround</strong></p><p>If the user account id does not exist, readme the id in the opening record to our Merac id ‘100’.</p><p>&nbsp;</p>",
    "user_id": 103081812271,
    "thumbs_up": 0,
    "thumbs_down": 0,
    "hits": 1,
    "seo_data": {},
    "modified_at": "2023-12-22T09:38:43+00:00",
    "modified_by": 103023352668
  },
  {
    "id": 103000138071,
    "title": "2017 Hardware Document",
    "text": "Hardware Merac Standard COM Port assignment: Receipt Printer – COM1 Barcode Scanner – COM2 Credit Card Machines – COM3 Front Line Display – COM4 (for Aures Odysse I and IIs) eSATA (External Serial Advanced Technology Attachment) – Can handle 300MBps USB3.0 – Can handle 625MBps Tills Aures Odysse 500 (2009 model) Aures Odysse-II-G-ELO (Odysse-II model) Aures Odysse I/II (comes default with Embedded XP OS [POS Ready 2009]) Cash Draw = Flytech and OEM drivers for hardware peripherals found on the D:\\ drive. OPOS Devices name = STANDARD if plugged into a Receipt Printer or FTCD if plugged into the standard Cash Draw COM port Front Line Display (referred to as a OCD100) Aures Sango (comes by default with the Windows 7 OS) Cash Draw = Flytech OPOS Devices name = FTCD if plugged into the standard Cash Draw COM port Aures Yuno (comes by default with the Windows 7 OS) Has its own Cash Draw driver’s part of image. Devices name = XCASHBOXSO if plugged into standard Cash Draw COM port Note! The XCASHBOXSO software is user account loggon specific so if the user logs on with another user account, the setup software would need to be re-run to install the drivers to make the Cash Draw work. Partnertech 6215/6315 (CashBase PT6215 or CashBase PT6315) Receipt Printer is integrated/moulded into the actual till but it is connected via USB and automatically installed via (Device Driver is for a PT-6300). You will not see the entry in Partnertech OPOS if not setup in there. Windows Devices and Printers. Has its own Cash Draw driver’s part of image. Devices name = PT6212CASHA if plugged into standard Cash Draw COM port Note! The Aures Odysse 1 and Aures Odysse 2 have different bezel coloured designs (but look similar) which is the outer frame of the till screen. Aures Odysse 1 Main display (LCD) Customer Front Line Display (aka. Line Display) The LCD type display is attached via VGA cable to a VGA port The Dot Matrix or LED type display (Line Display) is attached via VGA cable to serial port COM4 (£150.00 each) MSR Card Reader (located to the right-hand-side) of the main display Operating System: POS Ready 2009 (Embedded XP operating system) Note! POS Ready 2009 is Windows XP Pro Supported by Microsoft till 2018 Odysse I Customer Line Display Removal Remove the two screws encircled below to remove the cover plate. Underneath this there will be an additional four screws to remove (two on either side). Unplug the RJ45 serial connector from the CLD and then remove the front line display unit. Customer Display (ocd100 line display) Pricing: Supplier Cost: £55.00 Merac Sales Cost: £85.00 + VAT + Carriage (price is the same for the Sango and Yuno) Merac 2nd Hand Sales Cost: £35.00 + VAT + Carriage Supplier Initial Inspection Charge: £22.00 If the device is repairable, Aures cost will be £55.00 Supplier P&P: £12.50 Merac P&P: £16.00 Aures Odysse 2 Operating System: Version 7 POS Ready which has Windows 7 operating system installed Odysse 2 Ports Aures Odysse Bundle (costs approx. £1000.00) Till unit MSR Card Reader Dot Matrix Line Display Cash Drawer Printer (port specific) To print a configuration page for the printer, turn off the printer and then press and hold down the button at the same time. Aures Odysse Sango New glossy coated, blue EPOS Till system Cover plate release button Aures Yuno Cable Sleeve under Till Screen cover plate ‘L’ Shape Cable Cover Plate. Press long elongated button at top of plate to release and remove cover plate Aures Nino Wide-screen version EPOS Till system J2 Old block-shaped version EPOS Till system Partnertech Another till very rarely used is the Partnertech PT-6215-EB External Aures Touch Screen - OLC15 ELO Drivers for the Touchscreen and Front Line Display can be found @ http://www.aures-support.fr/EN/screens/ The OLC’s are just monitors with a touch screen on the front so depending on what you have connected to them depends on what drivers you need to install. The touch screen and the VFD use USB for comms so the minimum you need to have connected is a power cable a VGA cable and a USB cable. They have only ever had 2 different touch screens fitted either ELO or POSTOUCH. The touch screen you returned is ELO so for the touch screen to work you need to install the ELO driver. When installing any of the touch screen drivers you need to make sure you select USB only. Cables that exist hardwired to the external monitor: Power VGA (for Display connected to PC) 1 x USB TouchScreen and CLD (standard settings = 9600 baud) When the drivers are installed and cable is plugged in, a ‘prolific USB-Serial COM Port’ is installed which needs to match the Epson OPOS communication port number. 1 x USB (in the front used as a passthough data cable for connecting additional peripheral devices) PS2 (FOR MSR Card Reader) Serial (serial Card Reader - not used) Front Line Displays The Front Line Display is connected to a visible serial COM port for the old J2 tills. For the later Aures tills, the Front Line Display is integrally connected to serial COM port 4. By default once the Front Line Display is is installed and configured:- When the POS Till program is not running the display panel should display the following text: Unavailable When the POS Till program is running and the till operator is logged in, the display panel should display the following text: Available When the POS Till is processing transactions and adding items to the basket, the display panel should display the following text: SubTotal: Partnertech Tills - Customer Line Display (CLD) Setup Partnertech Tills with CLDs that are USB attached using a serial-to-USB adapter do not work with the Merac software. Speak to Dave about this as the customer would be recommended to re-order replacement CLDs that are compatible. Partnertech Tills with CLDs that are serial attached do not work with their proprietary PartnerTechOPOS software (i.e. as you would configure Aures Sango CLDs) but can be configured as DM-D101 using attached devices in Epson OPOS and Back Office Till Configuration. Barcode Scanners You get either MetroLogic/Honeywell or DataLogic barcode scanners (i.e. MetroLogic and DataLogic are two different suppliers of these devices) Not Supported:- Metrologic Honeywell/Voyager MS3780/MS9540/MS9590 (these attach serially only!) PS50 Barcode Scanners – these are Aures supplied proprietary hardware barcode scanners that are USB attached and need to be pre-configured using the appropriate scansheet to enable the POS Till to recognise the barcode being scanned. MetroLogic Honeywell Orbit Scanners – Merac no longer order these devices. MetroLogic Honeywell Genesis Scanners – trigger-based scanner which Merac currently supply. DataLogic Gryphon Scanners – generally non-trigger configured which Merac currently supply. The Data Logic Gryphon 4430 is trigger-based. The AC Power Inline Connector cable plugs into the scanner at the back and then there is a female [Cable end]-to-male [Till end] connection into the back of the Till’s serial COM port. Barcode Scanner plugs into COM2 Note! If a barcode printer has been setup as a Windows attached printer, make sure you choose the ’Type of Printer: Windows Laser/Generic’ and choose the size of the barcode label from the drop down and symbology used to render the barcode. MetroLogic Barcode Scanner setup All MetroLogic barcode scanners are configured through MetrOPOS Administrator as seen below… If connected via serial COM port, launch MetrOPOS Administrator from the Start menu Click on New Profile tab and then configure the device settings and then click the Save button the save the changes. Note! The Model Number must match the same device that exists in the Devices table in SQL and ensure that the Barcode Scanner device Make/Model to match in Back Office. To scan items from the POS Till program correctly, the scansheet would need to be scanned as well. If connected via USB, provided the barcode scanner has been Merac pre-configured using the appropriate scansheet, the scanner should be able to scan barcodes correctly from the Till immediately. You can click the Program button to re-program the Barcode Scanner. When you look at Epson OPOS, if you see the Scanner device greyed out but visible, this means the device is configured somewhere else (i.e. MetrOPOS Administrator)… When the barcode scanner is plugged in, you should see the following device appear within Devices and Printers… Ensure that Back Office Till Configuration is setup correctly to use the Barcode Scanner as seen below… The Barcode Scanner can now be used for scanning barcodes! If the below error appears when trying to Program the barcode scanner from MetrOPOS Administrator, then the device is not configured to the correct serial COM port. Try delete the profile and create it again and if still an issue could be a faulty cable or device. Preparing Honeywell cordless handheld barcode scanner for Stock Take Attach Handheld scanner (either connect via Bluetooth or USB to PC) Update Device Date/Time to match that of the PC it is attached to Enter PIN for the handheld device (known by user) Reset/Refresh Stock Code Carry out Stock Take by scanning item bar codes You get two types of scanners – 1D and 2D scanners. Aures 1D Integrated Scanner (aka. Laser Scan Module) EZConfig v4.5.9_Setup utility is a browser-based utility used to configure the integrated 1D barcode scanner. The settings have been backed up and saved to “C:\\Users\\jtristem\\Documents\\Merac\\Merac\\Software\\1D Aures Integrated Scanner\\ 1D Aures ConfigSettings”. Simply use the utility to connect to the device and import the settings. Note! There is a conflict between your device and EZConfig-Scanning. Perform one of the following steps to correct this issue: 1.Upgrade to a newer firmware. 2.Switch to another interface. 3.Turn on the REM interface by scanning the below barcode or send command REMIFC1. Honeywell Eclipse MS5145 (1D scanner) Contains a single Infra-Red line used to scan barcodes aligned with the infra-red beam. USB attached. Capable of scanning Booking Orders via the Internet (later models can scan orders from a mobile phone). Serial COM port, VGA cable attached. Setup by installing Voyager OPOS software (MetrOPOS Administrator) and can be programmed the same way as you would do for a MetroLogic Orbit MS7120 (2D scanner). MS9590 (1D Scanner) PS2 attached connection. Can plug into a Wedge keyboard connection using PS2. Does not support Serial-USB adapter connections. MetroLogic Orbit MS7120 (2D scanner) Contains multi Infra-Red lines in different directions enabling you to scan barcodes in different directions. Serial COM port, VGA cable attached. Configuration: MetrOPOS Administrator software (used to define hardware profile) – only need to be defined for serial COM port attached devices. USB attached is Plug & Play. No need to configure via MetrOPOS Administrator. Other 2D scanners include the MetroLogic Voyager MS9540 – there is both the serial COM port version and the USB version. The serial COM version is configured using MetrOPOS Administrator and Back Office Till Configuration whereas the USB version is PnP and is only configured through the Back Office Till Configuration. DataLogic Gryphon 4430 Supports Serial-USB adapter connections. The DataLogic Gryphon barcode scanner which is connected via USB - only needs to be plugged in and configured in Back Office Till Configuration: Barcode Reader: Honeywell Genesis 7580 Barcode Scanner USB attached. Note! If the device fails to scan, get the customer to scan the reset barcode from the scan sheet and then rescan all barcodes from top to bottom. If this fails, download the ‘Reset to Factory Settings’ readme pdf document for the particular Make/Model and then scan the code that resets the custom settings and then scan the code that resets the device to factory defaults and the try rescanning all barcodes from top to bottom and this should fix the issue (Craig has the two reset barcodes). Honeywell 1202g Barcode Scanner Wireless 2D Barcode Scanner 1)Image Scanners: Genesis, DataLogic Gryphon Uses graphic recognition to read a barcode. 2)Voyager MS9590 (1D) 3)MetroLogic Orbit (2D) Barcode Formats (Symbologies): One Dimension Type Barcodes UPC-A Consists of a 12 numeric digit barcode (encodes 12 numeric digits) UPC-E Consists of a 6 numeric digit barcode (Industry: Retail) EAN8 Consists of an 8 numeric digit barcode. Used to provide barcodes on products where there is very limited space available, like candles etc. EAN13 Consists of a 13 numeric digit barcode. (Industry: Retail) Code39 This barcode font or symbology uses a combination of both digits and characters. Similar but not as compact as Code128. Stick to 13 characters max length. Code128 These are compact, high density barcodes. Code128 barcodes are powerful and can store vast amounts of information about the product being sold. Stick to 13 characters max length. Two Dimension Type Barcodes QR Code These are 2D matrix barcodes which also store vast amount of information. Global Trade Item Number (GTIN) ID Formats GTIN-8: EAN8 GTIN-12: UPC-A GTIN-13: EAN13 GTIN-14: (not generally used by our customers) How to Calculate the Check Digit Value manually A check digit, also known as a checksum character, is the number located on the far right side of a bar code. The purpose of a check digit is to verify that the information on the barcode has been entered correctly. The barcode reader's decoder calculates the checksum by performing a series of mathematical operations on the digits that precede the check digit, and comparing the result of the calculation to the value of the check digit. Typically, if the check digit matches the result of the calculation, the reader emits a signal (such as a beep) to acknowledge that the results match, and the scan has been successful. Example of calculating an EAN13 barcode Check Digit:- Receipt Printers ODP200H G - Only uses THERMAL RECEIPT PRINTER 3.1 driver TRP100 - Only uses THERMAL RECEIPT PRINTER 4.1 driver ODP333 - Uses THERMAL RECEIPT PRINTER 4.0, 4.1 and 4.3 drivers Installing serial attached ODP200 Thermal Receipt Printer via USB Download Thermal Receipt Printer driver for ODP/100/200/333 printer attached via USB from Aures website http://www.aures-support.fr/UK/driver-download/posligne-printer-drivers/ Installing serial attached ODP100/ODP200/ODP333 Thermal Receipt Printer via Epson OPOS ODP200/ODP333 serial attached printer setup via EPSON OPOS as TM-T88III (baud rate set to 19200) and Cash Draw plugged into 'DK' port on back of printer (Till Configuration Receipt Printer: TM-T88III and Cash Draw: Standard) Example:- Note! All receipt printers no matter what Make and Model use generally 80mmx80mm receipt rolls. POSLIGNE TRP100 Receipt Printer - Setup in OPOS using TM-T88III to COM Port. This needs to have the Baud rate set to either 6900 or 19200. (The Posligne TRP100 uses THERMAL RECEIPT PRINTER 4.30) Epson TM-Tx (e.g. Epson TM-TII, Epson TM-TIII, Epson TM-TIV, Epson TM-TV). Serial COM port, VGA cable attached (connected to serial port COM1). Setup:- In order to configure a receipt printer to a till system, you need to ensure that you setup the printer settings to match the Baud Rate of the printer else it will not print. Note! You get both non-thermal and thermal receipt printers. Thermal receipt printers normally print on glossy paper that responds to heat. Aures POSLigne TRP ODP200 (older model) Printer and Aures POSLigne TRP ODP333 (later model) Printer Usually connected via USB as a Windows printer which faster than using a serial cable connection. Once the Thermal Receipt Printer driver is installed, rename the printer in Devices and Printers to WINRECEIPT. RS-232 USB DK A/C Power Network Configuring a POSLigne ODP333 Receipt Printer This is normally a USB attached Printer so it is likely if the receipt printer is not working that the printer could be either using an old WINRECEIPT USB port in which case the printer will not be able to pick up jobs allocated to the print queue. Solution Either try plugging the printer device into different ports to check which one works, open Printer Properties and from the Ports tab, change the USB port number to the correct port number or reinstall the print drivers from C:\\VENDOR THERMAL PRINTER 3.X\\ as USB printer or run the driver installation from the D:\\ drive if the folder is not present from the root of the C:\\ drive. POSLigne ODP333 Aures Printer Do not set as Default and no need to Reboot following driver install! Rename the old WINRECEIPT printer and change the name of the new printer to WINRECEIPT. Done! Posligne ODP200H-G The above specific Model uses the below drivers only through Windows (i.e. USB or serial attached) - VENDOR THERMAL PRINTER 3.X. Epson TM-88III and Epson TM-88IV and Epson TM-T88V and Cash Draw The Cash Drawer is normally plugged into the receipt printer using an RJ11 connector into the port labelled ‘DK’ which stands for ‘Draw Kicker’. Male Fly-Lead RJ45 Connector plugs into the COM port at the back of the Till Male RS-232 serial cable connector plugs into the back of the printer Configure the Epson Receipt Printer via Epson OPOS. Then configure the Cash Draw being sure to specify the same COM port as the receipt printer given that the Cash Draw is plugged into the Receipt Printer – the Cash Draw needs to be added as a Standard Cash Draw device and communication settings COM Port and Baud Rate need to match that of the Receipt Printer. The Receipt Printer will now function as the ‘master device’ and since the printer is configured to communicate via a serial COM port, the Cash Draw will only open as and when needed. If the printer was setup as a USB attached printer via Windows or Epson OPOS, the Cash Draw will open every time paper passes through the Receipt Printer if plugged into the printer ‘DK’ port. Configuring Epson TM-T88IV USB Attached Receipt Printer via OPOS Right-click on POSPrinter and then add new device for the printer by selecting the Model Name suffixed with the letter ‘U’ and then click Make Port button to create a new USB attached port to connect to the printer and then run a ‘Health Check’ to see if the printer is detected. Give the device listed in Epson ADK OPOS software a Logical Device Name (LDN) to match that of what is specified in the Devices table within the Merac Database. Configuring Epson TM-T88IV USB Attached Receipt Printer through Windows Connect the printer to the PC USB port and then power on the printer. Run the Windows device driver setup located at C:\\Users\\jtristem\\Documents\\Merac\\Software\\Epson Advanced Windows Print Drivers\\. During the setup specify to create a USB port. The Printer should appear as follows in Printer Properties… Rename the printer to WINRECEIPT and then ensure Till Configuration is setup correctly and then Recreate Till Data and Update the till and test. Epson ODP200 USB attached receipt printer. No longer supplied. Now need to order the POSLigne ODP333 instead. EPSON OPOS EPSON OPOS V2.00 SOFTWARE USB attached Serial RS-232 attached EPSON Printer Cash Draw Sharing same COM Port as Receipt Printer which is set as the ‘Master Device’ (Supported) In the above configuration, the Cash Draw will only open as and when needed! EPSON OPOS V2.00 SOFTWARE USB attached Serial RS-232 attached NON-EPSON Printer Cash Draw Sharing same COM Port as Receipt Printer which is set as the ‘Master Device’ with matching Baud Rate (Not Supported) (Supported) Note! Non-Epson we mean by Aures Posligne and ODP200 or ODP1000 (receipt printer released roughly around the same time) and ODP333. Use Epson TM-T88III drivers. Merac do not provide support for connecting any other printer other than what Aures of Epson. In the above configuration, the Cash Draw will only open as and when needed! Also if the Cash Draw is plugged into the dedicated Cash Draw port at the back of the till, the Cash Draw will only open as and when needed. If a Receipt Printer is setup as a USB attached Printer, the Cash Draw will open each and every time paper passes through the receipt printer regardless whether setup as a Windows Printer (WINRECEIPT) or OPOS USB attached Printer. J2 Tills are setup in a similar fashion as above when the Cash Draw is connected to the Epson Receipt Printer. Windows Printing – USB Attached vs. COM Attached If you install and configure Windows print drivers to print via serial COM port (using WINRECEIPT), the Receipt or whatever you are printing will print very slowly. Better to print via USB which has a much faster bit-rate that the baud-rate of serial ports. Receipt Printer Basic Troubleshooting Aures Posligne ODP200 Receipt printer receipt roll is inserted as below because the thermal head is on the underside of the paper which means the printout of the receipt will also be on the underside of the receipt paper. If the receipt printer is printing partial text, ensure the printhead is cleaned using a slightly damp kitchen roll or blue roll. Ensure you wipe the entire length of the printhead encircled below: Aures Posligne ODP333 Receipt printer receipt roll is inserted so it is fed over-the-top (i.e. opposite roll pacement orientation to the above). Because the thermal head is on the topside of the paper, this means that the printout of the receipt will also be on the topside of the receipt paper. Note! These are thermal printers so need to verify that the paper inserted is thermal paper on non-thermal. To test, scratch the surface of the paper and if a black mark appear in the area scratched, it is the thermal side. Printhead Issues If the receipt prints a partial printout of the receipt data onto the receipt, either the thermal printhead is dirty (i.e. can be cleaned by wetting the tip of your finger or blueroll slightly and wiping the entire length of the printhead) or the thermal printhead is damaged and needs to be repaired. Epson TM-U220 Networked receipt printer. Used in Catering outlets (e.g. kitchen areas) and are therefore non-thermal printers. A Ribbon printer. Below shows you how a network attached printer can be connected directly to a Till using a CAT5E-COM Converter. TMNet WinConfig The below Epson printer network discovery utility can be used to determine the IP and MAC address of the device connected to the network. Installing Bluetooth printer with Tablet 1)Pair the Bluetooth printer with the Tablet and the print device will be assigned a virtual COM port automatically (this is done because Tablets do not have COM ports but USB ports). You will see this picked up in Device Manager – Ports (COM and LPT). 2)Now add printer in Devices and Printers ensuring you select the appropriate virtual COM port and rename the printer to WINRECEIPT. Bluetooth Receipt Printer – Epson TM-P80 Installation Instructions: Install Epson TM-P80 Bluetooth Printer driver Stop \"Bluetooth Handsfree Service\" Once the drivers are installed, disable onboard bluetooth service and the customer would need to use a bluetooth USB dongle as opposed to onboard (Harry says onboard is very unrelaibale hence why this option is being used on mobile tablets (e.g. Lynx1010) and WINPads). Install the Bluetooth Dongle (Device Manager:ASUS USB-BT400) (In Device Manager\\Bluetooth, the device ASUS USB-BT400 should now appear) Open Windows System Settings and go to Bluetooth and Search and Pair to the bluetooth printer device Once paired, you should see a message “Driver is unavailable” (In Device Manager\\Bluetooth, the device TMP80xxx should now appear) Navigate to \"C:Program Files\\EPSON\\Epson Advanced Print Driver 5\\\" and run PrinterReg.exe. Enter all the details for the bluetooth printer and then save the settings. You can verify what COM port has been assigned by opening Device Manager and clicking Hardware tab for the Epson TM-P80xxxx properties window. The printer will be added to Devices and Printers Done! Installing a O’Niel OC2 Bluetooth Printer 1)First install BlueSoleil software utility 2)Install device driver: Versions 7.4.3 Easy Print Driver - C:\\Users\\jtristem\\Documents\\Merac\\Merac\\Software\\Blutooth Printers\\ONiel OC2 Bluetooth Printer\\ONeil OC2 Printer Driver files ver7.4.3.zip OR C:\\Users\\jtristem\\Documents\\Merac\\Merac\\Software\\Blutooth Printers\\ONiel OC2 Bluetooth Printer\\ONeil OC2 Printer Driver software - Datamax WORKING VERSION.zip 3)Once the print driver is installed, open BlueSoleil and search for, install services and pair to the device. Verify that “AutoConnect” is set in BlueSoleil. 4)Verify the COM port number used for pairing and then change the value in Windows Devices and Printers. If the COM port is not available, you may need to reboot Windows. Done! Membership Card Printer Zebra P330i Old model membership card printer USB attached Zebra ZXP Series 7 USB attached The Zebra ZXP Series 3 Card Printer connected via USB is installed by plugging in and downloading and installing drivers. The printer needs to be turned off to install the drivers. Driver version: Note! Old legacy devices e.g. Zebra p110i is not supported by Merac. Partnertech Receipt printer (Epson BA-T500II) Built-in till receipt printer. Partnertech has a built in Receipt Printer. The PartnerTech drivers including OPOS can be downloaded from: http://www.partnertechcorp.com/service%20support/downloads.html This can only be used if you are attached PartnerTech proprietary peripherals (e.g. Receipt Printer, Cash Draw etc.) into the PartnerTech Till. Ticket Printers Citizen ticket printer USB attached printer. Citizen CLP-521 Ticket Printer By default the printer hardware is configured to read spaces to determine when a ticket has been completely fed through the paper feed. To enabled ‘black marker’ sensing, the device needs to be programmed to do so through a series of button presses. *** Selecting the sensor type: “See Through” or “Reflective” (aka. Black Marker) The printer’s default setting is “See Through” (aka. Label Gap) which is designed for standard tickets/labels. ♦ See Through is also known as “Label Gap” or “Transparent” ♦ Reflective is also known as “Black mark”, “Black Reg Mark” or “Black Line”. Depending on sensor type: If the printer is now in Transparent mode the buzzer sounds once. If the printer is now in Reflective mode the buzzer sounds twice and the Print LED flashes. 1)Power off the printer 2)Hold down the PAUSE, FEED and STOP buttons. 3)Release the buttons when the CONDITION LED lights up. 4)Hold down the MODE/REPEAT button and press the STOP button 5)Press the feed button and see if the printer feeds and cuts correctly. If not, repeat Steps 1) – 5) and let me know the outcome. *** Also Print Preference alignment settings need to be configured e.g. (ticket dimensions, cut or tear etc.). Drivers also very seldom fail. Ticket Printer feeding through more than one ticket and not printing Check alignment of the Opto-Reader (move to far left corner) and ensure that the Tickets are inserted into the printer correctly. If still feeding through incorrectly could be that the Opto-Reader is damaged or dirty or not aligned at the Stop Marker. Note! Known working version driver is 7.7.2 – download the latest version from the Citizen website. Driver version 7.1.9.5 also works as this has been installed at Heights of Abraham. Zebra GX430T and Zebra GK420D Note! Zebra printers are thermal printers so thermal labels are required else nothing will print out on the label. Model Driver versions: Once the printer settings have been defined, calibrate the printer by selecting Tools>>Action>>Calibrate media>>click the Send button Note! The GK420D prints both Tickets and Barcode Labels. Also the following barcode label settings need to be defined… (e.g. for 25 x 38mm barcode labels) WristBand Printer The device is called a TSC Printer. Only used by Adventure Island and SandCastle Water Park but EH also have the facility but don’t use them. Zebra ticket printer Parallel port or USB attached (more popular) printer. Networked ticket printer. Zebra GK-420D Normally USB attached. Back Office device name is ‘Zebra’. Install as ‘Manual Mode’ type installation. Requires Merac update for this to work! Star Micronics TSP400 ticket printer Attached by serial COM port. Driver install for TSP400 for WinXP/2000 http://www.starmicronics.com/support/default.aspx?printerCode=TSP400 Download and Install the drivers - either Line Mode (recommended) or alternative OPOS driver Settings Jumper Switches for configuring baud rate: 10 Pin Dip Switch of which the first 8 starting from the left most switch is the 8-bit dip switch for which we are concerned. (left-most is the LSB) Ticket Alignment: As you can see above, the ticket cutter marker strip is just past the centre, right-hand-side. Below, you can see the Opto-Reader on the ticket printer is positioned just past centre, right-hand-side. This would give you an indication of exactly how to align the tickets in the ticket printer. Boca ticket printer Windows Driver download: http://www.tls-bocasystems.com/zip/printer_drivers.zip Instructions: http://www.tls-bocasystems.com/pdf/windows-driver-install-guide.pdf Has a built-in ticket cutter with Opto-Reader mechanism. The Opto-Reader mechanism is used to read the black line on the underside of the ticket to determine when to stop feeding. A Thermal printer – thermal side of print roll needs to be facing upwards so the till roll needs to feed through the paper over and through the paper feeder not under and through the paper feeder. Thermal Side of Till Roll Towards Paper Feed Mechanism Can get double-printers in one unit. Backing Up a Windows USB Attached Ticket Printer and Configuring General and Advanced Setting Open printer properties and import driver settings if there are any (e.g. these driver settings may include customer printer configuration Form containing Ticket dimension settings, Stop Marker position etc.). From a Till with a known working ticket printer, select Printer Properties>>Tools>>click on Driver Options button and click Export button… OR Printer Properties>>Advanced tab>>Printing Defaults button>>Import/Export settings tab… Note! The import does not import Advanced settings so you will have to check General/Preferences and copy these to Advanced/Printing Defaults. If the printer was initially setup as a windows USB attached printer and you rename the printer and reinstall the print driver - if no additional printer appears in Devices and Printers then it means that the printer has been plugged into the original port in which case all you have to do is rename the original renamed printer back to what it was and the printer should work. If the USB data cable remains in the same USB port and you swap out the device with the same model, Windows may create a new printer in Devices and Printers. Barcode Printers Epson TM-L90 This barcode printer prints a Description, Barcode and Price. Note! The orientation of the printer must look as seen above else the printer will not be detected by the device from which it is plugged into. USB attached Epson TM-L90 Barcode Printer Installation and Configuration Install Options:- Epson OPOS ADK setup (USE THIS METHOD FOR OLD HARDWARE!!) Download and install the Epson OPOS software if not already installed – “C:\\Users\\jtristem\\Documents\\Merac\\Software\\EpsonOPOS\\EPSON OPOS ADK ver2.50E OPOS - L90 Serial OPOS Older Driver” (Epson ADK ver250E) OR “C:\\Users\\jtristem\\Documents\\Merac\\Software\\EpsonOPOS\\EPSON OPOS ADK ver2.68E OPOS 1.11 - L90 USB OPOS Latest” (Epson ADK ver268E) Right-click POSPrinter and then add new device for the printer by selecting the Model Name suffixed with the letter ‘U’ if the older version OPOS (Epson ADK ver250E) OR letter ‘M’ if the later version OPOS (Epson ADK ver268E) is installed and then click Make Port button to create a new USB attached port to connect to the printer. You can check what is available through Back Office Till Configuration. Now run a ‘Health Check’ to see if the printer is detected. Note! If the device is not detected despite being powered on and plugged in correctly, check ‘Devices and Printers’ and if there is an ‘Unspecified’ exclamation marked unidentified device listed, it is likely the interface drivers are not installed. Download and install them before trying again by reinstalling Epson OPOS software. BaudRate needs to be set to either 9600 or 19200 for USB devices. Lastly, install all the BarCode Fonts. If after installing and configuring the TM-L90 Barcode Label printer, the device is still not able to print barcode labels, then the printer could either not be positioned correctly (i.e. upright) or the barcode label roll is not inserted correctly or there is a hardware fault (i.e. faulty cable or printer device). Because this is setup through Epson OPOS, it is not a Windows printer so you will not see the device in the ‘Printer and Faxes’ window. No need to define any settings for it in Till Configuration as there is no BarCode Printer option to define. Windows setup Once the device has been plugged into the USB port of the computer and powered on, the following device should appear in ‘Devices and Printers’. No need to configure it through Back Office because there is no Till Configuration defined settings for barcode printers. Note! If plugged in via serial, always use Epson ADK ver250E and the Device Name to be set to TM-L90 with no LDN required. This is required whether you use a serial-to-USB adapter or connected direct using serial lead, you need to install Epson OPOS and setup the device as a OPOS printer via COM port. BaudRate for serial needs to be set to either 9600 or 19200. Download and install the Epson Advanced Printer Driver – located at \\\\svrcompany\\ftproot\\JTristem\\Merac\\Software\\Epson TM-L90 Windows Drivers\\APD_452E.exe The TM-L90 Printer should now appear as a printer in ‘Devices and Printers’. (the TM-L90 barcode printer is plugged into the Till using a USB cable and has a separate AC Power cable plugged into a standard power socket) Lastly, change the General and Advanced ‘Layout’ tabbed page settings in Print Properties to match the dimensions of the barcode labels being used… Creating the Barcode Label Dimensions Add/Edit>>Advanced Settings>>Add Paper Size button and give the custom paper size settings a suitable name and adjust the settings to match the dimensions of the barcode labels… (ver452E (recommended) or ver415E) 39 X 25mm Barcode Labels:- 63 x 25mm Barcode Labels:- Installing an Epson TM-L90 Barcode Label Printer via Serial A TM-L90 printer is setup through Epson OPOS and label sizes are hard coded in our Merac software. Note! If the TM-L90 barcode printer is old, it only works connected serially and configuring through Epson OPOS. New version TM-L90 devices need to be plugged in by USB and installed as a Windows printer. Now set both General/Main and Advanced settings Layout to match the name of the Settings profile defined earlier. Open any Stock item from Back Office and make the following changes… Change the ‘left offset’ to ‘1’ and double-click on the barcode and change the font size to ‘30’… Change ‘Paper size name’ drop box to the name of the label settings profile setup earlier and then click the Set to printer button. Install BarCode Fonts. Open Back Office Stock Index and test that barcode printing works. Done! Note! If the label prints the barcode correctly but truncates the price from the right-hand-side, an upgrade is is required on the Merac server to fix the issue. Zebra Barcode Label Printer Back Office Settings (60mm x 10mm) Cash Drawers Makes: Flytech or Cashbase (larger size form factor Cash Draw) Aures supply two types of Cash Draws:- Compatible (this has a glossy front face and has Aures written on it) This is a small form factor Cash Draw Standard This is the standard form factor size Cash Draw Note! Only Receipt Printers and MSR Card Readers can be built into certain Make/Model POS Tills, NOT Cash Draws. Aures Odysse SANGOs have Flytech motherboards and use Flytech OPOS (software to be installed - OPOS Cash Draw v1.1.3 - and is located on D:\\Flytech OPOS\\Cash Drawer_OPOS_V1.0.13 which is by default located in a separate partition on the hard drive setup by Aures) to configure the Cash Draw provided the Cash Draw is plugged into the dedicated COM port at the back of the Till else if the Cash Draw is plugged into a receipt printer and not using Windows driver printing, configure the Cash Draw from the OPOS program used to configure the printer – the Cash Draw must be configured as a Standard Cash Draw and it will inherit COM Settings of the printer. Location of Flytech registry key: HKEY_LOCAL_MACHINE\\SOFTWARE\\OLEforRetail Aures Odysse YUNOs have different motherboards and the Cash Draw drivers need to be installed separately. If a printer has been configured as a Windows printer, you can share the printer from one till to another over the network just like you can with any other Windows network attached printer. OPOS configured printers cannot be shared. Uses an RJ11 connection to attach to a till. (no image) Physical Cash Drawer – Models and Configuration J2 Cash Drawers plug into dedicated RJ11 COM port (card less reliable and resilient). Most Cash Draws can plug into the back of a Receipt Printer in an RJ11 port. EPSON Cash Drawers plug into a standard serial printer COM port have a Baud Rate = 19200. XRead allows you to print a receipt and open the Cash Drawer. Flytech Cash Drawer Test Procedure OPOS Cash Draw (Flytech) Configuration Simply plug the Flytech Cash Draw into the Cash Draw serial port (labelled on the Till) and then run OPOS Cash Draw and then change the following:- 1)Change drop-down to ‘INTERACTIVE’ 2)Click Open Service button 3)Click Enable CD button 4)Click Check Health button A status message window will appear whereby you press the Open Draw button. Configuring opening a CashDraw plugged into an Epson TM-T88V Receipt Printer installed via Windows Card Machines If a Card Machine is plugged into a USB port using a Serial-to-USB Converter, then Windows will setup the device connected to a ‘Virtual COM Port’. This requires the generic USB-serial drivers to be installed first. Open Device Manager and check which Virtual COM Port has been detected by Windows. Contactless Ingenico Card Machines (IPP350 Ingenico Pinpad) These devices work only with WorldPay software (EasyVTerminal ver3.4.2.2 or higher) Configuring the Device Speed: Default Message – Ready Menu button Press 1-RA1 Option 1 – COMMs Method Password: 1985 Comm Speed 115200bps (make sure this baud rate is set) If the Device is connected via Serial Port, this is what the Home screen should display:- RAM0922 RS232 S/N: 000000XXXXX Ready If 'VCOM/USB' is displayed as opposed to 'RS232', follow the below instructions: On the keypad press the MENU button. Press 1-RA1. Enter password = 1985 Press 0 to select Comms Method, will get the below options- 0. RS-232 1. VCOM/USB 2. TCP/IP Then select the RS-232 to set it to Serial connection. Press cancel to go to Home screen of PED. Installing Ingenico IPP350 USB drivers (JUNGO v3.4) During the installation of the device drivers, make sure that Force COM Port detection = and Uninstall Microsoft files = . Once the drivers are installed, Device Manager will appear with a “Sagem Telium COM Port” or “Sagem Telium COM Port (COMx)” entry. Windows may need to be restarted if the device does not appear in Device Manager. Make sure the serial COM port number set here matches that within the Worldpay software. Vendor: Verifone (VX810s/VX820s) These devices work with both YesPay and Verifone Ocius Sentinel software. Each Card Terminal has an associated S/N and PTID (Payment Terminal ID) which is unique to the device but this is only for card machines that use Verifone Ocius Sentinel software as the provider – i.e. the software is paired with the device, else if using YesPay, you can plug any card machines into any terminal with the YesPay EasyVTerminal software installed ad-hoc. Dione Secura (older model) Disadvantage: If the device is dropped, it enters into “Tamper Detect Mode” and the device will need to be returned back to the supplier. *Serial COM port, VGA attached (if the customer wants a USB attached device, the firmware would have to be updated on the device). VX810 *Serial COM port, VGA attached (if the customer wants a USB attached device, the firmware would have to updated on the device). VX820 *Serial COM port, VGA attached (if the customer wants a USB attached device, the firmware would have to updated on the device). Note! The obvious distinction between the VX810 and VX820 is that the 810 has four function keys (F1 – F4) on the top right-hand-side of the screen whereas the 820 does not. Inline AC Power Connection (this power supply is for the Verifone VX820) Handheld PDAs Note! The Metrologic Optimus is a very old StockTake PDA HandHeld Scanner (+/- 10 years old) that Dave would setup as it has a DOS-based interface and updating Stock Codes (aka. refreshing stock codes) is all done through Back Office ‘Stock Receipts/Stock Take’ window. DataLogic Lynx Used for Table Ordering, Stock Control, Ticket Scanning (Members and Bookings). If the Lynx scanner fails to scan barcodes, you may want to check that ‘Wedge’ is enabled. The device will only scan barcodes in wedge mode. Casio (DTX820) and Honeywell Dolphin handheld scanner The Honeywell is touch-screen capable. These barcode hand scanners are used for Access Control, Bookings, Memberships and Stock Control. Honeywell 6000 Handheld Scanner – Connecting to WiFi Below are instructions which may be slightly different to what you may expect to see on your handheld scanner screen depending on what mode OS is installed. Connecting to WiFi – (aka. Obtaining a Secure Wireless Connection (SWC) on the Dolphin 6000 PDA device) Steps:- Firstly, the default home screen for the device is set to Windows Default (Titanium) Home Screen and ideally we need it changed to Classic Today Screen layout. To do this, follow the below: Tap Start button (Windows chequered flag icon)>>Getting Started>>Set Background. Tap the arrow next to “Change the background image” in Settings\\Home. Tap Items on the horizontal scroll bar at the top of the screen. Un-check Windows Default box and switch to the Classic screen layout. Select the items (e.g. Calendar, Time, Email etc.) you want to appear on the Classic Today screen. Tap OK and OK again. Done! Enable WLAN Radio Driver to connect to WiFi Access Point: The radio driver must be enabled for the radio to transmit a signal. You cannot connect to a network unless the radio is enabled. Note! The parameters you enter in the WLAN SWC depend entirely upon the wireless network established in your facility dictated and configured by your IT Department or whoever configured your wireless network access Router. Open WLAN SWC. Tap the Config tab and then tap New. Note! You can create multiple connection profiles that use the same SSID by giving each profile a unique name in the “Profile Name” field on the Network window. Type the SSID (which is the name of the Access Point configured on the wireless network access Router). Select a specific band if the connection is to be limited to b/g/n or a/n or leave band as Auto. Select the Assoc.Mode that corresponds to your network configuration from the drop-down list. This pertains to the authentication or encryption standards defined by whoever configured or setup the Router wireless network AccessPoint. Enter all other required information. Once done, tap OK. You are returned to the Config tab where the SSID now appears in the list. Select the device in the list and tap Activate. The configuration activates and the Dolphin terminal attempts to connect to the network wirelessly through your Access Point Router according to the parameters you entered. The Status tab appears displaying the connection status provided you have switched to Classic Today screen layout. The customer would likely have to run through the connection setup with their IT Department as they will know who actually setup and configured the wireless network connection settings for the Router which they will need to specify when attempting to connect through the wireless access point on the network. MetroLogic Optimus SP5500 This is a very old legacy Stock Control handheld PDA which is DOS-based Have to install manually since Windows Mobile Device Center cannot be used to setup and connect to the device. PartnerTech 0T200 Full OS installed on device. Comes with built-in Micro-USB connection to be used with a printer or USB keyboard etc. Table Ordering PDA. (Castle Howard use this hardware) Checking Firmware Version: Serial Number Lynx PDA Handheld Scanner Tablets (aka. WINPADS) The pointer device (i.e. touch screen pen) is referred to as a ‘Stylus’. This device comes with a Bluetooth printer (Zebra EM220II) The bluetooth device is paired using Bluetooth software called ‘Blue Soleil’ and also needs the Zebra print drivers installed separately. Both device created in Devices and Printers and device detected and paired in Blue Soleil needs to be configured with matching Virtual COM ports. A Tablet only requires an Internet connection to enable the Tablet to function as a mobile till. The mobile till can work offline (i.e. have no active connection with the Merac server). For Memberships/Bookings etc. (i.e. any action required to check validity), the mobile till needs to be online in order to establish a connection with the Merac database. Configuring the Integrated 1D/2D Barcode Scanner Calibrate Barcode Scanning Device using the appropriate Scan Sheet Open Widgets app and click Filter tab and then add Prefix: {32} Test by scanning any random barcode into notepad and ensure that the barcode is returned in the following format: Installing and setting up a CashDraw Kicker/Trigger for Conker tab USB Attached CashDraw Gigatek Intelligent USB cash drawer kicker – comes with a USB-Serial COM Port prolific driver that needs to be added to Epson OPOS as a Standard CashDraw. Install the USB-Serial Universal drivers “PL2303_Prolific_DriverInstaller_v10518”. Connect the CashDraw Kicker and CashDraw. Open Epson OPOS and add a new CashDraw device as ‘Standard’ using same COM port as USB-Serial Prolific COM Port number assigned in Device Manager. Set CashDraw in Till Configuration to Standard. Recreate Till Data and Update the till. Done! Re-Calibrating Tablet Screens Steps:- Open Control Panel>>Tablet PC Settings Click on Calibrate button and follow instructions… The calibration software will ask you to use your finger to touch the screen where ever the black cross pin markers are and then when complete, click Save. Done! Note! Sometimes if Calibrate button has been pressed more than once and settings saved this breaks or distorts the calibration. If so, try press the adjacent Reset button following by Calibrate button to fix this. Re-Calibrating Aures Odysse II These are re-calibrated using Aures ELO proprietary software.",
    "category": "INTERNAL Support Articles",
    "folder": "2017 Support Documents",
    "created_at": "2023-06-27T09:17:44+01:00",
    "updated_at": "2023-06-27T09:17:47+01:00",
    "status": 2,
    "tags": [],
    "description": "<h1>Hardware</h1><h3>&nbsp;</h3><p>&nbsp;</p><p><u>Merac Standard COM Port assignment</u>:</p><p>Receipt Printer – COM1</p><p>Barcode Scanner – COM2</p><p>Credit Card Machines – COM3</p><p>Front Line Display – COM4 (for Aures Odysse I and IIs)</p><p>&nbsp;</p><p>eSATA (External Serial Advanced Technology Attachment)&nbsp;– Can handle 300MBps</p><p>USB3.0 – Can handle 625MBps</p><p>&nbsp;</p><h3>Tills</h3><p>Aures Odysse 500 (2009 model)</p><p>Aures Odysse-II-G-ELO (Odysse-II model)</p><p>Aures Odysse I/II (comes default with Embedded XP OS [POS Ready 2009])</p><ul><li><strong><em>Cash Draw</em></strong> = Flytech and OEM drivers for hardware peripherals found on the D:\\ drive.</li></ul><p>OPOS Devices name = STANDARD if plugged into a Receipt Printer or FTCD if plugged into the standard Cash Draw COM port</p><ul><li><strong><em>Front Line Display</em></strong> (referred to as a OCD100)</li></ul><p>Aures Sango (comes by default with the Windows 7 OS)</p><ul><li><strong><em>Cash Draw</em></strong> = Flytech</li></ul><p>OPOS Devices name = FTCD if plugged into the standard Cash Draw COM port</p><p>Aures Yuno (comes by default with the Windows 7 OS)</p><ul><li>Has its own Cash Draw driver’s part of image.</li><li>Devices name = XCASHBOXSO if plugged into standard Cash Draw COM port</li></ul><p>Note!</p><p>The XCASHBOXSO software is user account loggon specific so if the user logs on with another user account, the setup software would need to be re-run to install the drivers to make the Cash Draw work.</p><p>Partnertech 6215/6315 (CashBase PT6215 or CashBase PT6315)</p><ul><li>Receipt Printer is integrated/moulded into the actual till but it is connected via USB and automatically installed via (Device Driver is for a PT-6300). You will not see the entry in Partnertech OPOS if not setup in there.</li><li>Windows Devices and Printers.</li><li>Has its own Cash Draw driver’s part of image.</li><li>Devices name = PT6212CASHA if plugged into standard Cash Draw COM port</li></ul><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;</p><p>&nbsp;</p><h3>Note!</h3><p>The Aures Odysse 1 and Aures Odysse 2 have different bezel coloured designs (but look similar) which is the outer frame of the till screen.</p><p>&nbsp;</p><p><br>&nbsp;</p><h3>Aures Odysse 1</h3><p>Main display (LCD)</p><p>Customer Front Line Display (aka. Line Display)</p><ol class=\"decimal_type\"><li>The LCD type display is attached via VGA cable to a VGA port</li><li>The Dot Matrix or LED type display (Line Display) is attached via VGA cable to serial port COM4 (£150.00 each)</li></ol><p>MSR Card Reader (located to the right-hand-side) of the main display</p><p>Operating System: POS Ready 2009 (Embedded XP operating system)</p><p>&nbsp;</p><p>Note!</p><p>POS Ready 2009 is Windows XP Pro</p><p>Supported by Microsoft till 2018</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><h3>&nbsp;</h3><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<strong>Odysse I Customer Line Display Removal</strong></p><p>Remove the two screws encircled below to remove the cover plate. Underneath this there will be an additional four screws to remove (two on either side).</p><p>Unplug the RJ45 serial connector from the CLD and then remove the front line display unit.</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;</p><p>&nbsp;</p><p>Customer Display (ocd100 line display) Pricing:</p><p>Supplier Cost: £55.00</p><p>Merac Sales Cost: £85.00 + VAT + Carriage (price is the same for the Sango and Yuno)</p><p>Merac 2<sup>nd</sup> Hand Sales Cost: £35.00 + VAT + Carriage</p><p>Supplier Initial Inspection Charge: £22.00</p><p>If the device is repairable, Aures cost will be £55.00</p><p>Supplier P&amp;P: £12.50</p><p>Merac P&amp;P: £16.00</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><h3>Aures Odysse 2</h3><p>Operating System: Version 7 POS Ready which has Windows 7 operating system installed</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<strong>Odysse 2 Ports</strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;Aures Odysse Bundle (costs approx. £1000.00)</p><ol><li>Till unit</li><li>MSR Card Reader</li><li>Dot Matrix Line Display</li><li>Cash Drawer</li><li>Printer (port specific)</li></ol><p>To print a configuration page for the printer, turn off the printer and then press and hold down the <strong>&lt;PowerOn + Feed&gt;</strong> button at the same time.</p><h3>&nbsp;</h3><h3>Aures Odysse Sango</h3><p>New glossy coated, blue EPOS Till system</p><h3>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</h3><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p></p><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>Cover plate release button</strong></p></td></tr></tbody></table><p>&nbsp;&nbsp;</p><p></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p><strong>Aures Yuno</strong></p><p><strong>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</strong></p><p><strong>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</strong><strong>&nbsp;</strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p></p><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>Cable Sleeve under Till Screen cover plate</strong></p></td></tr></tbody></table><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>‘L’ Shape Cable Cover Plate. Press long elongated button at top of plate to release and remove cover plate</strong></p></td></tr></tbody></table><p>&nbsp;<strong>&nbsp;</strong></p><p></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><h3>Aures Nino</h3><p>Wide-screen version EPOS Till system</p><h3>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</h3><h3>J2</h3><p>Old block-shaped version EPOS Till system</p><p><strong>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</strong></p><p><strong>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</strong>&nbsp;</p><p><strong>&nbsp;</strong></p><p><strong>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</strong>&nbsp;</p><p><strong>&nbsp;</strong></p><p><strong>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</strong>&nbsp;</p><p>&nbsp;</p><h3>Partnertech</h3><p>Another till very rarely used is the Partnertech PT-6215-EB</p><p>&nbsp;</p><p><strong>External Aures Touch Screen - OLC15 ELO</strong></p><p>Drivers for the Touchscreen and Front Line Display can be found @ <a href=\"http://www.aures-support.fr/EN/screens/\">http://www.aures-support.fr/EN/screens/</a></p><p>The OLC’s are just monitors with a touch screen on the front so depending on what you have connected to them depends on what drivers you need to install. The touch screen and the VFD use USB for comms so the minimum you need to have connected is a power cable a VGA cable and a USB cable. They have only ever had 2 different touch screens fitted either ELO or POSTOUCH. The touch screen you returned is ELO so for the touch screen to work you need to install the ELO driver. When installing any of the touch screen drivers you need to make sure you select USB only.</p><p><u>Cables that exist hardwired to the external monitor</u>:</p><p>Power</p><p>VGA (for Display connected to PC)</p><p>1 x USB TouchScreen and CLD (standard settings = 9600 baud)</p><p>When the drivers are installed and cable is plugged in, a ‘prolific USB-Serial COM Port’ is installed which needs to match the Epson OPOS communication port number.</p><p>1 x USB (in the front used as a passthough data cable for connecting additional peripheral devices)</p><p>PS2 (FOR MSR Card Reader)</p><p>Serial (serial Card Reader - not used)</p><p>&nbsp;</p><h2>Front Line Displays</h2><p>The Front Line Display is connected to a visible serial COM port for the old J2 tills. For the later Aures tills, the Front Line Display is integrally connected to serial COM port 4.</p><p>&nbsp;</p><p><u>By default once the Front Line Display is is installed and configured</u>:-</p><p>When the POS Till program is not running the display panel should display the following text: <strong><em>&lt;CompanyName&gt; Unavailable</em></strong></p><p>When the POS Till program is running and the till operator is logged in, the display panel should display the following text: <strong><em>&lt;CompanyName&gt; Available</em></strong></p><p>When the POS Till is processing transactions and adding items to the basket, the display panel should display the following text:&nbsp;</p><p><strong><em>&lt;LineItemDescription&gt; &lt;Qty&gt; &lt;Price&gt;</em></strong></p><p><strong><em>SubTotal: &lt;SubTotalAmount&gt;</em></strong></p><p>&nbsp;</p><p><strong>Partnertech Tills - Customer Line Display (CLD) Setup</strong></p><p>Partnertech Tills with CLDs that are USB attached using a serial-to-USB adapter do not work with the Merac software. Speak to Dave about this as the customer would be recommended to re-order replacement CLDs that are compatible.</p><p>Partnertech Tills with CLDs that are serial attached do not work with their proprietary PartnerTechOPOS software (i.e. as you would configure Aures Sango CLDs) but can be configured as DM-D101 using attached devices in Epson OPOS and Back Office Till Configuration.</p><p>&nbsp;</p><p>Barcode Scanners</p><p>You get either MetroLogic/Honeywell or DataLogic barcode scanners (i.e. MetroLogic and DataLogic are two different suppliers of these devices)<strong>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</strong></p><p>Not Supported:-</p><p>Metrologic Honeywell/Voyager MS3780/MS9540/MS9590 (these attach serially only!)</p><p>PS50 Barcode Scanners – these are Aures supplied proprietary hardware barcode scanners that are USB attached and need to be pre-configured using the appropriate scansheet to enable the POS Till to recognise the barcode being scanned.</p><p>&nbsp;</p><p>MetroLogic Honeywell Orbit Scanners – Merac no longer order these devices.</p><p>MetroLogic Honeywell Genesis Scanners – trigger-based scanner which Merac currently supply.</p><p>DataLogic Gryphon Scanners – generally non-trigger configured which Merac currently supply. The Data Logic Gryphon 4430 is trigger-based.</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>The AC Power Inline Connector cable plugs into the scanner at the back and then there is a female [Cable end]-to-male [Till end] connection into the back of the Till’s serial COM port.</p><p>Barcode Scanner plugs into COM2</p><p>&nbsp;</p><p>Note!</p><p>If a barcode printer has been setup as a Windows attached printer, make sure you choose the<strong><em>&nbsp;’Type of Printer: Windows Laser/Generic</em></strong>’ and choose the size of the barcode label from the drop down and symbology used to render the barcode.</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p><strong>MetroLogic Barcode Scanner setup</strong></p><p>All MetroLogic barcode scanners are configured through MetrOPOS Administrator as seen below…</p><p>&nbsp;</p><p>If connected via serial COM port, launch MetrOPOS Administrator from the Start menu</p><p>&nbsp;</p><p></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>Click on <strong>New Profile</strong> tab and then configure the device settings and then click the <strong>Save</strong> button the save the changes.</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>Note!</p><p>The Model Number must match the same device that exists in the Devices table in SQL and ensure that the Barcode Scanner device Make/Model to match in Back Office.</p><p>To scan items from the POS Till program correctly, the scansheet would need to be scanned as well.</p><p>If connected via USB, provided the barcode scanner has been Merac pre-configured using the appropriate scansheet, the scanner should be able to scan barcodes correctly from the Till immediately.</p><p>You can click the Program button to re-program the Barcode Scanner.</p><p>&nbsp;</p><p>When you look at Epson OPOS, if you see the Scanner device greyed out but visible, this means the device is configured somewhere else (i.e. MetrOPOS Administrator)…</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>When the barcode scanner is plugged in, you should see the following device appear within Devices and Printers…</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>Ensure that Back Office Till Configuration is setup correctly to use the Barcode Scanner as seen below…<br>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>The Barcode Scanner can now be used for scanning barcodes!</p><p>&nbsp;</p><p>If the below error appears when trying to Program the barcode scanner from MetrOPOS Administrator, then the device is not configured to the correct serial COM port.</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>Try delete the profile and create it again and if still an issue could be a faulty cable or device.</p><p>&nbsp;</p><p><strong>Preparing Honeywell cordless handheld barcode scanner for Stock Take</strong></p><p>Attach Handheld scanner (either connect via Bluetooth or USB to PC)</p><p>Update Device Date/Time to match that of the PC it is attached to</p><p>Enter PIN for the handheld device (known by user)</p><p>Reset/Refresh Stock Code</p><p>Carry out Stock Take by scanning item bar codes</p><p>&nbsp;</p><h3>You get two types of scanners – 1D and 2D scanners.</h3><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;Aures 1D Integrated Scanner (aka. Laser Scan Module)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;</p><p>&nbsp;</p><p>EZConfig v4.5.9_Setup utility is a browser-based utility used to configure the integrated 1D barcode scanner. The settings have been backed up and saved to “C:\\Users\\jtristem\\Documents\\Merac\\Merac\\Software\\1D Aures Integrated Scanner\\ 1D Aures ConfigSettings”.&nbsp;</p><p>Simply use the utility to connect to the device and import the settings.</p><p>&nbsp;</p><p>Note!</p><p>There is a conflict between your device and EZConfig-Scanning. Perform one of the following steps to correct this issue:</p><p>1.Upgrade to a newer firmware.</p><p>2.Switch to another interface.</p><p>3.Turn on the REM interface by scanning the below barcode or send command REMIFC1.</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>Honeywell Eclipse MS5145<strong>&nbsp;</strong>(1D scanner)</p><p>Contains a single Infra-Red line used to scan barcodes aligned with the infra-red beam.</p><p>USB attached.</p><p>Capable of scanning Booking Orders via the Internet (later models can scan orders from a mobile phone).</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;</p><p>&nbsp;</p><p>Serial COM port, VGA cable attached.</p><p>Setup by installing Voyager OPOS software (MetrOPOS Administrator) and can be programmed the same way as you would do for a MetroLogic Orbit MS7120 (2D scanner).</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p><strong>MS9590</strong> (1D Scanner)&nbsp;</p><p>&nbsp;</p><p></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;PS2 attached connection. Can plug into a Wedge keyboard connection using PS2.</p><p>Does not support Serial-USB adapter connections.</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<strong>MetroLogic</strong> Orbit MS7120&nbsp;(2D scanner)</p><p>Contains multi Infra-Red lines in different directions enabling you to scan barcodes in different directions.</p><p>Serial COM port, VGA cable attached.</p><p>Configuration: MetrOPOS Administrator software (used to define hardware profile) – only need to be defined for serial COM port attached devices.</p><p>USB attached is Plug &amp; Play. No need to configure via MetrOPOS Administrator.</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>Other 2D scanners include the MetroLogic Voyager MS9540 – there is both the serial COM port version and the USB version. The serial COM version is configured using MetrOPOS Administrator and Back Office Till Configuration whereas the USB version is PnP and is only configured through the Back Office Till Configuration.</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p><strong>DataLogic Gryphon 4430</strong></p><p>Supports Serial-USB adapter connections.</p><p>&nbsp;</p><p>&nbsp;&nbsp; &nbsp;&nbsp;</p><p>&nbsp;</p><p>The DataLogic Gryphon barcode scanner which is connected via USB - only needs to be plugged in and configured in Back Office Till Configuration:</p><p>Barcode Reader: &lt;None&gt;</p><p>&nbsp;</p><p><strong>Honeywell Genesis 7580 Barcode Scanner</strong></p><p>USB attached.</p><p>&nbsp;</p><p>Note!</p><p>If the device fails to scan, get the customer to scan the reset barcode from the scan sheet and then rescan all barcodes from top to bottom. If this fails, download the ‘Reset to Factory Settings’ readme pdf document for the particular Make/Model and then scan the code that resets the custom settings and then scan the code that resets the device to factory defaults and the try rescanning all barcodes from top to bottom and this should fix the issue (Craig has the two reset barcodes).</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<strong>Honeywell 1202g Barcode Scanner</strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;Wireless 2D Barcode Scanner</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;</p><p>&nbsp;</p><p>1)Image Scanners: <strong>Genesis, DataLogic Gryphon</strong></p><p>Uses graphic recognition to read a barcode.<br>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>2)<strong>Voyager MS9590</strong> (1D)</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>3)<strong>MetroLogic Orbit</strong> (2D)&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p><u>Barcode Formats (Symbologies)</u>:</p><p>&nbsp;</p><p><strong>One Dimension Type Barcodes&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</strong></p><p><strong>UPC-A</strong></p><p>Consists of a 12 numeric digit barcode (encodes 12 numeric digits)</p><p><strong>UPC-E</strong></p><p>Consists of a 6 numeric digit barcode</p><p>(Industry: Retail)</p><p><strong>EAN8</strong></p><p>Consists of an 8 numeric digit barcode. Used to provide barcodes on products where there is very limited space available, like candles etc.</p><p><strong>EAN13</strong></p><p>Consists of a 13 numeric digit barcode.</p><p>(Industry: Retail)</p><p><strong>Code39</strong></p><p>This barcode font or symbology uses a combination of both digits and characters. Similar but not as compact as Code128.</p><p>Stick to 13 characters max length.&nbsp;</p><p><strong>Code128</strong></p><p>These are compact, high density barcodes. Code128 barcodes are powerful and can store vast amounts of information about the product being sold. Stick to 13 characters max length.</p><p>&nbsp;</p><p><strong>Two Dimension Type Barcodes</strong></p><p><strong>QR Code</strong></p><p>These are 2D matrix barcodes which also store vast amount of information.</p><p>&nbsp;</p><p><strong>Global Trade Item Number (GTIN) ID Formats</strong></p><p>GTIN-8: EAN8</p><p>GTIN-12: UPC-A</p><p>GTIN-13: EAN13</p><p>GTIN-14: (not generally used by our customers)</p><p>&nbsp;</p><p><strong>How to Calculate the Check Digit Value manually</strong></p><p>A check digit, also known as a&nbsp;checksum&nbsp;character, is the number located on the far right side of a bar code. The purpose of a check digit is to verify that the information on the barcode has been entered correctly. The barcode reader's decoder calculates the checksum by performing a series of mathematical operations on the digits that precede the check digit, and comparing the result of the calculation to the value of the check digit. Typically, if the check digit matches the result of the calculation, the reader emits a signal (such as a beep) to acknowledge that the results match, and the scan has been successful.</p><p><strong>&nbsp;</strong></p><p>&nbsp;</p><p>&nbsp;</p><p>Example of calculating an EAN13 barcode Check Digit:-</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><h2>Receipt Printers&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;</h2><h2>&nbsp;</h2><p>ODP200H G&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Only uses THERMAL RECEIPT PRINTER 3.1 driver<br>TRP100&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;-&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Only uses THERMAL RECEIPT PRINTER 4.1 driver</p><p>ODP333&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Uses THERMAL RECEIPT PRINTER 4.0, 4.1 and 4.3 drivers</p><p>&nbsp;</p><h2>Installing serial attached ODP200 Thermal Receipt Printer via USB</h2><p>Download Thermal Receipt Printer driver for ODP/100/200/333 printer attached via USB from Aures website</p><p><a href=\"http://www.aures-support.fr/UK/driver-download/posligne-printer-drivers/\">http://www.aures-support.fr/UK/driver-download/posligne-printer-drivers/</a></p><p>&nbsp;</p><p><strong>Installing serial attached ODP100/ODP200/ODP333 Thermal Receipt Printer via Epson OPOS</strong></p><p>ODP200/ODP333 serial attached printer setup via EPSON OPOS as TM-T88III (baud rate set to 19200) and Cash Draw plugged into 'DK' port on back of printer (Till Configuration Receipt Printer: TM-T88III and Cash Draw: Standard)</p><p>&nbsp;</p><p>Example:-</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><h2>Note!</h2><p>All receipt printers no matter what Make and Model use generally 80mmx80mm receipt rolls.</p><p>&nbsp;</p><p><strong>POSLIGNE TRP100 Receipt Printer</strong> - Setup in OPOS using TM-T88III to COM Port.</p><p>This needs to have the Baud rate set to either 6900 or 19200.</p><p>&nbsp;</p><p>(The Posligne TRP100 uses THERMAL RECEIPT PRINTER 4.30)</p><p>&nbsp;</p><p>Epson TM-Tx&nbsp;(e.g. Epson TM-TII, Epson TM-TIII, Epson TM-TIV, Epson TM-TV).</p><p>Serial COM port, VGA cable attached (connected to serial port COM1).</p><p><u>Setup</u>:-</p><p>In order to configure a receipt printer to a till system, you need to ensure that you setup the printer settings to match the <strong><em>Baud Rate</em></strong> of the printer else it will not print.</p><p>&nbsp;</p><p>Note!</p><p>You get both non-thermal and thermal receipt printers. Thermal receipt printers normally print on glossy paper that responds to heat.</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p><strong>Aures POSLigne TRP ODP200 (older model) Printer and Aures&nbsp;</strong><strong>POSLigne TRP ODP333 (later model) Printer&nbsp;</strong></p><p>Usually connected via USB as a Windows printer which faster than using a serial cable connection. Once the Thermal Receipt Printer driver is installed, rename the printer in Devices and Printers to WINRECEIPT.</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>RS-232</strong></p></td></tr></tbody></table><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>USB</strong></p></td></tr></tbody></table><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>DK</strong></p></td></tr></tbody></table><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>A/C Power</strong></p></td></tr></tbody></table><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>Network</strong></p></td></tr></tbody></table><p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p><strong>&nbsp;</strong></p><p><strong>&nbsp;</strong></p><p><strong>Configuring a POSLigne ODP333 Receipt Printer&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</strong></p><p>This is normally a USB attached Printer so it is likely if the receipt printer is not working that the printer could be either using an old WINRECEIPT USB port in which case the printer will not be able to pick up jobs allocated to the print queue.&nbsp;</p><p><strong>Solution</strong></p><p>Either try plugging the printer device into different ports to check which one works, open Printer Properties and from the Ports tab, change the USB port number to the correct port number or reinstall the print drivers from C:\\VENDOR THERMAL PRINTER 3.X\\ as USB printer or run the driver installation from the D:\\ drive if the folder is not present from the root of the C:\\ drive.</p><p>&nbsp;</p><p><strong>POSLigne ODP333 Aures Printer&nbsp;</strong></p><p>&nbsp;</p><p>Do not set as Default and no need to Reboot following driver install!&nbsp;Rename the old WINRECEIPT printer and change the name of the new printer to WINRECEIPT.</p><p>Done!</p><p>&nbsp;</p><p><strong>Posligne ODP200H-G</strong></p><p>The above specific Model uses the below drivers only through Windows (i.e. USB or serial attached) - VENDOR THERMAL PRINTER 3.X.</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;</p><p>&nbsp;</p><p><strong>Epson TM-88III and Epson TM-88IV and Epson TM-T88V and Cash Draw</strong></p><p>The Cash Drawer is normally plugged into the receipt printer using an RJ11 connector into the port labelled ‘DK’ which stands for ‘Draw Kicker’.</p><p>&nbsp;</p><p></p><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>Male Fly-Lead</strong></p></td></tr></tbody></table><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>RJ45 Connector plugs into the COM port at the back of the Till</strong></p></td></tr></tbody></table><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>Male RS-232 serial cable connector plugs into the back of the printer</strong></p></td></tr></tbody></table><p>&nbsp;&nbsp;</p><p></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>Configure the Epson Receipt Printer via Epson OPOS. Then configure the Cash Draw being sure to specify the same COM port as the receipt printer given that the Cash Draw is plugged into the Receipt Printer – the Cash Draw needs to be added as a Standard Cash Draw device and communication settings COM Port and Baud Rate need to match that of the Receipt Printer. The Receipt Printer will now function as the ‘master device’ and since the printer is configured to communicate via a serial COM port, the Cash Draw will only open as and when needed.&nbsp;</p><p>If the printer was setup as a USB attached printer via Windows or Epson OPOS, the Cash Draw will open every time paper passes through the Receipt Printer if plugged into the printer ‘DK’ port.</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<strong>Configuring Epson TM-T88IV USB Attached Receipt Printer via OPOS</strong><strong>&nbsp;</strong></p><p>Right-click on POSPrinter and then add new device for the printer by selecting the Model Name suffixed with the letter ‘U’ and then click <strong>Make Port</strong> button to create a new USB attached port to connect to the printer and then run a ‘Health Check’ to see if the printer is detected. Give the device listed in Epson ADK OPOS software a Logical Device Name (LDN) to match that of what is specified in the Devices table within the Merac Database.</p><p><strong>&nbsp;</strong></p><p><strong>Configuring Epson TM-T88IV USB Attached Receipt Printer through Windows</strong></p><p>Connect the printer to the PC USB port and then power on the printer.</p><p>Run the Windows device driver setup located at <strong>C:\\Users\\jtristem\\Documents\\Merac\\Software\\Epson Advanced Windows Print Drivers\\</strong>. During the setup specify to create a USB port.</p><p>The Printer should appear as follows in Printer Properties…</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p><strong>&nbsp;</strong></p><p>Rename the printer to <strong>WINRECEIPT</strong> and then ensure Till Configuration is setup correctly and then <strong>Recreate Till Data</strong> and <strong>Update</strong> the till and test.</p><p><strong>&nbsp;</strong></p><p><strong>Epson ODP200</strong></p><p>USB attached receipt printer.</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;No longer supplied. Now need to order the POSLigne ODP333 instead.</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<strong><u>EPSON OPOS</u></strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p></p><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>EPSON OPOS V2.00 SOFTWARE</strong></p></td></tr></tbody></table><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>USB attached</strong></p></td></tr></tbody></table><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>Serial RS-232 attached</strong></p></td></tr></tbody></table><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>EPSON Printer</strong></p></td></tr></tbody></table><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>Cash Draw</strong></p><p><strong>Sharing same COM Port as Receipt Printer which is set as the ‘Master Device’</strong></p></td></tr></tbody></table><p>&nbsp;<strong><u>&nbsp;</u></strong></p><p></p><p><strong><u>&nbsp;</u></strong></p><p><strong><u>&nbsp;</u></strong></p><p></p><p></p><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>(Supported)</strong></p></td></tr></tbody></table><p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>In the above configuration, the Cash Draw will only open as and when needed!</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p></p><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>EPSON OPOS V2.00 SOFTWARE</strong></p></td></tr></tbody></table><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>USB attached</strong></p></td></tr></tbody></table><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>Serial RS-232 attached</strong></p></td></tr></tbody></table><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>NON-EPSON Printer</strong></p></td></tr></tbody></table><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>Cash Draw</strong></p><p><strong>Sharing same COM Port as Receipt Printer which is set as the ‘Master Device’ with matching Baud Rate</strong></p></td></tr></tbody></table><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>(Not Supported)</strong></p></td></tr></tbody></table><p></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p></p><p></p><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>(Supported)</strong></p></td></tr></tbody></table><p>&nbsp;&nbsp;</p><p></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;Note!</p><p>Non-Epson we mean by Aures Posligne and <u>ODP200 or ODP1000 (receipt printer released roughly around the same time)</u> and ODP333. Use Epson TM-T88III drivers. Merac do not provide support for connecting any other printer other than what Aures of Epson.</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;In the above configuration, the Cash Draw will only open as and when needed!</p><p>Also if the Cash Draw is plugged into the dedicated Cash Draw port at the back of the till, the Cash Draw will only open as and when needed.</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>If a Receipt Printer is setup as a USB attached Printer, the Cash Draw will open each and every time paper passes through the receipt printer regardless whether setup as a Windows Printer (WINRECEIPT) or OPOS USB attached Printer.&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;J2 Tills are setup in a similar fashion as above when the Cash Draw is connected to the Epson Receipt Printer.</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<strong>Windows Printing – USB Attached vs. COM Attached</strong></p><p>If you install and configure Windows print drivers to print via serial COM port (using WINRECEIPT), the Receipt or whatever you are printing will print very slowly. Better to print via USB which has a much faster bit-rate that the baud-rate of serial ports.</p><p>&nbsp;</p><p><strong>Receipt Printer Basic Troubleshooting</strong></p><p><strong>&nbsp;</strong></p><p><strong>Aures Posligne ODP200&nbsp;</strong></p><p>Receipt printer receipt roll is inserted as below because the thermal head is on the underside of the paper which means the printout of the receipt will also be on the underside of the receipt paper.</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>If the receipt printer is printing partial text, ensure the printhead is cleaned using a slightly damp kitchen roll or blue roll. Ensure you wipe the entire length of the printhead encircled below:</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p><strong>Aures Posligne ODP333</strong></p><p>Receipt printer receipt roll is inserted so it is fed over-the-top (i.e. opposite roll pacement orientation to the above). Because the thermal head is on the topside of the paper, this means that the printout of the receipt will also be on the topside of the receipt paper.</p><p>&nbsp;</p><p>Note!</p><p>These are thermal printers so need to verify that the paper inserted is thermal paper on non-thermal. To test, scratch the surface of the paper and if a black mark appear in the area scratched, it is the thermal side.</p><p>&nbsp;</p><p><strong>Printhead Issues</strong></p><p>If the receipt prints a partial printout of the receipt data onto the receipt, either the thermal printhead is dirty (i.e. can be cleaned by wetting the tip of your finger or blueroll slightly and wiping the entire length of the printhead) or the thermal printhead is damaged and needs to be repaired.</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><h3>Epson TM-U220</h3><p>Networked receipt printer.</p><p>Used in Catering outlets (e.g. kitchen areas) and are therefore non-thermal printers.</p><p>A Ribbon printer.</p><p>&nbsp;</p><p></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp;</p><p></p><p>&nbsp;</p><p>&nbsp;</p><h2>&nbsp;</h2><h2>&nbsp;</h2><h2>&nbsp;</h2><h2>&nbsp;</h2><h2>&nbsp;</h2><h2>&nbsp;</h2><h2>&nbsp;</h2><h2>&nbsp;</h2><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p><strong>&nbsp;</strong></p><p>Below shows you how a network attached printer can be connected directly to a Till using a CAT5E-COM Converter.&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p><strong>TMNet WinConfig</strong></p><p>The below Epson printer network discovery utility can be used to determine the IP and MAC address of the device connected to the network.&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p><strong>Installing Bluetooth printer with Tablet</strong></p><p>1)Pair the Bluetooth printer with the Tablet and the print device will be assigned a virtual COM port automatically (this is done because Tablets do not have COM ports but USB ports). You will see this picked up in Device Manager – Ports (COM and LPT).</p><p>2)Now add printer in Devices and Printers ensuring you select the appropriate virtual COM port and rename the printer to WINRECEIPT.</p><p>&nbsp;</p><p><strong>Bluetooth Receipt Printer – Epson TM-P80</strong></p><p><strong>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;Installation Instructions:</strong></p><p>Install Epson TM-P80 Bluetooth Printer driver</p><p>Stop \"Bluetooth Handsfree Service\"</p><p>Once the drivers are installed, disable onboard bluetooth service and the customer would need to use a bluetooth USB dongle as opposed to onboard (Harry says onboard is very unrelaibale hence why this option is being used on mobile tablets (e.g. Lynx1010) and WINPads).</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>Install the Bluetooth Dongle (Device Manager:ASUS USB-BT400)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;(In Device Manager\\Bluetooth, the device ASUS USB-BT400 should now appear)</p><p>Open Windows System Settings and go to Bluetooth and Search and Pair to the bluetooth printer device</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;Once paired, you should see a message “Driver is unavailable”</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>(In Device Manager\\Bluetooth, the device TMP80xxx should now appear)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;</p><p>&nbsp;</p><p>Navigate to \"C:Program Files\\EPSON\\Epson Advanced Print Driver 5\\\" and run PrinterReg.exe.</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;Enter all the details for the bluetooth printer and then save the settings.&nbsp;</p><p>You can verify what COM port has been assigned by opening Device Manager and clicking Hardware tab for the Epson TM-P80xxxx properties window.</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;The printer will be added to Devices and Printers</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;Done!</p><p>&nbsp;</p><p><strong>Installing a O’Niel OC2 Bluetooth Printer</strong></p><p>1)First install BlueSoleil software utility</p><p>2)Install device driver:</p><p><u>Versions</u></p><p>7.4.3 Easy Print Driver - C:\\Users\\jtristem\\Documents\\Merac\\Merac\\Software\\Blutooth Printers\\ONiel OC2 Bluetooth Printer\\ONeil OC2 Printer Driver files ver7.4.3.zip</p><p>OR</p><p>C:\\Users\\jtristem\\Documents\\Merac\\Merac\\Software\\Blutooth Printers\\ONiel OC2 Bluetooth Printer\\ONeil OC2 Printer Driver software - Datamax WORKING VERSION.zip</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>3)Once the print driver is installed, open BlueSoleil and search for, install services and pair to the device. Verify that “<strong><em>AutoConnect</em></strong>” is set in BlueSoleil.</p><p>4)Verify the COM port number used for pairing and then change the value in Windows Devices and Printers. If the COM port is not available, you may need to reboot Windows.</p><p>Done!</p><p>&nbsp;</p><p>&nbsp;</p><h2>Membership Card Printer&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</h2><p>&nbsp;</p><p><strong>Zebra P330i</strong></p><p>Old model membership card printer</p><p>USB attached</p><p><strong>&nbsp;</strong></p><p><strong>Zebra ZXP Series 7</strong></p><p>USB attached</p><p>&nbsp;</p><p>&nbsp;</p><p>The Zebra ZXP Series 3 Card Printer connected via USB is installed by plugging in and downloading and installing drivers.</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;The printer needs to be turned off to install the drivers.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;Driver version:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>Note!</p><p>Old legacy devices e.g. Zebra p110i is not supported by Merac.</p><p>&nbsp;</p><h3>Partnertech Receipt printer (Epson BA-T500II)</h3><p>Built-in till receipt printer.</p><p>Partnertech has a built in Receipt Printer.</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>The PartnerTech drivers including OPOS can be downloaded from: <a href=\"http://www.partnertechcorp.com/service%20support/downloads.html\">http://www.partnertechcorp.com/service%20support/downloads.html</a></p><p>This can only be used if you are attached PartnerTech proprietary peripherals (e.g. Receipt Printer, Cash Draw etc.) into the PartnerTech Till.</p><p>&nbsp;</p><p>Ticket Printers&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp;</p><h3>Citizen ticket printer</h3><p>USB attached printer.</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p><strong>Citizen CLP-521 Ticket Printer</strong></p><p>By default the printer hardware is configured to read &lt;blank&gt; spaces to determine when a ticket has been completely fed through the paper feed. To enabled ‘black marker’ sensing, the device needs to be programmed to do so through a series of button presses.&nbsp;</p><p>&nbsp;</p><p>***</p><p><strong>Selecting the sensor type: “See Through” or “Reflective” (aka. Black Marker)</strong></p><p>The printer’s default setting is “See Through” (aka. Label Gap) which is designed for standard tickets/labels.</p><p>&nbsp;</p><p>♦&nbsp;See Through is also known as “Label Gap” or “Transparent”</p><p>♦&nbsp;Reflective is also known as “Black mark”, “Black Reg Mark” or “Black Line”.</p><p>&nbsp;</p><p>Depending on sensor type:</p><p>If the printer is now in Transparent mode the buzzer sounds once. If the printer is now in Reflective mode the buzzer sounds twice and the <strong>Print</strong> LED flashes.</p><p>&nbsp;</p><p>1)Power off the printer</p><p>2)Hold down the <strong>PAUSE</strong>, <strong>FEED</strong> and <strong>STOP</strong> buttons.</p><p>3)Release the buttons when the <strong>CONDITION</strong> LED lights up.</p><p>4)Hold down the <strong>MODE/REPEAT</strong> button and press the <strong>STOP</strong> button</p><p>5)Press the feed button and see if the printer feeds and cuts correctly.</p><p>&nbsp;</p><p>If not, repeat Steps 1) – 5) and let me know the outcome.</p><p>***</p><p>&nbsp;</p><p>Also <strong><em>Print Preference</em></strong> alignment settings need to be configured e.g. (ticket dimensions, cut or tear etc.).</p><p>Drivers also very seldom fail.</p><p><strong>Ticket Printer feeding through more than one ticket and not printing</strong></p><p>Check alignment of the Opto-Reader (move to far left corner) and ensure that the Tickets are inserted into the printer correctly.&nbsp;</p><p>If still feeding through incorrectly could be that the Opto-Reader is damaged or dirty or not aligned at the Stop Marker.</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;Note!</p><p>Known working version driver is 7.7.2 – download the latest version from the Citizen website.</p><p>Driver version 7.1.9.5 also works as this has been installed at Heights of Abraham.</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<strong>Zebra GX430T and Zebra GK420D</strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;Note!</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;Zebra printers are thermal printers so thermal labels are required else nothing will print out on the label.</p><p>&nbsp;</p><p>Model Driver versions:</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>Once the printer settings have been defined, calibrate the printer by selecting <strong>Tools</strong>&gt;&gt;<strong>Action</strong>&gt;&gt;<strong>Calibrate media</strong>&gt;&gt;click the <strong>Send</strong> button</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;Note!</p><p>The GK420D prints both Tickets and Barcode Labels.</p><p>&nbsp;</p><p>Also the following barcode label settings need to be defined…</p><p>&nbsp;</p><p>(e.g. for 25 x 38mm barcode labels)</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<strong>WristBand Printer</strong></p><p>The device is called a TSC Printer. Only used by Adventure Island and SandCastle Water Park but EH also have the facility but don’t use them.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><h3>Zebra ticket printer</h3><p>Parallel port or USB attached (more popular) printer.</p><p>Networked ticket printer.</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p><strong>Zebra GK-420D</strong></p><p>Normally USB attached. Back Office device name is ‘Zebra’. Install as ‘Manual Mode’ type installation.</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;Requires Merac update for this to work!</p><p>&nbsp;</p><h3>Star Micronics TSP400 ticket printer</h3><p>Attached by serial COM port.</p><p>&nbsp;</p><p>Driver install for TSP400 for WinXP/2000</p><p><a href=\"http://www.starmicronics.com/support/default.aspx?printerCode=TSP400\">http://www.starmicronics.com/support/default.aspx?printerCode=TSP400</a></p><p>&nbsp;</p><p>Download and Install the drivers - either Line Mode (recommended) or alternative OPOS driver</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>Settings Jumper Switches for configuring baud rate:</p><p>&nbsp;</p><p>&nbsp;</p><p></p><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>10 Pin Dip Switch of which the first 8 starting from the left most switch is the 8-bit dip switch for which we are concerned.&nbsp;</strong></p><p><strong>(left-most is the LSB)</strong></p></td></tr></tbody></table><p>&nbsp;&nbsp;</p><p></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>Ticket Alignment:</p><p>&nbsp;</p><p>&nbsp;</p><p></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;As you can see above, the ticket cutter marker strip is just past the centre, right-hand-side.</p><p>Below, you can see the Opto-Reader on the ticket printer is positioned just past centre, right-hand-side. This would give you an indication of exactly how to align the tickets in the ticket printer.</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><h3>Boca ticket printer</h3><p>&nbsp;</p><p>Windows Driver download: <a href=\"http://www.tls-bocasystems.com/zip/printer_drivers.zip\">http://www.tls-bocasystems.com/zip/printer_drivers.zip</a></p><p>Instructions: <a href=\"http://www.tls-bocasystems.com/pdf/windows-driver-install-guide.pdf\">http://www.tls-bocasystems.com/pdf/windows-driver-install-guide.pdf</a></p><p>&nbsp;</p><p>Has a built-in ticket cutter with Opto-Reader mechanism. The Opto-Reader mechanism is used to read the black line on the underside of the ticket to determine when to stop feeding.</p><p>A Thermal printer – thermal side of print roll needs to be facing upwards so the till roll needs to feed through the paper over and through the paper feeder not under and through the paper feeder.</p><p>&nbsp;</p><p></p><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>Thermal Side of Till Roll</strong></p></td></tr></tbody></table><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>Towards Paper Feed Mechanism</strong></p></td></tr></tbody></table><p>&nbsp;&nbsp;</p><p></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>Can get double-printers in one unit.</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><h3>&nbsp;</h3><p><strong>Backing Up a Windows USB Attached Ticket Printer and Configuring General and Advanced Setting</strong></p><p>Open printer properties and import driver settings if there are any (e.g. these driver settings may include customer printer configuration Form containing Ticket dimension settings, Stop Marker position etc.).</p><p>From a Till with a known working ticket printer, select <strong>Printer Properties</strong>&gt;&gt;<strong>Tools</strong>&gt;&gt;click on <strong>Driver Options</strong> button and click <strong>Export</strong> button…</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>OR</p><p>&nbsp;</p><p><strong>Printer Properties</strong>&gt;&gt;<strong>Advanced</strong> tab&gt;&gt;<strong>Printing Defaults</strong> button&gt;&gt;<strong>Import/Export settings</strong> tab…</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>Note!</p><p>The import does not import Advanced settings so you will have to check General/Preferences and copy these to Advanced/Printing Defaults.</p><p>If the printer was initially setup as a windows USB attached printer and you rename the printer and reinstall the print driver - if no additional printer appears in Devices and Printers then it means that the printer has been plugged into the original port in which case all you have to do is rename the original renamed printer back to what it was and the printer should work.</p><p>If the USB data cable remains in the same USB port and you swap out the device with the same model, Windows may create a new printer in Devices and Printers.</p><p>&nbsp;</p><h2>Barcode Printers&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</h2><p>&nbsp;</p><h3>Epson TM-L90</h3><p>This barcode printer prints a Description, Barcode and Price.</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;Note!</p><p>The orientation of the printer must look as seen above else the printer will not be detected by the device from which it is plugged into.</p><p>&nbsp;</p><p><strong>USB attached Epson TM-L90 Barcode Printer Installation and Configuration</strong></p><p>Install Options:-</p><ol><li><strong>Epson OPOS ADK setup (USE THIS METHOD FOR OLD HARDWARE!!)</strong></li></ol><p>Download and install the Epson OPOS software if not already installed –</p><p>“C:\\Users\\jtristem\\Documents\\Merac\\Software\\EpsonOPOS\\EPSON OPOS ADK ver2.50E OPOS - L90 Serial OPOS Older Driver”&nbsp;(Epson ADK ver250E)&nbsp;</p><p>OR</p><p>“C:\\Users\\jtristem\\Documents\\Merac\\Software\\EpsonOPOS\\EPSON OPOS ADK ver2.68E OPOS 1.11 - L90 USB OPOS Latest” (Epson ADK ver268E)</p><p>&nbsp;</p><p>Right-click POSPrinter and then add new device for the printer by selecting the Model Name suffixed with the letter ‘U’ if the older version OPOS (Epson ADK ver250E) OR letter ‘M’ if the later version OPOS (Epson ADK ver268E) is installed and then click <strong>Make Port</strong> button to create a new USB attached port to connect to the printer. You can check what is available through Back Office Till Configuration. Now run a ‘Health Check’ to see if the printer is detected.&nbsp;</p><p>&nbsp;</p><p>Note!</p><p>If the device is not detected despite being powered on and plugged in correctly, check ‘Devices and Printers’ and if there is an ‘Unspecified’ exclamation marked unidentified device listed, it is likely the interface drivers are not installed. Download and install them before trying again by reinstalling Epson OPOS software. BaudRate needs to be set to either 9600 or 19200 for USB devices.</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>Lastly, install all the BarCode Fonts.&nbsp;</p><p>&nbsp;</p><p>If after installing and configuring the TM-L90 Barcode Label printer, the device is still not able to print barcode labels, then the printer could either not be positioned correctly (i.e. upright) or the barcode label roll is not inserted correctly or there is a hardware fault (i.e. faulty cable or printer device).</p><p>&nbsp;</p><p>Because this is setup through Epson OPOS, it is not a Windows printer so you will not see the device in the ‘Printer and Faxes’ window.</p><p>No need to define any settings for it in Till Configuration as there is no BarCode Printer option to define.</p><p>&nbsp;</p><ol><li><strong>Windows setup</strong></li></ol><p>Once the device has been plugged into the USB port of the computer and powered on, the following device should appear in ‘Devices and Printers’. No need to configure it through Back Office because there is no Till Configuration defined settings for barcode printers.</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>Note!</p><p>If plugged in via serial, always use Epson ADK ver250E and the Device Name to be set to TM-L90 with no LDN required. This is required whether you use a serial-to-USB adapter or connected direct using serial lead, you need to install Epson OPOS and setup the device as a OPOS printer via COM port. BaudRate for serial needs to be set to either 9600 or 19200.</p><p><strong>&nbsp;</strong></p><p>Download and install the Epson Advanced Printer Driver – located at <a>\\\\svrcompany\\ftproot\\JTristem\\Merac\\Software\\Epson TM-L90 Windows Drivers\\APD_452E.exe</a>&nbsp;</p><p>The TM-L90 Printer should now appear as a printer in ‘Devices and Printers’.</p><p>(the TM-L90 barcode printer is plugged into the Till using a USB cable and has a separate AC Power cable plugged into a standard power socket)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>Lastly, change the <strong>General</strong> and <strong>Advanced</strong> ‘Layout’ tabbed page settings in Print Properties to match the dimensions of the barcode labels being used…</p><p>&nbsp;</p><p>Creating the Barcode Label Dimensions</p><p><strong>Add/Edit</strong>&gt;&gt;<strong>Advanced Settings</strong>&gt;&gt;Add Paper Size button and give the custom paper size settings a suitable name and adjust the settings to match the dimensions of the barcode labels…</p><p>&nbsp;</p><p>(<u>ver452E</u> (recommended) or ver415E)</p><p>&nbsp;</p><p>39 X 25mm Barcode Labels:-</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>63 x 25mm Barcode Labels:-</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p><strong>Installing an Epson TM-L90 Barcode Label Printer via Serial</strong></p><p>A TM-L90 printer is setup through Epson OPOS and label sizes are hard coded in our Merac software.</p><p>&nbsp;</p><p>Note!</p><p>If the TM-L90 barcode printer is old, it only works connected serially and configuring through Epson OPOS. New version TM-L90 devices need to be plugged in by USB and installed as a Windows printer.</p><p>&nbsp;</p><p>Now set both <strong><em>General/Main</em></strong> and <strong><em>Advanced</em></strong> settings Layout to match the name of the Settings profile defined earlier.</p><p>Open any Stock item from Back Office and make the following changes…</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>Change the ‘left offset’ to ‘1’ and double-click on the barcode and change the font size to ‘30’…</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>Change ‘Paper size name’ drop box to the name of the label settings profile setup earlier and then click the Set to printer button.</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>Install BarCode Fonts.</p><p>Open Back Office Stock Index and test that barcode printing works.</p><p>Done!</p><p>&nbsp;</p><p>Note!</p><p>If the label prints the barcode correctly but truncates the price from the right-hand-side, an upgrade is is required on the Merac server to fix the issue.</p><p></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<strong>Zebra Barcode Label Printer Back Office Settings (60mm x 10mm)</strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>Cash Drawers&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp;</p><h2>Makes: Flytech or Cashbase (larger size form factor Cash Draw)</h2><p>Aures supply two types of Cash Draws:-</p><p><strong>Compatible</strong> (this has a glossy front face and has Aures written on it)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;This is a small form factor Cash Draw</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;Standard</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;This is the standard form factor size Cash Draw</p><p>&nbsp;</p><p>Note!&nbsp; &nbsp; &nbsp;&nbsp;</p><p>Only Receipt Printers and MSR Card Readers can be built into certain Make/Model POS Tills, <u>NOT</u> Cash Draws.</p><p>&nbsp;</p><p>Aures Odysse SANGOs have Flytech motherboards and use Flytech OPOS (software to be installed - OPOS Cash &nbsp; Draw v1.1.3 -</p><p>and is located on D:\\Flytech OPOS\\Cash Drawer_OPOS_V1.0.13 which is by default located in a separate partition on the hard drive setup by Aures) to configure the Cash Draw provided the Cash Draw is plugged into the dedicated COM port at the back of the Till else if the Cash Draw is plugged into a receipt printer and not using Windows driver printing, configure the Cash Draw from the OPOS program used to configure the printer – the Cash Draw must be configured as a <strong><em>Standard</em></strong> Cash Draw and it will inherit COM Settings of the printer.</p><p>&nbsp;</p><p>Location of Flytech registry key:</p><p>HKEY_LOCAL_MACHINE\\SOFTWARE\\OLEforRetail</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>Aures Odysse YUNOs have different motherboards and the Cash Draw drivers need to be installed separately.</p><p>&nbsp;</p><p>If a printer has been configured as a Windows printer, you can share the printer from one till to another over the network just like you can with any other Windows network attached printer.</p><p>OPOS configured printers cannot be shared.&nbsp;</p><p>&nbsp;</p><p>Uses an RJ11 connection to attach to a till.</p><p>(no image)</p><p>&nbsp;</p><h2>Physical Cash Drawer – Models and Configuration&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</h2><p>J2 Cash Drawers plug into dedicated RJ11 COM port (card</p><p>&nbsp;</p><p>less reliable and resilient). Most Cash Draws can plug into the back of a Receipt Printer in an RJ11 port.</p><p>EPSON Cash Drawers plug into a standard serial printer COM port have a Baud Rate = &nbsp;19200.</p><p>&nbsp;</p><p>XRead allows you to print a receipt and open the Cash Drawer.</p><h3>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</h3><h3>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;Flytech Cash Drawer Test Procedure</h3><h3>&nbsp;</h3><h3>OPOS Cash Draw (Flytech) Configuration</h3><p>Simply plug the Flytech Cash Draw into the Cash Draw serial port (labelled on the Till) and then run OPOS Cash Draw and then change the following:-</p><p>1)Change drop-down to ‘INTERACTIVE’</p><p>2)Click <u>Open Service</u> button</p><p>3)Click <u>Enable CD</u> button</p><p>4)Click <u>Check Health</u> button&nbsp;</p><p>A status message window will appear whereby you press the <u>Open Draw</u> button.</p><p></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><h2>&nbsp;</h2><p>&nbsp;</p><p><strong>Configuring opening a CashDraw plugged into an Epson TM-T88V Receipt Printer installed via Windows</strong></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><h2>Card Machines&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</h2><p>&nbsp;</p><p>If a Card Machine is plugged into a USB port using a <strong><em>Serial-to-USB Converter</em></strong>, then Windows will setup the device connected to a ‘Virtual COM Port’. This requires the generic USB-serial drivers to be installed first. Open Device Manager and check which Virtual COM Port has been detected by Windows.</p><p>&nbsp;</p><p><strong>Contactless Ingenico Card Machines (IPP350 Ingenico Pinpad)</strong></p><p>These devices work only with WorldPay software (EasyVTerminal ver3.4.2.2 or higher)</p><p>&nbsp;</p><p><u>Configuring the Device Speed</u>:</p><p>Default Message – Ready</p><p><strong>Menu</strong> button</p><p>Press 1-RA1</p><p>Option 1 – COMMs Method</p><p>Password: 1985</p><p>Comm Speed</p><p>115200bps (make sure this baud rate is set)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>If the Device is connected via Serial Port, this is what the Home screen should display:-</p><p>&nbsp;</p><p><strong>RAM0922 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RS232</strong></p><p><strong>S/N: 000000XXXXX</strong></p><p><strong>Ready</strong></p><p>&nbsp;</p><p><u>If 'VCOM/USB' is displayed as opposed to 'RS232', follow the below instructions</u>:&nbsp;</p><p>On the keypad press the MENU button.</p><p>Press 1-RA1.</p><p>Enter password = 1985</p><p>Press 0 to select Comms Method, will get the below options-</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;0. &nbsp; &nbsp; RS-232</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;1. &nbsp; &nbsp; VCOM/USB</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;2. &nbsp; &nbsp; TCP/IP</p><p>Then select the RS-232 to set it to Serial connection.</p><p>Press cancel to go to Home screen of PED.</p><p>&nbsp;</p><p><strong>Installing Ingenico IPP350 USB drivers (JUNGO v3.4)</strong></p><p>During the installation of the device drivers, make sure that <strong>Force COM Port detection</strong> = &lt;<em>untick</em>&gt; and Uninstall Microsoft files = &lt;<em>untick</em>&gt;.</p><p>Once the drivers are installed, Device Manager will appear with a “Sagem Telium COM Port” or “Sagem Telium COM Port (COMx)” entry. Windows may need to be restarted if the device does not appear in Device Manager. Make sure the serial COM port number set here matches that within the Worldpay software.</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><h3>Vendor: Verifone (VX810s/VX820s)</h3><p>These devices work with both YesPay and Verifone Ocius Sentinel software. Each Card Terminal has an associated S/N and PTID (Payment Terminal ID) which is unique to the device but this is only for card machines that use Verifone Ocius Sentinel software as the provider – i.e. the software is paired with the device, else if using YesPay, you can plug any card machines into any terminal with the YesPay EasyVTerminal software installed ad-hoc.</p><p>&nbsp;</p><p>Dione Secura&nbsp;(older model)</p><p>Disadvantage:</p><p>If the device is dropped, it enters into “<strong><em>Tamper Detect Mode</em></strong>” and the device will need to be returned back to the supplier.</p><p>*Serial COM port, VGA attached (if the customer wants a USB attached device, the firmware would have to be updated on the device).</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><h3>VX810</h3><p>*Serial COM port, VGA attached (if the customer wants a USB attached device, the firmware would have to updated on the device).</p><h3>VX820</h3><p>*Serial COM port, VGA attached (if the customer wants a USB attached device, the firmware would have to updated on the device).</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;Note!</p><p>The obvious distinction between the VX810 and VX820 is that the 810 has four function keys (F1 – F4) on the top&nbsp;</p><p>right-hand-side of the screen whereas the 820 does not.</p><p>&nbsp;</p><p><strong>Inline AC Power Connection</strong></p><p>(this power supply is for the Verifone VX820)</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p></p><p><br>&nbsp;</p><h2>Handheld PDAs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp;</h2><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>Note!</p><p>The Metrologic Optimus is a very old StockTake PDA HandHeld Scanner (+/- 10 years old) that Dave would setup as it has a DOS-based interface and updating Stock Codes (aka. refreshing stock codes) is all done through Back Office ‘Stock Receipts/Stock Take’ window.</p><p>&nbsp;</p><p><strong>DataLogic Lynx</strong></p><p>Used for Table Ordering, Stock Control, Ticket Scanning (Members and Bookings).</p><p>If the Lynx scanner fails to scan barcodes, you may want to check that ‘Wedge’ is enabled. The device will only scan barcodes in wedge mode.</p><p>&nbsp;</p><h3>Casio (DTX820) and Honeywell Dolphin handheld scanner</h3><p>The Honeywell is touch-screen capable.</p><p>These barcode hand scanners are used for Access Control, Bookings, Memberships and Stock Control.</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p><strong>Honeywell 6000 Handheld Scanner – Connecting to WiFi</strong></p><p>Below are instructions which may be slightly different to what you may expect to see on your handheld scanner screen depending on what mode OS is installed.</p><p>&nbsp;</p><p>Connecting to WiFi – (aka. Obtaining a Secure Wireless Connection (SWC) on the Dolphin 6000 PDA device)</p><p>&nbsp;</p><p><u>Steps</u>:-</p><p>Firstly, the default home screen for the device is set to Windows Default (Titanium) Home Screen and ideally we need it changed to Classic Today Screen layout. To do this, follow the below:</p><ul><li>Tap Start button (Windows chequered flag icon)&gt;&gt;Getting Started&gt;&gt;Set Background.</li><li>Tap the arrow next to “Change the background image” in Settings\\Home.</li><li>Tap Items on the horizontal scroll bar at the top of the screen.</li><li>Un-check Windows Default box and switch to the Classic screen layout.</li><li>Select the items (e.g. Calendar, Time, Email etc.) you want to appear on the Classic Today screen.</li><li>Tap OK and OK again.</li></ul><p>&nbsp;</p><p>Done!</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>Enable WLAN Radio Driver to connect to WiFi Access Point:</p><ul><li>The radio driver must be enabled for the radio to transmit a signal. You cannot connect to a network unless the radio is enabled.</li></ul><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>Note!</p><p>The parameters you enter in the WLAN SWC depend entirely upon the wireless network established in your facility dictated and configured by your IT Department or whoever configured your wireless network access Router.</p><p>&nbsp;</p><ul><li>Open WLAN SWC.</li><li>Tap the <strong>Config</strong> tab and then tap <strong>New</strong>.</li></ul><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>Note!</p><p>You can create multiple connection profiles that use the same SSID by giving each profile a unique name in the “Profile Name” field on the Network window.</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;</p><p>&nbsp;</p><ul><li>Type the SSID (which is the name of the Access Point configured on the wireless network access Router).</li><li>Select a specific band if the connection is to be limited to b/g/n or a/n or leave band as Auto.</li><li>Select the Assoc.Mode that corresponds to your network configuration from the drop-down list. This pertains to the authentication or encryption standards defined by whoever configured or setup the Router wireless network AccessPoint.</li><li>Enter all other required information.</li><li>Once done, tap OK.</li><li>You are returned to the <strong>Config</strong> tab where the SSID now appears in the list.</li><li>Select the device in the list and tap Activate. The configuration activates and the Dolphin terminal attempts to connect to the network wirelessly through your Access Point Router according to the parameters you entered.</li><li>The Status tab appears displaying the connection status provided you have switched to Classic Today screen layout.</li></ul><p>&nbsp;</p><p>The customer would likely have to run through the connection setup with their IT Department as they will know who actually setup and configured the wireless network connection settings for the Router which they will need to specify when attempting to connect through the wireless access point on the network.</p><p>&nbsp;</p><h3>MetroLogic Optimus SP5500</h3><p>This is a very old legacy Stock Control handheld PDA which is DOS-based</p><p>Have to install manually since <strong><em>Windows Mobile Device Center</em></strong> cannot be used to setup and connect to the device.</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p><strong>PartnerTech 0T200</strong></p><p>Full OS installed on device.</p><p>Comes with built-in Micro-USB connection to be used with a printer or USB keyboard etc.</p><p>Table Ordering PDA.</p><p>&nbsp;</p><p>(Castle Howard use this hardware)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;Checking Firmware Version:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p><p>&nbsp;</p><p></p><table cellpadding=\"0\" cellspacing=\"0\" width=\"100%\"><tbody><tr><td><p><strong>Serial Number</strong></p></td></tr></tbody></table><p>&nbsp;&nbsp;</p><p></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><h3>Lynx PDA Handheld Scanner</h3><p>&nbsp;</p><h2>Tablets&nbsp;(aka. WINPADS)</h2><h2>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;The pointer device (i.e. touch screen pen) is referred to as a ‘Stylus’.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;This device comes with a Bluetooth printer (Zebra EM220II)</h2><p>The bluetooth device is paired using Bluetooth software called ‘Blue Soleil’ and also needs the Zebra print drivers installed separately. Both device created in Devices and Printers and device detected and paired in Blue Soleil needs to be configured with matching Virtual COM ports.</p><p>&nbsp;</p><p>&nbsp;</p><p><strong>&nbsp;</strong></p><p>A Tablet only requires an Internet connection to enable the Tablet to function as a mobile till. The mobile till can work offline (i.e. have no active connection with the Merac server).</p><p>For Memberships/Bookings etc. (i.e. any action required to check validity), the mobile till needs to be online in order to establish a connection with the Merac database.</p><p>&nbsp;</p><p><strong>Configuring the Integrated 1D/2D Barcode Scanner</strong></p><p>Calibrate Barcode Scanning Device using the appropriate Scan Sheet</p><p>Open <strong>Widgets</strong> app and click <strong>Filter</strong> tab and then add Prefix: <strong>{32}</strong></p><p>Test by scanning any random barcode into notepad and ensure that the barcode is returned in the following format: <strong>&lt;Space&gt;&lt;BARCODE&gt;&lt;Return&gt;</strong></p><p><strong>&nbsp;</strong></p><p><strong>Installing and setting up a CashDraw Kicker/Trigger for Conker tab</strong></p><p><strong>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</strong></p><p><strong>USB Attached CashDraw</strong></p><p>Gigatek Intelligent USB cash drawer kicker – comes with a USB-Serial COM Port prolific driver that needs to be added to Epson OPOS as a Standard CashDraw.</p><p><strong>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</strong></p><p><strong>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</strong></p><p><strong>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</strong></p><p><strong>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</strong></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>Install the USB-Serial Universal drivers “PL2303_Prolific_DriverInstaller_v10518”.</p><p>Connect the CashDraw Kicker and CashDraw.</p><p>Open Epson OPOS and add a new CashDraw device as ‘Standard’ using same COM port as USB-Serial Prolific COM Port number assigned in Device Manager.</p><p>Set CashDraw in Till Configuration to Standard.</p><p>Recreate Till Data and Update the till.</p><p>Done!&nbsp;</p><p><strong>&nbsp;</strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<strong>Re-Calibrating Tablet Screens</strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;Steps:-</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;Open <strong>Control Panel</strong>&gt;&gt;<strong>Tablet PC Settings</strong></p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;Click on <strong>Calibrate</strong> button and follow instructions…</p><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;</p><p>&nbsp;</p><p>The calibration software will ask you to use your finger to touch the screen where ever the black cross pin markers are and then when complete, click <strong>Save</strong>.</p><p>Done!</p><p>&nbsp;</p><p>Note!</p><p>Sometimes if Calibrate button has been pressed more than once and settings saved this breaks or distorts the calibration. If so, try press the adjacent Reset button following by Calibrate button to fix this.</p><p>&nbsp;</p><p><strong>Re-Calibrating Aures Odysse II</strong></p><p>These are re-calibrated using Aures ELO proprietary software.</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p>",
    "user_id": 103081812271,
    "thumbs_up": 0,
    "thumbs_down": 0,
    "hits": 1,
    "seo_data": {},
    "modified_at": "2023-06-27T09:17:47+01:00",
    "modified_by": 103081812271
  },
  {
    "id": 103000138077,
    "title": "2018 Merac Information Sheet",
    "text": "2018 Merac Information NOTE this sheet was last updated inn 2018, so information may be out of date (especially the customer list)",
    "category": "INTERNAL Support Articles",
    "folder": "2017 Support Documents",
    "created_at": "2023-06-27T09:33:28+01:00",
    "updated_at": "2023-06-27T09:36:52+01:00",
    "status": 2,
    "tags": [],
    "description": "<p dir=\"ltr\">2018 Merac Information&nbsp;</p><p dir=\"ltr\"><br></p><p dir=\"ltr\">NOTE this sheet was last updated inn 2018, so information may be out of date (especially the customer list)  </p>",
    "user_id": 103081812271,
    "thumbs_up": 0,
    "thumbs_down": 0,
    "hits": 0,
    "seo_data": {},
    "modified_at": "2023-06-27T09:36:52+01:00",
    "modified_by": 103081812271
  },
  {
    "id": 103000138099,
    "title": "Stock import template",
    "text": "example",
    "category": "INTERNAL Support Articles",
    "folder": "2017 Support Documents",
    "created_at": "2023-06-27T10:05:49+01:00",
    "updated_at": "2023-06-27T10:05:51+01:00",
    "status": 2,
    "tags": [],
    "description": "<p dir=\"ltr\">example&nbsp;</p>",
    "user_id": 103081812271,
    "thumbs_up": 0,
    "thumbs_down": 0,
    "hits": 0,
    "seo_data": {},
    "modified_at": "2023-06-27T10:05:50+01:00",
    "modified_by": 103081812271
  }
]